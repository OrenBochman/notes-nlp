<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="Bayes rule, Conditional Probability, Log-likelihood, Laplace smoothing">
<meta name="description" content="The theory behind Bayes’ rule for conditional probabilities, and its application toward building a Naive Bayes tweet classifier">

<title>Probability and Bayes Rule – NLP Specialization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1372234da3246ce8e868649689ba5ed0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-d99a2a2a191b5c7f2a9a83135e7f0803.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">NLP Specialization</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/c1w1/index.html">Classification &amp; Vector Spaces</a></li><li class="breadcrumb-item"><a href="../../posts/c1w2/index.html">Probability and Bayes Rule</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/c1w1/index.html">Classification &amp; Vector Spaces</a></li><li class="breadcrumb-item"><a href="../../posts/c1w2/index.html">Probability and Bayes Rule</a></li></ol></nav>
      <h1 class="title">Probability and Bayes Rule</h1>
            <p class="subtitle lead">Classification &amp; Vector Spaces</p>
                  <div>
        <div class="description">
          The theory behind Bayes’ rule for conditional probabilities, and its application toward building a Naive Bayes tweet classifier
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">NLP</div>
                <div class="quarto-category">Coursera</div>
                <div class="quarto-category">Classification &amp; Vector Spaces</div>
                <div class="quarto-category">Notes</div>
                <div class="quarto-category">Naïve Bayes</div>
                <div class="quarto-category">Sentiment analysis task</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-body">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Friday, October 23, 2020</p>
      </div>
    </div>
    
      
    </div>
    

  <div>
    <div class="keywords">
      <div class="block-title">Keywords</div>
      <p>Bayes rule, Conditional Probability, Log-likelihood, Laplace smoothing</p>
    </div>
  </div>
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Classification &amp; Vector Spaces</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Frequencies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L3 Visualizing tweets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1 Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Probability and Bayes Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Visualizing Naive Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A2 Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector Space Models and PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Linear algebra with NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Manipulating word embeddings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A3 Hello Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Translation and Document Search via KNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Vector manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Hash functions and multiplanes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A4 Naive Machine Translation and LSH</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Probabilistic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autocorrect and Dynamic Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part of Speech Tagging and Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autocomplete and Language Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Word embeddings with neural networks</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Sequence Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">NLP with Attention Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#probability-of-a-randomly-selected-tweets-sentiment" id="toc-probability-of-a-randomly-selected-tweets-sentiment" class="nav-link" data-scroll-target="#probability-of-a-randomly-selected-tweets-sentiment">Probability of a randomly selected tweet’s sentiment</a></li>
  <li><a href="#probability-for-a-specific-words-sentiment" id="toc-probability-for-a-specific-words-sentiment" class="nav-link" data-scroll-target="#probability-for-a-specific-words-sentiment">Probability for a specific word’s sentiment</a></li>
  <li><a href="#what-is-phappy" id="toc-what-is-phappy" class="nav-link" data-scroll-target="#what-is-phappy">what is <span class="math inline">P(+|happy)</span></a></li>
  <li><a href="#what-is-phappy-1" id="toc-what-is-phappy-1" class="nav-link" data-scroll-target="#what-is-phappy-1">what is <span class="math inline">P(happy|+)</span></a></li>
  </ul></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes’ rule</a>
  <ul class="collapse">
  <li><a href="#naïve-bayes-introduction" id="toc-naïve-bayes-introduction" class="nav-link" data-scroll-target="#naïve-bayes-introduction">Naïve Bayes Introduction</a></li>
  </ul></li>
  <li><a href="#laplace-smoothing" id="toc-laplace-smoothing" class="nav-link" data-scroll-target="#laplace-smoothing">Laplace smoothing</a>
  <ul class="collapse">
  <li><a href="#additive-smoothing" id="toc-additive-smoothing" class="nav-link" data-scroll-target="#additive-smoothing">Additive smoothing:</a></li>
  <li><a href="#more-alternatives-to-laplacian-smoothing" id="toc-more-alternatives-to-laplacian-smoothing" class="nav-link" data-scroll-target="#more-alternatives-to-laplacian-smoothing">More alternatives to Laplacian smoothing</a></li>
  </ul></li>
  <li><a href="#ratio-of-probabilities" id="toc-ratio-of-probabilities" class="nav-link" data-scroll-target="#ratio-of-probabilities">Ratio of probabilities</a></li>
  <li><a href="#log-likelihood" id="toc-log-likelihood" class="nav-link" data-scroll-target="#log-likelihood">Log Likelihood</a></li>
  <li><a href="#training-naïve-bayes" id="toc-training-naïve-bayes" class="nav-link" data-scroll-target="#training-naïve-bayes">Training Naïve Bayes</a></li>
  <li><a href="#testing-naïve-bayes" id="toc-testing-naïve-bayes" class="nav-link" data-scroll-target="#testing-naïve-bayes">Testing Naïve Bayes</a></li>
  <li><a href="#naïve-bayes-applications" id="toc-naïve-bayes-applications" class="nav-link" data-scroll-target="#naïve-bayes-applications">Naïve Bayes Applications</a></li>
  <li><a href="#naïve-bayes-assumptions" id="toc-naïve-bayes-assumptions" class="nav-link" data-scroll-target="#naïve-bayes-assumptions">Naïve Bayes Assumptions</a>
  <ul class="collapse">
  <li><a href="#sources-of-errors-in-naïve-bayes" id="toc-sources-of-errors-in-naïve-bayes" class="nav-link" data-scroll-target="#sources-of-errors-in-naïve-bayes">Sources of Errors in Naïve Bayes</a>
  <ul class="collapse">
  <li><a href="#error-analysis" id="toc-error-analysis" class="nav-link" data-scroll-target="#error-analysis">Error Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c1w2/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content">






<div class="no-row-height column-margin column-container"><div id="fig-00" class="nolightbox quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../../images/Course-Logo-1-3.webp" class="nolightbox img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: course banner
</figcaption>
</figure>
</div><div id="fig-slide-deck" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slide-deck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="slides.pdf" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;2: "><embed src="slides.pdf" class="img-fluid"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-slide-deck-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div></div>
<p>Since I majored in Mathematics, I glossed over many details when I took the initial notes, since the course caters to all levels of students. When I migrated the notes from OneNotes to the web, I updated and reviewed the current course material and at times additional notes by <span class="citation" data-cites="Chadha2020NLP">(<a href="#ref-Chadha2020NLP" role="doc-biblioref"><strong>Chadha2020NLP?</strong></a>)</span> and <span class="citation" data-cites="jelliti2020nlp">(<a href="#ref-jelliti2020nlp" role="doc-biblioref">Jelliti 2020</a>)</span>. I have tried to add my own insights from other sources, books I read or others courses I have taken.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Naïve Bayes
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Naïve Bayes</strong> is a probabilistic algorithm commonly used in <em>machine learning</em> for <em>classification</em> problems. It’s based on <em>Bayes’ theorem</em>, which is a fundamental concept in <em>probability theory</em>. Naïve Bayes assumes that all the features of the input data are independent of each other, which is why it’s called “naïve.”</p>
</div>
</div>
<p>The following two results are due to <span class="citation" data-cites="NIPS2001_7b7a53e2">(<a href="#ref-NIPS2001_7b7a53e2" role="doc-biblioref"><strong>NIPS2001_7b7a53e2?</strong></a>)</span> by way of <a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier#cite_note-pair-17">Naive_Bayes_classifier</a> wikipedia article.</p>
<p>Another detail that can help you make sense of this lesson is the following result relating Naïve Bayes to Logistic Regression which we covered last week. In the case of discrete inputs like indicator or frequency features for discrete events, naive Bayes classifiers form a generative-discriminative pair with multinomial logistic regression classifiers: each naive Bayes classifier can be considered a way of fitting a probability model that optimizes the joint likelihood <span class="math inline">p (C,x)</span>, while logistic regression fits the same probability model to optimize the conditional <span class="math inline">p(C ∣ x)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Theorem—Naive Bayes classifiers on binary features are subsumed by logistic regression classifiers.
</div>
</div>
<section id="proof" class="level3 callout-body-container callout-body">
<h3 class="anchored" data-anchor-id="proof">Proof</h3>
<p>Consider a generic multi-class classification problem, with possible classes <span class="math inline">{\displaystyle Y \in \{1,\ldots, n\}}</span> , then the non-naive Bayes classifier gives, by Bayes theorem:</p>
<p><span class="math display">
p(Y\mid X=x) = {\text{softmax}}(\{\ln p(Y=k)+\ln p(X=x\mid Y=k)\}_{k})
</span></p>
<p>The naive Bayes classifier gives</p>
<p><span class="math display">
{ {\text{softmax}}\left(\left\{\ln p(Y=k)+{\frac {1}{2}}\sum _{i}(a_{i,k}^{+}-a_{i,k}^{-})x_{i}+(a_{i,k}^{+}+a_{i,k}^{-})\right\}_{k}\right)}
</span></p>
<p>where</p>
<p><span class="math display">
a_{i,s}^{+}=\ln p(X_{i}=+1\mid Y=s);\quad a_{i,s}^{-}=\ln p(X_{i}=-1\mid Y=s)
</span> This is exactly a logistic regression classifier.</p>
</section>
</div>
<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_020.png" class="lightbox" data-gallery="slides" title="our corpus"><img src="img/slide_020.png" class="img-fluid figure-img" alt="our corpus"></a></p>
<figcaption>our corpus</figcaption>
</figure>
</div></div><p>We start with a corpus of 20 tweets that we want to categorize as having either <strong>positive</strong> <code>+</code> or <strong>negative</strong> <code>-</code> sentiment, but not both.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research questions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>How can we model our corpus using probability theory?</li>
<li>How can we infer the sentiment of a tweet based on our corpus</li>
</ul>
</div>
</div>
<p>Since we can use the <code>sum rule</code>, <code>product rule</code> and <code>Bayes rule</code> which we shall cover shortly to manipulate probabilities we start by representing what we know about our corpus using probabilities.</p>
<section id="probability-of-a-randomly-selected-tweets-sentiment" class="level2">
<h2 class="anchored" data-anchor-id="probability-of-a-randomly-selected-tweets-sentiment">Probability of a randomly selected tweet’s sentiment</h2>
<ul>
<li>To calculate a <code>probability</code> of a certain event happening, you take the count of that specific event and divide it by the sum of all events.</li>
<li>Furthermore, the sum of all probabilities has to equal 1. If we pick a tweet at random, what is the probability of it being <code>+</code>? We define an event <code>A:</code> “A tweet is positive” and calculate its probability</li>
</ul>
<p><span class="math display">
P(A) = P(+) = \frac{N_{+}}{N}=\frac{13}{20}=0.65
</span></p>
<p>And since probabilities add up to one:</p>
<p><span class="math display">
P(-) = 1- P(+)=0.35
</span></p>
</section>
<section id="probability-for-a-specific-words-sentiment" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="probability-for-a-specific-words-sentiment">Probability for a specific word’s sentiment</h2>
<p>Within that corpus, the word <code>happy</code> is sometimes labeled <code>+</code> and in other cases, <code>-</code>. This indicates that some negative tweets contain the word <code>happy</code>. Shown below is a graphical representation of this “overlap”. Let’s explore how we may represent this graphically using a <a href="https://en.wikipedia.org/wiki/Venn_diagram">venn diagram</a> and then derive a probability-based representation.</p>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_021.png" class="lightbox" data-gallery="slides" title="Tweets with “Happy”"><img src="img/slide_021.png" class="img-fluid figure-img" alt="Tweets with “Happy”"></a></p>
<figcaption>Tweets with “Happy”</figcaption>
</figure>
</div></div><p>First, we need to estimate the probability of the event B: “tweets containing the word happy”</p>
<p><span class="math display">
P(B) = P(\text{happy})=\frac{N_\text{happy}}{N}=\frac{4}{20}=0.2
</span></p>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_026.png" class="lightbox" data-gallery="slides" title="Venn diagram for defining probabilities from events"><img src="img/slide_026.png" class="img-fluid figure-img" alt="Venn diagram for defining probabilities from events"></a></p>
<figcaption>Venn diagram for defining probabilities from events</figcaption>
</figure>
</div></div><p>To compute the probability of 2 events happening like <code>happy</code> <strong>and</strong> <code>+</code> in the picture you would be looking at the intersection, or overlap of the two events, In this case, the red and the blue boxes overlap in three boxes, So the answer is: <span class="math display">
P(A \cap B) = P(A,B) = \frac{2}{20}
</span></p>
<p>The Event “A is labeled <code>+</code>”, - The probability of events A shown as P(A) is calculated as the ratio between the count of positive tweets and the corpus divided by the total number of tweets in the corpus.</p>
<div>

</div>

<div class="no-row-height column-margin column-container"><div class="quarto-layout-panel" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p><img src="img/slide_027.png" class="img-fluid" alt="counting the intersection"> specific tweets color coded per the Venn diagram</p>
</div>
</div>
</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition of conditional probability
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Conditional probability</strong> is the <em>probability of an outcome <code>B</code> when we already know for certain that an event <code>A</code> has already happened</em>. Notation: <span class="math display">
P(B|A)
</span></p>
</div>
</div>
<ul>
<li><p>and there more + than - more specifically our prior knowledge is that : <span class="math display">
  \frac{P(+)}{P(−)}=\frac{13}{7}
</span></p></li>
<li><p>the likelihood of a tweet with happy being + is</p></li>
<li><p>the challenge arises from some words being in both + and - tweets Conditional probabilities help us reduce the sample search space by restricting it to a specific event which is a given. We should understand the difference between <span class="math inline">P(A|B)</span> and <span class="math inline">P(B|A)</span></p></li>
</ul>
</section>
<section id="what-is-phappy" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-is-phappy">what is <span class="math inline">P(+|happy)</span></h2>
<ul>
<li>We start with the Venn diagram for the <span class="math inline">P(A|B)</span>. </li>
<li>Where we restricted the diagram to just A the subset of happy tweets.</li>
<li>And we just want those tweets that are also <code>+</code> i.e.&nbsp;(B).</li>
<li>all we need is to plug in the counts from our count chart. </li>
<li>which we now estimate <span class="math display">
P(A \mid B) = P(Positive \mid happy) = \frac{3}{4} = 0.75
</span></li>
</ul>
<div class="no-row-height column-margin column-container"><img src="img/slide_028.png" class="img-fluid" data-group="slides" alt="Venn diagram for P(A \mid B)"><img src="img/slide_029.png" class="img-fluid" data-group="slides" alt="Counts for P(A \mid B)"></div></section>
<section id="what-is-phappy-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-is-phappy-1">what is <span class="math inline">P(happy|+)</span></h2>
<ul>
<li>We start with the Venn diagram for the <span class="math inline">P(B|A)</span></li>
<li>where we have restricted the diagram to just B the subset of <code>+</code> tweets. </li>
<li>and we just want from those the tweets that are also <code>happy</code> i.e.&nbsp;(A).</li>
<li>and the counts for <span class="math inline">P(B|A)</span> </li>
<li>which we now estimate <span class="math display">
P(B \mid A) = P(happy \mid Positive) = \frac{3}{13} = 0.231
</span></li>
</ul>
<div class="no-row-height column-margin column-container"><img src="img/slide_030.png" class="img-fluid" data-group="slides" alt="Venn diagram for the P(B \mid A)"><img src="img/slide_031.png" class="img-fluid" data-group="slides" alt="Counts for P(B\mid A)"></div></section>
</section>
<section id="bayes-rule" class="level1 page-columns page-full">
<h1>Bayes’ rule</h1>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_026.png" class="lightbox" data-gallery="slides" title="Venn diagram for defining probabilities from events"><img src="img/slide_026.png" class="img-fluid figure-img" alt="Venn diagram for defining probabilities from events"></a></p>
<figcaption>Venn diagram for defining probabilities from events</figcaption>
</figure>
</div></div><p>From this, we can now write:</p>
<p><span class="math display">
P(+|happy) = \frac{P(+ \cap happy) }{P(happy)}
</span></p>
<p>and</p>
<p><span class="math display">
P(happy|+) = \frac{P(happy \cap +) }{P(+)}
</span></p>
<p>we can combine these since the intersections are the same and we get</p>
<p><span class="math display">
P(+|happy) = \frac{P(+ \cap happy) }{P(happy)} =  \frac{P(happy|+) \times P(+) }{P(happy)}
</span></p>
<p>which generalizes to:</p>
<p><span class="math display">
P(X|Y) = \frac{P(Y|X) \times P(X) }{P(Y)}
</span></p>
<p>which we call Bayes rule</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bayes Rule
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Bayes Rule</strong> is the rule for inverting conditional probabilities.</p>
</div>
</div>
<p>However, we gain a deeper insight by considering that Bayes’s rule is more than just a tool for inverting conditional probabilities but the basis of a casual framework for updating our beliefs as we uncover new evidence.</p>
<p><span class="math display">
p(H|e)=\frac{P(e|H) \times P(H)}{P(e|H)+P(e|\bar H)}  = \frac{P(e|H) \times P(H)}{P(e)}
</span></p>
<p>to reflect the notion of updating using new data.</p>
<p>where we call:</p>
<ul>
<li><span class="math inline">p(H|e)</span> the posterior</li>
<li><span class="math inline">P(H)</span> the prior</li>
<li><span class="math inline">P(e|H)</span> the likelihood (of evidence given the Hypothesis is true).</li>
<li><span class="math inline">P(e)</span> the marginal</li>
</ul>
<section id="naïve-bayes-introduction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="naïve-bayes-introduction">Naïve Bayes Introduction</h2>
<p>Here is a sample corpus</p>
<div>
<div id="tbl-tweets" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tweets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: And these are the class frequencies and probabilities
</figcaption>
<div aria-describedby="tbl-tweets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th><span style="color:blue">+</span> tweets</th>
<th><span style="color:red">-</span> tweets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span style="color:blue">I am happy because I am learning NLP</span></td>
<td><span style="color:red">I am sad, I am not learning NLP</span></td>
</tr>
<tr class="even">
<td><span style="color:blue">I am happy</span></td>
<td><span style="color:red">I am sad</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div id="5b0db268" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>raw_tweets<span class="op">=</span>[</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am happy because I am learning NLP"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am sad, I am not learning NLP"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am happy, not sad"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am sad, not happy"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean(tweet:<span class="bu">str</span>):</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>  tweet.translate(<span class="bu">str</span>.maketrans(<span class="st">''</span>, <span class="st">''</span>, string.punctuation)).lower()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>tweets <span class="op">=</span> [clean(tweet) <span class="cf">for</span> tweet <span class="kw">in</span> raw_tweets]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">'+'</span>,<span class="st">'-'</span>,<span class="st">'+'</span>,<span class="st">'-'</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'tweets'</span>: tweets, <span class="st">'labels'</span>: labels})</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">tweets</th>
<th data-quarto-table-cell-role="th">labels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>i am happy because i am learning nlp</td>
<td>+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>i am sad i am not learning nlp</td>
<td>-</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>i am happy not sad</td>
<td>+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>i am sad not happy</td>
<td>-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ea57cd38" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p_freq,n_freq <span class="op">=</span> Counter(), Counter()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print( df[df.labels == '+']['tweets'].to_list())</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>[p_freq.update(tweet.split()) <span class="cf">for</span> tweet <span class="kw">in</span> df[df.labels <span class="op">==</span> <span class="st">'+'</span>][<span class="st">'tweets'</span>].to_list()]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[n_freq.update(tweet.split()) <span class="cf">for</span> tweet <span class="kw">in</span> df[df.labels <span class="op">==</span> <span class="st">'-'</span>][<span class="st">'tweets'</span>].to_list()]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_freq)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n_freq)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(p_freq.keys()).union(<span class="bu">set</span>(n_freq.keys())))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>pos_freq <span class="op">=</span> [p_freq[word] <span class="cf">for</span> word <span class="kw">in</span> vocab ]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>neg_freq <span class="op">=</span> [n_freq[word] <span class="cf">for</span> word <span class="kw">in</span> vocab ]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>vocab_df<span class="op">=</span>pd.DataFrame({<span class="st">'vocab'</span>:vocab,<span class="st">'pos_freq'</span>:pos_freq,<span class="st">'neg_freq'</span>:neg_freq})</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_pos'</span>]<span class="op">=</span>vocab_df.pos_freq<span class="op">/</span>vocab_df.pos_freq.<span class="bu">sum</span>()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_neg'</span>]<span class="op">=</span>vocab_df.neg_freq<span class="op">/</span>vocab_df.neg_freq.<span class="bu">sum</span>()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_pos_sm'</span>]<span class="op">=</span>(vocab_df.pos_freq<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(vocab_df.pos_freq.<span class="bu">sum</span>()<span class="op">+</span>vocab_df.shape[<span class="dv">1</span>])</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_neg_sm'</span>]<span class="op">=</span>(vocab_df.neg_freq<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(vocab_df.neg_freq.<span class="bu">sum</span>()<span class="op">+</span>vocab_df.shape[<span class="dv">1</span>])</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'ratio'</span>]<span class="op">=</span> vocab_df.p_pos_sm<span class="op">/</span>vocab_df.p_neg_sm</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'lambda'</span>]<span class="op">=</span> np.log(vocab_df.p_pos_sm<span class="op">/</span>vocab_df.p_neg_sm)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.float_format'</span>, <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>vocab_df</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vocab_df.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[None, None]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[None, None]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Counter({'i': 3, 'am': 3, 'happy': 2, 'because': 1, 'learning': 1, 'nlp': 1, 'not': 1, 'sad': 1})
Counter({'i': 3, 'am': 3, 'sad': 2, 'not': 2, 'learning': 1, 'nlp': 1, 'happy': 1})</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">vocab</th>
<th data-quarto-table-cell-role="th">pos_freq</th>
<th data-quarto-table-cell-role="th">neg_freq</th>
<th data-quarto-table-cell-role="th">p_pos</th>
<th data-quarto-table-cell-role="th">p_neg</th>
<th data-quarto-table-cell-role="th">p_pos_sm</th>
<th data-quarto-table-cell-role="th">p_neg_sm</th>
<th data-quarto-table-cell-role="th">ratio</th>
<th data-quarto-table-cell-role="th">lambda</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>not</td>
<td>1</td>
<td>2</td>
<td>0.08</td>
<td>0.15</td>
<td>0.11</td>
<td>0.16</td>
<td>0.70</td>
<td>-0.35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>i</td>
<td>3</td>
<td>3</td>
<td>0.23</td>
<td>0.23</td>
<td>0.22</td>
<td>0.21</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>am</td>
<td>3</td>
<td>3</td>
<td>0.23</td>
<td>0.23</td>
<td>0.22</td>
<td>0.21</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>happy</td>
<td>2</td>
<td>1</td>
<td>0.15</td>
<td>0.08</td>
<td>0.17</td>
<td>0.11</td>
<td>1.58</td>
<td>0.46</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>learning</td>
<td>1</td>
<td>1</td>
<td>0.08</td>
<td>0.08</td>
<td>0.11</td>
<td>0.11</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>because</td>
<td>1</td>
<td>0</td>
<td>0.08</td>
<td>0.00</td>
<td>0.11</td>
<td>0.05</td>
<td>2.11</td>
<td>0.75</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>sad</td>
<td>1</td>
<td>2</td>
<td>0.08</td>
<td>0.15</td>
<td>0.11</td>
<td>0.16</td>
<td>0.70</td>
<td>-0.35</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>nlp</td>
<td>1</td>
<td>1</td>
<td>0.08</td>
<td>0.08</td>
<td>0.11</td>
<td>0.11</td>
<td>1.06</td>
<td>0.05</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(8, 9)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> [[<span class="st">"Sun"</span>,<span class="dv">696000</span>,<span class="dv">1989100000</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Earth"</span>,<span class="dv">6371</span>,<span class="fl">5973.6</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Moon"</span>,<span class="dv">1737</span>,<span class="fl">73.5</span>],</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Mars"</span>,<span class="dv">3390</span>,<span class="fl">641.85</span>]]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  table, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  headers<span class="op">=</span>[<span class="st">"Planet"</span>,<span class="st">"R (km)"</span>, <span class="st">"mass (x 10^29 kg)"</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-planet-measures" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="4">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-planet-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Planets
</figcaption>
<div aria-describedby="tbl-planet-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Planet</th>
<th style="text-align: right;">R (km)</th>
<th style="text-align: right;">mass (x 10^29 kg)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sun</td>
<td style="text-align: right;">696000</td>
<td style="text-align: right;">1.9891e+09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Earth</td>
<td style="text-align: right;">6371</td>
<td style="text-align: right;">5973.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moon</td>
<td style="text-align: right;">1737</td>
<td style="text-align: right;">73.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mars</td>
<td style="text-align: right;">3390</td>
<td style="text-align: right;">641.85</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-first" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-first-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Frequency Table
</figcaption>
<div aria-describedby="tbl-first-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-second" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Probabilities Table
</figcaption>
<div aria-describedby="tbl-second-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<p>Let’s motivate the Naïve Bayes inference condition rule for binary classification:</p>
<p>To build a classifier, we will first start by creating conditional probabilities given the table;</p>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_032.png" class="lightbox" data-gallery="slides" title="Naïve Bayes"><img src="img/slide_032.png" class="img-fluid figure-img" alt="Naïve Bayes"></a></p>
<figcaption>Naïve Bayes</figcaption>
</figure>
</div></div><ul>
<li>We want to find if given our prior knowledge of <span class="math inline">P(+)</span> and <span class="math inline">P(-)</span> if a new tweet has + or - sentiment.</li>
<li>To do that we will estimate <span class="math inline">p(+|T)</span> and <span class="math inline">p(-|T)</span> and then decide based on which is greater than 0.5.</li>
</ul>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_033.png" class="lightbox" data-gallery="slides" title="Table of probabilities"><img src="img/slide_033.png" class="img-fluid figure-img" alt="Table of probabilities"></a></p>
<figcaption>Table of probabilities</figcaption>
</figure>
</div></div><p>We can use the Bayes rule:</p>
<p><span class="math display">
p(+|T) = \frac{ p(T|+) \times p(+) }{ p(T) }
</span></p>
<p>and</p>
<p><span class="math display">
p(-|T) = \frac{ p(T|-) \times p(-) }{ p(T) }
</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">p(+|T)</span> is the <strong>posterior probability</strong> of a label <code>+</code> given tweet <code>T</code></li>
<li><span class="math inline">p(+)</span> is our <strong>prior</strong> knowledge</li>
<li><span class="math inline">p(T|+)</span> is the <strong>likelihood</strong> of tweet T being <code>+</code>.</li>
<li><span class="math inline">{p(T)}</span></li>
</ul>
<p>The term <span class="math inline">p(T)</span> is in both terms and can be eliminated. However, it will cancel out when we use the ratio for the inference. This lets us compute the following table of probabilities; word am learning NLP Pos 0.24 0.08 0.08 Neg 0.25 0.08 0.08 .17 Naïve Bayes is the simplest probabilistic graphical model which comes with an independence assumption for the features.</p>
<p><span class="math display">
p(T|+) = \prod^m_{i=1}P(w_i|+) \implies p(+|T)=\frac{P(+)}{P(T)} \prod^m_{i=1}P(w_i|+)
</span></p>
<p>and</p>
<p><span class="math display">
p(T|−) = \prod^m_{i=1}P(w_i|−) \implies p(−|T) =  \frac{P(−)}{P(T)} \prod^m_{i=1} P(w_i|−)
</span></p>
<p>Once you have the probabilities, you can compute the likelihood score as follows:</p>
<p><strong>Tweet</strong>: <span style="color: blue;">I am happy today: I am learning</span>. - Since there is no entry for today in our conditional probabilities table, this implies that this word is not in your vocabulary. So we’ll ignore its contribution to the overall score. - All the neutral words in the tweet such as I and am cancel out in the expression, as shown in the figure below.</p>
<p><span class="math display">
   \prod^m_{i=1} \frac{P(w_i|+)}{P(w_i|-)}= \frac {0.14}{0.10} =1.4 &gt; 1
</span></p>
<ul>
<li>A score greater than 1 indicates that the class is positive, otherwise, it is negative.</li>
</ul>
<p><span class="math display">
P(+|T) &gt; P(−|T)
</span></p>
<p>then we infer that the T has + sentiment. dividing by the right term we get the inference rule:</p>
<p><span class="math display">
\frac{P(+|T)}{P(−|T)} &gt; 1
</span> which expands to : <span class="math display">
  \frac {P(+|T)}{P(−|T)} = \frac {P(+)}{P(-)}\prod^m_{i=1} \frac {P(w_i|+)}{P(w_i|−)} &gt; 1
</span></p>
<p>This is the inference rule for naïve Bayes.</p>
<p>Note: Naïve Bayes is a model which assumes all features are independent, so the basic component here is:</p>
<p><span class="math display">
\frac{P(w_i|+)}{P(w_i|-)} &gt; 1
</span> the ratio of the probability that a word appears in a positive tweet and that it appears in a negative tweet</p>
</section>
</section>
<section id="laplace-smoothing" class="level1 page-columns page-full">
<h1>Laplace smoothing</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Smoothing
</div>
</div>
<div class="callout-body-container callout-body">
<p>A probability distribution can take zero values at certain points i.e.&nbsp;for certain inputs. <code>Smoothing</code> is a family of techniques for improving our estimate of conditional class probabilities to estimate probabilities for missing words. The name smoothing comes from the fact that these techniques tend to make distributions more uniform, by adjusting low probabilities such as zero probabilities upward, and high probabilities downward. Not only do smoothing methods generally prevent zero probabilities, but they also attempt to improve the accuracy of the model as a whole. Whenever a probability is estimated from a few counts, smoothing has the potential to improve estimation.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_076.png" class="lightbox" data-gallery="slides" title="Laplace smoothing"><img src="img/slide_076.png" class="img-fluid figure-img" alt="Laplace smoothing"></a></p>
<figcaption>Laplace smoothing</figcaption>
</figure>
</div></div><p>The course introduces smoothing here since sparsity breaks the naive Bayes model. But smoothing and filtering are big topics in NLP and Data Science. I have added some extra info drawn from <span class="citation" data-cites="jurafsky2000speech">(<a href="#ref-jurafsky2000speech" role="doc-biblioref">Jurafsky and Martin 2000</a>)</span></p>
<p><code>Laplace smoothing</code> also called <code>add one smoothing</code> replaces a distribution with zero probabilities (due to sparse data) with a distribution that steals some mass and spreads it over the points which were zero. It solves the data sparsity issue but <code>Laplace smoothing</code> will skew/bias the probabilities (it affects rare and common probabilities differently) giving you behavior that is hard to explain, as it assigns too much mass to unknown words. When we compute the conditional probability <span class="math inline">P(w|class)</span> using:</p>
<p><span class="math display">
P(w_i|class) = \frac{freq(w_i,class)}{N_{class}} \qquad class \in \{ +, -\}
</span></p>
<p>If a word does not appear in the training corpus or is missing from one of the classes then its frequency is 0 so it gets a probability of 0. Since we are taking products of probabilities, and soon we will take logs of probabilities and zeros present us with a numerical problem that we can address using <code>smoothing</code> as follows:</p>
<p><span class="math display">
P(w_i|class) = \frac{freq(w_i,class) + 1}{N_{class} + |V|}
</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">N_{class}</span> is the frequency of all words in a class.</li>
<li><span class="math inline">V</span> is unique words in the vocabulary</li>
</ul>
<p>Note: that we added a 1 in the numerator and since there are <span class="math inline">|V|</span> words to normalize we add <span class="math inline">|V|</span> in the denominator so that all the probabilities sum up to 1.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-unsmoothed" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-unsmoothed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: <span class="math inline">P(w_i \mid class)</span> no smoothing
</figcaption>
<div aria-describedby="tbl-unsmoothed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"><span style="color:red">0.00</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-smoothing" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-smoothing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: <span class="math inline">P(w_i \mid class)</span> with smoothing
</figcaption>
<div aria-describedby="tbl-smoothing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">0.14</td>
<td style="text-align: center;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;"><span style="color:blue">0.05</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.15</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<section id="additive-smoothing" class="level2">
<h2 class="anchored" data-anchor-id="additive-smoothing">Additive smoothing:</h2>
<p><span class="math display">
p_{addative}(w_i|class)=\frac{ freq(w,class)+\delta}{ N_{class} + \delta \times V}
</span></p>
</section>
<section id="more-alternatives-to-laplacian-smoothing" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="more-alternatives-to-laplacian-smoothing">More alternatives to Laplacian smoothing</h2>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_035.png" class="lightbox" data-gallery="slides" title="Good Turing smoothing"><img src="img/slide_035.png" class="img-fluid figure-img" alt="Good Turing smoothing"></a></p>
<figcaption>Good Turing smoothing</figcaption>
</figure>
</div></div><ul>
<li><strong>Kneser-Ney smoothing</strong> c.f. <span class="citation" data-cites="NEY19941">(<a href="#ref-NEY19941" role="doc-biblioref">Ney, Essen, and Kneser 1994</a>)</span> which corrects better for smaller data sets. </li>
<li><strong>Good-Turing smoothing</strong> c.f. <span class="citation" data-cites="good1953population">(<a href="#ref-good1953population" role="doc-biblioref">Good 1953</a>)</span> which uses order statistics to give even better estimates.</li>
<li>with a survey of the subject here: <span class="citation" data-cites="chen1996empirical">(<a href="#ref-chen1996empirical" role="doc-biblioref">Chen and Goodman 1996</a>)</span></li>
</ul>
<div class="no-row-height column-margin column-container"><img src="img/slide_034.png" class="img-fluid" data-group="slides" alt="Kneser-Ney smoothing"></div></section>
</section>
<section id="ratio-of-probabilities" class="level1">
<h1>Ratio of probabilities</h1>
<p><span class="math display">
ratio(w_i)=\frac{P(w_i|+)}{P(w_i|-)} \approx \frac{freq(w_i|+)+1}{freq(w_i|-)+1}
</span></p>
</section>
<section id="log-likelihood" class="level1">
<h1>Log Likelihood</h1>
<p>recall that <span class="math display">
  \frac {P(+|T)}{P(−|T)} = \frac {P(+)}{P(-)}\prod^m_{i=1} \frac {P(w_i|+)}{P(w_i|−)} &gt; 1
</span></p>
<p>taking logs we get</p>
<p><span class="math display">
  \log \frac{P(+|T)}{P(−|T)} = \log \frac {P(+)}{P(-)} + \sum^m_{i=1} \lambda(w_i) &gt; 0
</span></p>
<p>where</p>
<p><span class="math display">
\lambda(w_i) = log \frac {P(w_i|+)}{P(w_i|−)}
</span></p>
<p>To compute the likelihood, we need to get the ratios and use them to compute a score that Will allow us to decide if a tweet is positive or negative.</p>
<p>The higher the ratio, the more positive the word.</p>
<ul>
<li>Long Products of small probabilities create a risk of numeric underflow.</li>
<li>logs let us mitigate this risk.</li>
</ul>
<p><span class="math display">
\lambda(w) = \log \frac{p(w|+)}{p(w|-)}
</span></p>
<p><span class="math display">
\log prior = \log \frac{p(+)}{p(-)}
</span></p>
<p>Where <span class="math inline">D_{+}</span> and <span class="math inline">D_{-}</span> correspond to the number Of negative documents respectively.</p>
</section>
<section id="training-naïve-bayes" class="level1 page-columns page-full">
<h1>Training Naïve Bayes</h1>
<p>To train a naïve Bayes classifier, we should perform the following steps:</p>
<ol type="1">
<li>Get or annotate a dataset with positive and negative tweets</li>
<li>preprocess the tweets. 
<ul>
<li>Tokenize sentences</li>
<li>Remove punctuation, URLs and names</li>
<li>Remove stop words</li>
<li>Stem words<br>
</li>
</ul></li>
<li>Compute the vocabulary: freq(word, class) </li>
<li>Use Laplacian smoothing to estimate word class probabilites <span class="math inline">P(w|+)</span> and <span class="math inline">P(w|-)</span>. </li>
<li>Compute <span class="math inline">\lambda(w) = \log \frac{p(w|+)}{p(w|-)}</span> </li>
<li>Compute <span class="math inline">\log(prior) = \log \frac{p(w|+)}{p(w|-)}</span> Where <span class="math inline">D_{+}</span> and <span class="math inline">D_{-}</span> correspond to the number Of negative documents respectively.</li>
</ol>
<div class="no-row-height column-margin column-container"><img src="img/slide_045.jpg" class="img-fluid" data-group="slides" alt="Training"><img src="img/slide_046.jpg" class="img-fluid" data-group="slides" alt="Training"><img src="img/slide_047.jpg" class="img-fluid" data-group="slides" alt="Training"><img src="img/slide_048.jpg" class="img-fluid" data-group="slides" alt="Training"></div></section>
<section id="testing-naïve-bayes" class="level1 page-columns page-full">
<h1>Testing Naïve Bayes</h1>

<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/slide_050.jpg" class="lightbox" data-gallery="slides" title="Inference"><img src="img/slide_050.jpg" class="img-fluid figure-img" alt="Inference"></a></p>
<figcaption>Inference</figcaption>
</figure>
</div></div><p>Let’s work on applying the Naïve Bayes classifier on validation examples to compute the model’s accuracy. The steps involved in testing a Naïve Bayes model for sentiment analysis are as follows:</p>
<ol type="1">
<li>Use the validation set to test the model on tweets it has not seen. Which is comprised of a set of raw tweets <span class="math inline">X_{val}</span>, and their corresponding sentiments, <span class="math inline">Y_{val}</span>.</li>
<li>We use the conditional <span class="math inline">p(word|state)</span> and use them to predict the sentiments of new unseen tweets,</li>
<li>We apply <strong>Pre-processing</strong>: as before in training.</li>
<li>Lookup the <span class="math inline">\lambda</span> score for each unique word: Using the <span class="math inline">\lambda</span> table (i.e., the log-likelihood table).</li>
</ol>
<ul>
<li>Words that have entries in the table, are summed over all the corresponding <span class="math inline">\lambda</span> terms.</li>
<li><strong>Unknown words are skipped</strong> as words that lack a log-likelihood in the table are considered neutral.</li>
</ul>
<ol start="4" type="1">
<li><strong>Obtain the overall score</strong> by summing up the scores of all the individual words, along with with our estimation of the log prior (important for an unbalanced dataset), we get the overall sentiment score of the new tweet.</li>
<li><strong>Check against the threshold</strong> we check if the sentiment score &gt;0 . Let’s consider an example tweet, <code>"I passed the NLP interview"</code>, and use our trained model to predict if this is a positive or negative tweet:</li>
</ol>
<ul>
<li>Look up each word from the vector in your log-likelihood table. Words such as “I”, “pass”, “the”, and “NLP”, have entries in the table, while the word interview does not (which implies that it needs to be ignored). Now, add the log before accounting for the imbalance of classes in the dataset. Thus, the overall score sums up to 0.48, as shown in the figure below.</li>
<li>Recall that if the overall score of the tweet is larger than 0, then this tweet has a positive sentiment, so the overall prediction is that this tweet has a positive sentiment. Even in real life, passing the NLP interview is a very positive thing.</li>
</ul>
</section>
<section id="naïve-bayes-applications" class="level1">
<h1>Naïve Bayes Applications</h1>
<p>There are many applications of naïve Bayes including:</p>
<ul>
<li>Author identification</li>
<li>Spam filtering</li>
<li>Information retrieval</li>
<li>Word disambiguation</li>
<li>This method is usually used as a simple baseline.</li>
<li>It is also really fast.</li>
</ul>
</section>
<section id="naïve-bayes-assumptions" class="level1">
<h1>Naïve Bayes Assumptions</h1>
<p>Naïve Bayes makes the <strong>independence</strong> assumption and is affected by the word frequencies in the corpus. For example, if you had the following <code>"It is sunny and hot in the Sahara desert."</code> `“It’s always cold and snowy in …”` In the first image, you can see the word sunny and hot tend to depend on each other and are correlated to a certain extent with the”desert”, Naïve Independence throughout,</p>
<p>Furthermore, if you were to fill in the sentence on the right. this naïve model will assign equal weight to the words :</p>
<ul>
<li>spring.</li>
<li>summer,</li>
<li>fall,</li>
<li>winter,</li>
</ul>
<p>Relative frequencies in the corpus On Twitter, there are usually more positive tweets than negative ones However, some clean datasets are artificially balanced to have the same amount of positive and negative tweets. Just keep in mind, that in me real world. the data could be much noisier.</p>
<section id="sources-of-errors-in-naïve-bayes" class="level2">
<h2 class="anchored" data-anchor-id="sources-of-errors-in-naïve-bayes">Sources of Errors in Naïve Bayes</h2>
<section id="error-analysis" class="level3">
<h3 class="anchored" data-anchor-id="error-analysis">Error Analysis</h3>
<p>Bad sentiment classifications are due to:</p>
<ol type="1">
<li>preprocessing dropping punctuation that encodes emotion like a <code>sad smiley</code>.</li>
<li>Word order can contribute to meaning - breaking the independence assumption of our model</li>
<li>Pronouns removed as stop words - may encode emotion</li>
<li>Sarcasm can confound the model</li>
<li>Euphemisms are also a challenge</li>
</ol>



</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-chen1996empirical" class="csl-entry" role="listitem">
Chen, Stanley F., and Joshua T. Goodman. 1996. <span>“An Empirical Study of Smoothing Techniques for Language Modeling.”</span> <a href="https://arxiv.org/abs/cmp-lg/9606011">https://arxiv.org/abs/cmp-lg/9606011</a>.
</div>
<div id="ref-good1953population" class="csl-entry" role="listitem">
Good, I. J. 1953. <span>“The Population Frequencies of Species and the Estimation of Population Parameters.”</span> <em>Biometrika</em> 40 (3-4): 237–64. <a href="https://doi.org/10.1093/biomet/40.3-4.237">https://doi.org/10.1093/biomet/40.3-4.237</a>.
</div>
<div id="ref-jelliti2020nlp" class="csl-entry" role="listitem">
Jelliti, Ibrahim. 2020. <span>“NLP Specialization Courses Notes (Offered by Deeplearning.ai).”</span> <em>GitHub Repository</em>. <a href="https://github.com/ibrahimjelliti/Deeplearning.ai-Natural-Language-Processing-Specialization" class="uri">https://github.com/ibrahimjelliti/Deeplearning.ai-Natural-Language-Processing-Specialization</a>; GitHub. <a href="https://github.com/ibrahimjelliti/Deeplearning.ai-Natural-Language-Processing-Specialization">https://github.com/ibrahimjelliti/Deeplearning.ai-Natural-Language-Processing-Specialization</a>.
</div>
<div id="ref-jurafsky2000speech" class="csl-entry" role="listitem">
Jurafsky, D., and J. H. Martin. 2000. <em>Speech and Language Processing: An Introduction to Natural Language Processing, Computational Linguistics, and Speech Recognition</em>. Prentice Hall Series in Artificial Intelligence. Prentice Hall. <a href="https://books.google.co.il/books?id=85BvQgAACAAJ">https://books.google.co.il/books?id=85BvQgAACAAJ</a>.
</div>
<div id="ref-NEY19941" class="csl-entry" role="listitem">
Ney, Hermann, Ute Essen, and Reinhard Kneser. 1994. <span>“On Structuring Probabilistic Dependences in Stochastic Language Modelling.”</span> <em>Computer Speech &amp; Language</em> 8 (1): 1–38. https://doi.org/<a href="https://doi.org/10.1006/csla.1994.1001">https://doi.org/10.1006/csla.1994.1001</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2020,
  author = {},
  title = {Probability and {Bayes} {Rule}},
  date = {2020-10-23},
  url = {https://orenbochman.github.io/notes-nlp/posts/c1w2/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2020" class="csl-entry quarto-appendix-citeas" role="listitem">
<span>“Probability and Bayes Rule.”</span> 2020. October 23, 2020. <a href="https://orenbochman.github.io/notes-nlp/posts/c1w2/">https://orenbochman.github.io/notes-nlp/posts/c1w2/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2023-2025, Oren Bochman</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c1w2/index.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with 💛 and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"right","loop":true,"openEffect":"fade","selector":".lightbox","skin":"my-css-class"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>