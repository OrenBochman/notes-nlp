<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oren Bochman">

<title>Language Models: Auto-Complete – NLP Specialization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1372234da3246ce8e868649689ba5ed0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-d99a2a2a191b5c7f2a9a83135e7f0803.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">NLP Specialization</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Probabilistic Models</li><li class="breadcrumb-item"><a href="../../posts/c2w3/index.html">Autocomplete &amp; Language Models</a></li><li class="breadcrumb-item"><a href="../../posts/c2w3/assignment.html">A3 - Auto-Complete</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Probabilistic Models</li><li class="breadcrumb-item"><a href="../../posts/c2w3/index.html">Autocomplete &amp; Language Models</a></li><li class="breadcrumb-item"><a href="../../posts/c2w3/assignment.html">A3 - Auto-Complete</a></li></ol></nav>
      <h1 class="title">Language Models: Auto-Complete</h1>
            <p class="subtitle lead">Probabilistic Models</p>
                                <div class="quarto-categories">
                <div class="quarto-category">NLP</div>
                <div class="quarto-category">Coursera</div>
                <div class="quarto-category">Lab</div>
                <div class="quarto-category">Probabilistic Models</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-body">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Oren Bochman </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Friday, October 23, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Classification &amp; Vector Spaces</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Logistic Regression</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Frequencies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L3 - Visualizing tweets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1 - Logistic Regression</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Probability &amp; Bayes Rule</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Visualizing Naive Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A2 - Logistic Regression</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Vector Space Models &amp; PCA</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Linear algebra with NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Manipulating word embeddings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A3 - Hello Vectors</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">MT &amp; Document Search via KNN</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Vector manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Hash functions and multiplanes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A4 - Naive Machine Translation and LSH</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Probabilistic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Autocorrect &amp; Dynamic Programming</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Building the vocabulary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Candidates from String Edits</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1 - Auto Correct</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">POS tagging &amp; HMMS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - Vocabulary with unknowns</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Working with tags and Numpy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A2 - POS tagging</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Autocomplete &amp; Language Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 - N-grams Corpus preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 - Building the language model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L3 - Out of vocabulary words</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/assignment.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">A3 - Auto-Complete</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Word embeddings with neural networks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 -</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 -</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L3 -</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A4 -</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Sequence Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">NLP with Attention Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#outline" id="toc-outline" class="nav-link active" data-scroll-target="#outline">Outline</a>
  <ul class="collapse">
  <li><a href="#expected-output" id="toc-expected-output" class="nav-link" data-scroll-target="#expected-output">Expected output</a></li>
  <li><a href="#split-into-train-and-test-sets" id="toc-split-into-train-and-test-sets" class="nav-link" data-scroll-target="#split-into-train-and-test-sets">Split into train and test sets</a></li>
  <li><a href="#handling-out-of-vocabulary-words" id="toc-handling-out-of-vocabulary-words" class="nav-link" data-scroll-target="#handling-out-of-vocabulary-words">Handling ‘Out of Vocabulary’ words</a></li>
  <li><a href="#expected-answer" id="toc-expected-answer" class="nav-link" data-scroll-target="#expected-answer">Expected answer</a></li>
  <li><a href="#preprocess-the-train-and-test-data" id="toc-preprocess-the-train-and-test-data" class="nav-link" data-scroll-target="#preprocess-the-train-and-test-data">Preprocess the train and test data</a></li>
  <li><a href="#estimate-probabilities-for-all-words" id="toc-estimate-probabilities-for-all-words" class="nav-link" data-scroll-target="#estimate-probabilities-for-all-words">Estimate probabilities for all words</a></li>
  <li><a href="#count-and-probability-matrices" id="toc-count-and-probability-matrices" class="nav-link" data-scroll-target="#count-and-probability-matrices">Count and probability matrices</a></li>
  <li><a href="#expected-output-10" id="toc-expected-output-10" class="nav-link" data-scroll-target="#expected-output-10">Expected Output</a></li>
  <li><a href="#expected-output-11" id="toc-expected-output-11" class="nav-link" data-scroll-target="#expected-output-11">Expected output</a></li>
  <li><a href="#get-multiple-suggestions" id="toc-get-multiple-suggestions" class="nav-link" data-scroll-target="#get-multiple-suggestions">Get multiple suggestions</a></li>
  <li><a href="#suggest-multiple-words-using-n-grams-of-varying-length" id="toc-suggest-multiple-words-using-n-grams-of-varying-length" class="nav-link" data-scroll-target="#suggest-multiple-words-using-n-grams-of-varying-length">Suggest multiple words using n-grams of varying length</a></li>
  </ul></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations">Congratulations!</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c2w3/assignment.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content">






<div class="no-row-height column-margin column-container"><div id="fig-00" class="nolightbox quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../../images/Course-Logo-2-3.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="course banner"><img src="../../images/Course-Logo-2-3.webp" class="img-fluid figure-img"></a></p>
<figcaption>course banner</figcaption>
</figure>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div></div><div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Honor code alert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Due to the Coursera Honor Code, I cannot provide the solutions to the assignments.</p>
<ul>
<li>This notebook is the original notebook provided by the course</li>
<li>It is setup to run without stopping for errors.</li>
<li>It is also likely to be out of date as the course has had some updates since I took it.</li>
<li>Although I aced the course this assignment was the most time consuming.</li>
<li>Good luck with the assignment it should make you a better programmer.</li>
<li>It is also a good idea to go over it a few times until you can do it easily.</li>
</ul>
</div>
</div>
<p>In this assignment, you will build an auto-complete system. Auto-complete system is something you may see every day - When you google something, you often have suggestions to help you complete your search. - When you are writing an email, you get suggestions telling you possible endings to your sentence.</p>
<p>By the end of this assignment, you will develop a prototype of such a system.</p>
<p><img src="stanford.png" style="width:700px;height:300px;"></p>
<section id="outline" class="level2">
<h2 class="anchored" data-anchor-id="outline">Outline</h2>
<ul>
<li><a href="#1">1 Load and Preprocess Data</a></li>
<li><a href="#1.1">1.1: Load the data</a></li>
<li><a href="#1.2">1.2 Pre-process the data</a>
<ul>
<li><a href="#ex-01">Exercise 01</a></li>
<li><a href="#ex-02">Exercise 02</a></li>
<li><a href="#ex-03">Exercise 03</a></li>
<li><a href="#ex-04">Exercise 04</a></li>
<li><a href="#ex-05">Exercise 05</a></li>
<li><a href="#ex-06">Exercise 06</a></li>
<li><a href="#ex-07">Exercise 07</a></li>
</ul></li>
<li><a href="#2">2 Develop n-gram based language models</a>
<ul>
<li><a href="#ex-08">Exercise 08</a></li>
<li><a href="#ex-09">Exercise 09</a><br>
</li>
</ul></li>
<li><a href="#3">3 Perplexity</a>
<ul>
<li><a href="#ex-10">Exercise 10</a></li>
</ul></li>
<li><a href="#4">4 Build an auto-complete system</a>
<ul>
<li><a href="#ex-11">Exercise 11</a></li>
</ul></li>
</ul>
<p>A key building block for an auto-complete system is a language model. A language model assigns the probability to a sequence of words, in a way that more “likely” sequences receive higher scores. For example, &gt;“I have a pen” is expected to have a higher probability than &gt;“I am a pen” since the first one seems to be a more natural sentence in the real world.</p>
<p>You can take advantage of this probability calculation to develop an auto-complete system.<br>
Suppose the user typed &gt;“I eat scrambled” Then you can find a word <code>x</code> such that “I eat scrambled x” receives the highest probability. If x = “eggs”, the sentence would be &gt;“I eat scrambled eggs”</p>
<p>While a variety of language models have been developed, this assignment uses <strong>N-grams</strong>, a simple but powerful method for language modeling. - N-grams are also used in machine translation and speech recognition.</p>
<p>Here are the steps of this assignment:</p>
<ol type="1">
<li>Load and preprocess data
<ul>
<li>Load and tokenize data.</li>
<li>Split the sentences into train and test sets.</li>
<li>Replace words with a low frequency by an unknown marker <code>&lt;unk&gt;</code>.</li>
</ul></li>
<li>Develop N-gram based language models
<ul>
<li>Compute the count of n-grams from a given data set.</li>
<li>Estimate the conditional probability of a next word with k-smoothing.</li>
</ul></li>
<li>Evaluate the N-gram models by computing the perplexity score.</li>
<li>Use your own model to suggest an upcoming word given your sentence.</li>
</ol>
<div id="586c9843" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>nltk.data.path.append(<span class="st">'.'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a name="1"></a> ## Part 1: Load and Preprocess Data</p>
<p><a name="1.1"></a> ### Part 1.1: Load the data You will use twitter data. Load the data and view the first few sentences by running the next cell.</p>
<p>Notice that data is a long string that contains many many tweets. Observe that there is a line break “” between tweets.</p>
<div id="5b6dde01" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"en_US.twitter.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> f:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> f.read()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data type:"</span>, <span class="bu">type</span>(data))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of letters:"</span>, <span class="bu">len</span>(data))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First 300 letters of the data"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-------"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>display(data[<span class="dv">0</span>:<span class="dv">300</span>])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-------"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Last 300 letters of the data"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-------"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>display(data[<span class="op">-</span><span class="dv">300</span>:])</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-------"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data type: &lt;class 'str'&gt;
Number of letters: 3335477
First 300 letters of the data
-------</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>"How are you? Btw thanks for the RT. You gonna be in DC anytime soon? Love to see you. Been way, way too long.\nWhen you meet someone special... you'll know. Your heart will beat more rapidly and you'll smile for no reason.\nthey've decided its more fun if I don't.\nSo Tired D; Played Lazer Tag &amp; Ran A "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>-------
Last 300 letters of the data
-------</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>"ust had one a few weeks back....hopefully we will be back soon! wish you the best yo\nColombia is with an 'o'...“: We now ship to 4 countries in South America (fist pump). Please welcome Columbia to the Stunner Family”\n#GutsiestMovesYouCanMake Giving a cat a bath.\nCoffee after 5 was a TERRIBLE idea.\n"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>-------</code></pre>
</div>
</div>
<p><a name="1.2"></a> ### Part 1.2 Pre-process the data</p>
<p>Preprocess this data with the following steps:</p>
<ol type="1">
<li>Split data into sentences using “” as the delimiter.</li>
<li>Split each sentence into tokens. Note that in this assignment we use “token” and “words” interchangeably.</li>
<li>Assign sentences into train or test sets.</li>
<li>Find tokens that appear at least N times in the training data.</li>
<li>Replace tokens that appear less than N times by <code>&lt;unk&gt;</code></li>
</ol>
<p>Note: we omit validation data in this exercise. - In real applications, we should hold a part of data as a validation set and use it to tune our training. - We skip this process for simplicity.</p>
<p><a name="ex-01"></a> ### Exercise 01</p>
<p>Split data into sentences.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
Use <a href="https://docs.python.org/3/library/stdtypes.html?highlight=split#str.split">str.split</a>
</li>
</ul>
<p></p>
<div id="9125440e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C1 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: split_to_sentences </span><span class="al">###</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_to_sentences(data):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Split data by linebreak "</span><span class="ch">\n</span><span class="co">"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">        data: str</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">        A list of sentences</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    sentences <span class="op">=</span> <span class="va">None</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional clearning (This part is already implemented)</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - Remove leading and trailing spaces from each sentence</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># - Drop sentences if they are empty strings.</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    sentences <span class="op">=</span> [s.strip() <span class="cf">for</span> s <span class="kw">in</span> sentences]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    sentences <span class="op">=</span> [s <span class="cf">for</span> s <span class="kw">in</span> sentences <span class="cf">if</span> <span class="bu">len</span>(s) <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sentences    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1f8478d0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">I have a pen.</span><span class="ch">\n</span><span class="st">I have an apple. </span><span class="ch">\n</span><span class="st">Ah</span><span class="ch">\n</span><span class="st">Apple pen.</span><span class="ch">\n</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>split_to_sentences(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
I have a pen.
I have an apple. 
Ah
Apple pen.

</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[4], line 7</span>
<span class="ansi-green-fg ansi-bold">      2</span> x <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(175,0,0)">I have a pen.</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">I have an apple. </span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">Ah</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">Apple pen.</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span>
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(175,0,0)">"""</span>
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(x)
<span class="ansi-green-fg">----&gt; 7</span> <span class="ansi-yellow-bg">split_to_sentences</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">)</span>

Cell <span class="ansi-green-fg">In[3], line 20</span>, in <span class="ansi-cyan-fg">split_to_sentences</span><span class="ansi-blue-fg">(data)</span>
<span class="ansi-green-fg ansi-bold">     14</span> sentences <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     15</span> <span style="font-style:italic;color:rgb(95,135,135)">### END CODE HERE ###</span>
<span class="ansi-green-fg ansi-bold">     16</span> 
<span class="ansi-green-fg ansi-bold">     17</span> <span style="font-style:italic;color:rgb(95,135,135)"># Additional clearning (This part is already implemented)</span>
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)"># - Remove leading and trailing spaces from each sentence</span>
<span class="ansi-green-fg ansi-bold">     19</span> <span style="font-style:italic;color:rgb(95,135,135)"># - Drop sentences if they are empty strings.</span>
<span class="ansi-green-fg">---&gt; 20</span> sentences <span style="color:rgb(98,98,98)">=</span> [s<span style="color:rgb(98,98,98)">.</span>strip() <span style="font-weight:bold;color:rgb(0,135,0)">for</span> s <span style="font-weight:bold;color:rgb(175,0,255)">in</span> sentences]
<span class="ansi-green-fg ansi-bold">     21</span> sentences <span style="color:rgb(98,98,98)">=</span> [s <span style="font-weight:bold;color:rgb(0,135,0)">for</span> s <span style="font-weight:bold;color:rgb(175,0,255)">in</span> sentences <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">len</span>(s) <span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(98,98,98)">0</span>]
<span class="ansi-green-fg ansi-bold">     23</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> sentences

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<p>Expected answer:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'I</span><span class="er"> have a pen.</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'I</span><span class="er"> have an apple.</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'A</span><span class="er">h</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'A</span><span class="er">pple pen.</span><span class="ch">'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-02"></a> ### Exercise 02 The next step is to tokenize sentences (split a sentence into a list of words). - Convert all tokens into lower case so that words which are capitalized (for example, at the start of a sentence) in the original text are treated the same as the lowercase versions of the words. - Append each tokenized list of words into a list of tokenized sentences.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
Use <a href="https://docs.python.org/3/library/stdtypes.html?highlight=split#str.lower">str.lower</a> to convert strings to lowercase.
</li>
<li>
Please use <a href="https://www.nltk.org/api/nltk.tokenize.html#nltk.tokenize.punkt.PunktLanguageVars.word_tokenize">nltk.word_tokenize</a> to split sentences into tokens.
</li>
<li>
If you used str.split insteaad of nltk.word_tokenize, there are additional edge cases to handle, such as the punctuation (comma, period) that follows a word.
</li>
</ul>
<p></p>
<div id="44942ac1" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C2 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: tokenize_sentences </span><span class="al">###</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tokenize_sentences(sentences):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Tokenize sentences into tokens (words)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">        sentences: List of strings</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">        List of lists of tokens</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the list of lists of tokenized sentences</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    tokenized_sentences <span class="op">=</span> []</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each sentence</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> <span class="va">None</span>:</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to lowercase letters</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        sentence <span class="op">=</span> <span class="va">None</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert into a list of words</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        tokenized <span class="op">=</span> <span class="va">None</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># append the list of words to the list of lists</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="va">None</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tokenized_sentences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ffda2220" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [<span class="st">"Sky is blue."</span>, <span class="st">"Leaves are green."</span>, <span class="st">"Roses are red."</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>tokenize_sentences(sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[6], line 3</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># test your code</span>
<span class="ansi-green-fg ansi-bold">      2</span> sentences <span style="color:rgb(98,98,98)">=</span> [<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Sky is blue.</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Leaves are green.</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Roses are red.</span><span style="color:rgb(175,0,0)">"</span>]
<span class="ansi-green-fg">----&gt; 3</span> <span class="ansi-yellow-bg">tokenize_sentences</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">)</span>

Cell <span class="ansi-green-fg">In[5], line 19</span>, in <span class="ansi-cyan-fg">tokenize_sentences</span><span class="ansi-blue-fg">(sentences)</span>
<span class="ansi-green-fg ansi-bold">     15</span> tokenized_sentences <span style="color:rgb(98,98,98)">=</span> []
<span class="ansi-green-fg ansi-bold">     16</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     17</span> 
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence</span>
<span class="ansi-green-fg">---&gt; 19</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">     20</span>     
<span class="ansi-green-fg ansi-bold">     21</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Convert to lowercase letters</span>
<span class="ansi-green-fg ansi-bold">     22</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     24</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Convert into a list of words</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<section id="expected-output" class="level3">
<h3 class="anchored" data-anchor-id="expected-output">Expected output</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'sky'</span><span class="op">,</span><span class="at"> 'is'</span><span class="op">,</span><span class="at"> 'blue'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">],</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="op">[</span><span class="at">'leaves'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> 'green'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">],</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="op">[</span><span class="at">'roses'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> 'red'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-03"></a> ### Exercise 03</p>
<p>Use the two functions that you have just implemented to get the tokenized data. - split the data into sentences - tokenize those sentences</p>
<div id="76457dfd" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C3 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: get_tokenized_data </span><span class="al">###</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_tokenized_data(data):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Make a list of tokenized sentences</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">        data: String</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">        List of lists of tokens</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the sentences by splitting up the data</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    sentences <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the list of lists of tokens by tokenizing the sentences</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    tokenized_sentences <span class="op">=</span> <span class="va">None</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tokenized_sentences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="85c0fd23" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your function</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="st">"Sky is blue.</span><span class="ch">\n</span><span class="st">Leaves are green</span><span class="ch">\n</span><span class="st">Roses are red."</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>get_tokenized_data(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="expected-outcome" class="level5">
<h5 class="anchored" data-anchor-id="expected-outcome">Expected outcome</h5>
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'sky'</span><span class="op">,</span><span class="at"> 'is'</span><span class="op">,</span><span class="at"> 'blue'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">],</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="op">[</span><span class="at">'leaves'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> 'green'</span><span class="op">],</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="op">[</span><span class="at">'roses'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> 'red'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="split-into-train-and-test-sets" class="level3">
<h3 class="anchored" data-anchor-id="split-into-train-and-test-sets">Split into train and test sets</h3>
<p>Now run the cell below to split data into training and test sets.</p>
<div id="311ba17a" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tokenized_data <span class="op">=</span> get_tokenized_data(data)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">87</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>random.shuffle(tokenized_data)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(tokenized_data) <span class="op">*</span> <span class="fl">0.8</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="op">=</span> tokenized_data[<span class="dv">0</span>:train_size]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="op">=</span> tokenized_data[train_size:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 3</span>
<span class="ansi-green-fg ansi-bold">      1</span> tokenized_data <span style="color:rgb(98,98,98)">=</span> get_tokenized_data(data)
<span class="ansi-green-fg ansi-bold">      2</span> random<span style="color:rgb(98,98,98)">.</span>seed(<span style="color:rgb(98,98,98)">87</span>)
<span class="ansi-green-fg">----&gt; 3</span> <span class="ansi-yellow-bg">random</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">shuffle</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_data</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      5</span> train_size <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">int</span>(<span style="color:rgb(0,135,0)">len</span>(tokenized_data) <span style="color:rgb(98,98,98)">*</span> <span style="color:rgb(98,98,98)">0.8</span>)
<span class="ansi-green-fg ansi-bold">      6</span> train_data <span style="color:rgb(98,98,98)">=</span> tokenized_data[<span style="color:rgb(98,98,98)">0</span>:train_size]

File <span class="ansi-green-fg">/usr/lib/python3.10/random.py:391</span>, in <span class="ansi-cyan-fg">Random.shuffle</span><span class="ansi-blue-fg">(self, x, random)</span>
<span class="ansi-green-fg ansi-bold">    389</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> random <span style="font-weight:bold;color:rgb(175,0,255)">is</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>:
<span class="ansi-green-fg ansi-bold">    390</span>     randbelow <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_randbelow
<span class="ansi-green-fg">--&gt; 391</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> i <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">reversed</span>(<span style="color:rgb(0,135,0)">range</span>(<span style="color:rgb(98,98,98)">1</span>, <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">len</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">x</span><span class="ansi-yellow-bg">)</span>)):
<span class="ansi-green-fg ansi-bold">    392</span>         <span style="font-style:italic;color:rgb(95,135,135)"># pick an element in x[:i+1] with which to exchange x[i]</span>
<span class="ansi-green-fg ansi-bold">    393</span>         j <span style="color:rgb(98,98,98)">=</span> randbelow(i <span style="color:rgb(98,98,98)">+</span> <span style="color:rgb(98,98,98)">1</span>)
<span class="ansi-green-fg ansi-bold">    394</span>         x[i], x[j] <span style="color:rgb(98,98,98)">=</span> x[j], x[i]

<span class="ansi-red-fg">TypeError</span>: object of type 'NoneType' has no len()</pre>
</div>
</div>
</div>
<div id="9c4a1b0f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st"> data are split into </span><span class="sc">{}</span><span class="st"> train and </span><span class="sc">{}</span><span class="st"> test set"</span>.<span class="bu">format</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">len</span>(tokenized_data), <span class="bu">len</span>(train_data), <span class="bu">len</span>(test_data)))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First training sample:"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data[<span class="dv">0</span>])</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First test sample"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[10], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,135)">{}</span><span style="color:rgb(175,0,0)"> data are split into </span><span style="font-weight:bold;color:rgb(175,95,135)">{}</span><span style="color:rgb(175,0,0)"> train and </span><span style="font-weight:bold;color:rgb(175,95,135)">{}</span><span style="color:rgb(175,0,0)"> test set</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(98,98,98)">.</span>format(
<span class="ansi-green-fg">----&gt; 2</span>     <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">len</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_data</span><span class="ansi-yellow-bg">)</span>, <span style="color:rgb(0,135,0)">len</span>(train_data), <span style="color:rgb(0,135,0)">len</span>(test_data)))
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">First training sample:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(train_data[<span style="color:rgb(98,98,98)">0</span>])

<span class="ansi-red-fg">TypeError</span>: object of type 'NoneType' has no len()</pre>
</div>
</div>
</div>
<section id="expected-output-1" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-1">Expected output</h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dv">47961</span> data are split into <span class="dv">38368</span> train <span class="kw">and</span> <span class="dv">9593</span> test set</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>First training sample<span class="op">:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'i'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">ersonally</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">ould</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">ur</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">fficial</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'g</span><span class="er">love</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">f</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">he</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">eam</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ocal</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'c</span><span class="er">ompany</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">nd</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'q</span><span class="er">uality</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">roduction</span><span class="ch">'</span><span class="op">]</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>First test sample</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'t</span><span class="er">hat</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">icture</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i'</span><span class="op">,</span> <span class="ch">'j</span><span class="er">ust</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'s</span><span class="er">een</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">hoa</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'d</span><span class="er">ere</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'!'</span><span class="op">,</span> <span class="ch">'!'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-04"></a> ### Exercise 04</p>
<p>You won’t use all the tokens (words) appearing in the data for training. Instead, you will use the more frequently used words.<br>
- You will focus on the words that appear at least N times in the data. - First count how many times each word appears in the data.</p>
<p>You will need a double for-loop, one for sentences and the other for tokens within a sentence.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
If you decide to import and use defaultdict, remember to cast the dictionary back to a regular ‘dict’ before returning it.
</li>
</ul>
<p></p>
<div id="9cc0859f" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C4 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: count_words </span><span class="al">###</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_words(tokenized_sentences):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Count the number of word appearence in the tokenized sentences</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">        tokenized_sentences: List of lists of strings</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">        dict that maps word (str) to the frequency (int)</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    word_counts <span class="op">=</span> {}</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop through each sentence</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Go through each token in the sentence</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> token <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the token is not in the dictionary yet, set the count to 1</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                word_counts[token] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the token is already in the dictionary, increment the count by 1</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                word_counts[token] <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> word_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="65f14210" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tokenized_sentences <span class="op">=</span> [[<span class="st">'sky'</span>, <span class="st">'is'</span>, <span class="st">'blue'</span>, <span class="st">'.'</span>],</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'leaves'</span>, <span class="st">'are'</span>, <span class="st">'green'</span>, <span class="st">'.'</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'roses'</span>, <span class="st">'are'</span>, <span class="st">'red'</span>, <span class="st">'.'</span>]]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>count_words(tokenized_sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 5</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># test your code</span>
<span class="ansi-green-fg ansi-bold">      2</span> tokenized_sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">sky</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">blue</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>                        [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">leaves</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">are</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">green</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      4</span>                        [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">roses</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">are</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">red</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg">----&gt; 5</span> <span class="ansi-yellow-bg">count_words</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_sentences</span><span class="ansi-yellow-bg">)</span>

Cell <span class="ansi-green-fg">In[11], line 18</span>, in <span class="ansi-cyan-fg">count_words</span><span class="ansi-blue-fg">(tokenized_sentences)</span>
<span class="ansi-green-fg ansi-bold">     14</span> word_counts <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     15</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     16</span> 
<span class="ansi-green-fg ansi-bold">     17</span> <span style="font-style:italic;color:rgb(95,135,135)"># Loop through each sentence</span>
<span class="ansi-green-fg">---&gt; 18</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     19</span>     
<span class="ansi-green-fg ansi-bold">     20</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Go through each token in the sentence</span>
<span class="ansi-green-fg ansi-bold">     21</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> token <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span> 
<span class="ansi-green-fg ansi-bold">     23</span>         <span style="font-style:italic;color:rgb(95,135,135)"># If the token is not in the dictionary yet, set the count to 1</span>
<span class="ansi-green-fg ansi-bold">     24</span>         <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</details></section>
<section id="expected-output-2" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-2">Expected output</h5>
<p>Note that the order may differ.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span><span class="ch">'s</span><span class="er">ky</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a> <span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a> <span class="ch">'b</span><span class="er">lue</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a> <span class="ch">'.'</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a> <span class="ch">'l</span><span class="er">eaves</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a> <span class="ch">'a</span><span class="er">re</span><span class="ch">'</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a> <span class="ch">'g</span><span class="er">reen</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a> <span class="ch">'r</span><span class="er">oses</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a> <span class="ch">'r</span><span class="er">ed</span><span class="ch">'</span><span class="op">:</span> <span class="dv">1</span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="handling-out-of-vocabulary-words" class="level3">
<h3 class="anchored" data-anchor-id="handling-out-of-vocabulary-words">Handling ‘Out of Vocabulary’ words</h3>
<p>If your model is performing autocomplete, but encounters a word that it never saw during training, it won’t have an input word to help it determine the next word to suggest. The model will not be able to predict the next word because there are no counts for the current word. - This ‘new’ word is called an ‘unknown word’, or <b>out of vocabulary (OOV)</b> words. - The percentage of unknown words in the test set is called the <b> OOV </b> rate.</p>
<p>To handle unknown words during prediction, use a special token to represent all unknown words ‘unk’. - Modify the training data so that it has some ‘unknown’ words to train on. - Words to convert into “unknown” words are those that do not occur very frequently in the training set. - Create a list of the most frequent words in the training set, called the <b> closed vocabulary </b>. - Convert all the other words that are not part of the closed vocabulary to the token ‘unk’.</p>
<p><a name="ex-05"></a> ### Exercise 05</p>
<p>You will now create a function that takes in a text document and a threshold <code>count_threshold</code>. - Any word whose count is greater than or equal to the threshold <code>count_threshold</code> is kept in the closed vocabulary. - Returns the word closed vocabulary list.</p>
<div id="6f04ce94" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C5 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: get_words_with_nplus_frequency </span><span class="al">###</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_words_with_nplus_frequency(tokenized_sentences, count_threshold):</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Find the words that appear N times or more</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">        tokenized_sentences: List of lists of sentences</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">        count_threshold: minimum number of occurrences for a word to be in the closed vocabulary.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">        List of words that appear N times or more</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize an empty list to contain the words that</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># appear at least 'minimum_freq' times.</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    closed_vocab <span class="op">=</span> []</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the word couts of the tokenized sentences</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the function that you defined earlier to count the words</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    word_counts <span class="op">=</span> count_words(tokenized_sentences)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for each word and its count</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word, cnt <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># check that the word's count</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is at least as great as the minimum count</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>:</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># append the word to the list</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>            <span class="va">None</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> closed_vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bef7d9c5" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>tokenized_sentences <span class="op">=</span> [[<span class="st">'sky'</span>, <span class="st">'is'</span>, <span class="st">'blue'</span>, <span class="st">'.'</span>],</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'leaves'</span>, <span class="st">'are'</span>, <span class="st">'green'</span>, <span class="st">'.'</span>],</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                       [<span class="st">'roses'</span>, <span class="st">'are'</span>, <span class="st">'red'</span>, <span class="st">'.'</span>]]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>tmp_closed_vocab <span class="op">=</span> get_words_with_nplus_frequency(tokenized_sentences, count_threshold<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Closed vocabulary:"</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp_closed_vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[14], line 5</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># test your code</span>
<span class="ansi-green-fg ansi-bold">      2</span> tokenized_sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">sky</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">blue</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>                        [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">leaves</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">are</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">green</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      4</span>                        [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">roses</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">are</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">red</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">.</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg">----&gt; 5</span> tmp_closed_vocab <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">get_words_with_nplus_frequency</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">count_threshold</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">2</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      6</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Closed vocabulary:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      7</span> <span style="color:rgb(0,135,0)">print</span>(tmp_closed_vocab)

Cell <span class="ansi-green-fg">In[13], line 20</span>, in <span class="ansi-cyan-fg">get_words_with_nplus_frequency</span><span class="ansi-blue-fg">(tokenized_sentences, count_threshold)</span>
<span class="ansi-green-fg ansi-bold">     16</span> closed_vocab <span style="color:rgb(98,98,98)">=</span> []
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)"># Get the word couts of the tokenized sentences</span>
<span class="ansi-green-fg ansi-bold">     19</span> <span style="font-style:italic;color:rgb(95,135,135)"># Use the function that you defined earlier to count the words</span>
<span class="ansi-green-fg">---&gt; 20</span> word_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_words</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_sentences</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">     22</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     23</span> 
<span class="ansi-green-fg ansi-bold">     24</span> <span style="font-style:italic;color:rgb(95,135,135)"># for each word and its count</span>
<span class="ansi-green-fg ansi-bold">     25</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> word, cnt <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     26</span>     
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># check that the word's count</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># is at least as great as the minimum count</span>

Cell <span class="ansi-green-fg">In[11], line 18</span>, in <span class="ansi-cyan-fg">count_words</span><span class="ansi-blue-fg">(tokenized_sentences)</span>
<span class="ansi-green-fg ansi-bold">     14</span> word_counts <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     15</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     16</span> 
<span class="ansi-green-fg ansi-bold">     17</span> <span style="font-style:italic;color:rgb(95,135,135)"># Loop through each sentence</span>
<span class="ansi-green-fg">---&gt; 18</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     19</span>     
<span class="ansi-green-fg ansi-bold">     20</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Go through each token in the sentence</span>
<span class="ansi-green-fg ansi-bold">     21</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> token <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span> 
<span class="ansi-green-fg ansi-bold">     23</span>         <span style="font-style:italic;color:rgb(95,135,135)"># If the token is not in the dictionary yet, set the count to 1</span>
<span class="ansi-green-fg ansi-bold">     24</span>         <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<section id="expected-output-3" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-3">Expected output</h5>
<div class="sourceCode" id="cb26"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Closed vocabulary<span class="op">:</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'.'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">re</span><span class="ch">'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-06"></a> ### Exercise 06</p>
<p>The words that appear <code>count_threshold</code> times or more are in the closed vocabulary. - All other words are regarded as <code>unknown</code>. - Replace words not in the closed vocabulary with the token <code>&lt;unk&gt;</code>.</p>
<div id="06db32f7" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C6 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: replace_oov_words_by_unk </span><span class="al">###</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> replace_oov_words_by_unk(tokenized_sentences, vocabulary, unknown_token<span class="op">=</span><span class="st">"&lt;unk&gt;"</span>):</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Replace words not in the given vocabulary with '&lt;unk&gt;' token.</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">        tokenized_sentences: List of lists of strings</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">        vocabulary: List of strings that we will use</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">        unknown_token: A string representing unknown (out-of-vocabulary) words</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">        List of lists of strings, with words not in the vocabulary replaced</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Place vocabulary into a set for faster search</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    vocabulary <span class="op">=</span> <span class="bu">set</span>(vocabulary)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize a list that will hold the sentences</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># after less frequent words are replaced by the unknown token</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    replaced_tokenized_sentences <span class="op">=</span> []</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each sentence</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> tokenized_sentences:</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize the list that will contain</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># a single sentence with "unknown_token" replacements</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        replaced_sentence <span class="op">=</span> []</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for each token in the sentence</span></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> token <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if the token is in the closed vocabulary</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> token <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>                <span class="co"># If so, append the word to the replaced_sentence</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>                <span class="va">None</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>                <span class="co"># otherwise, append the unknown token instead</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">None</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>        <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append the list of tokens to the list of lists</span></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>        replaced_tokenized_sentences.append(replaced_sentence)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> replaced_tokenized_sentences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f5bbb48d" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tokenized_sentences <span class="op">=</span> [[<span class="st">"dogs"</span>, <span class="st">"run"</span>], [<span class="st">"cats"</span>, <span class="st">"sleep"</span>]]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>vocabulary <span class="op">=</span> [<span class="st">"dogs"</span>, <span class="st">"sleep"</span>]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>tmp_replaced_tokenized_sentences <span class="op">=</span> replace_oov_words_by_unk(tokenized_sentences, vocabulary)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Original sentence:"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tokenized_sentences)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"tokenized_sentences with less frequent words converted to '&lt;unk&gt;':"</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp_replaced_tokenized_sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 3</span>
<span class="ansi-green-fg ansi-bold">      1</span> tokenized_sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">dogs</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">run</span><span style="color:rgb(175,0,0)">"</span>], [<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">cats</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">sleep</span><span style="color:rgb(175,0,0)">"</span>]]
<span class="ansi-green-fg ansi-bold">      2</span> vocabulary <span style="color:rgb(98,98,98)">=</span> [<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">dogs</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">sleep</span><span style="color:rgb(175,0,0)">"</span>]
<span class="ansi-green-fg">----&gt; 3</span> tmp_replaced_tokenized_sentences <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">replace_oov_words_by_unk</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">tokenized_sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">vocabulary</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Original sentence:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(tokenized_sentences)

Cell <span class="ansi-green-fg">In[15], line 32</span>, in <span class="ansi-cyan-fg">replace_oov_words_by_unk</span><span class="ansi-blue-fg">(tokenized_sentences, vocabulary, unknown_token)</span>
<span class="ansi-green-fg ansi-bold">     28</span> replaced_sentence <span style="color:rgb(98,98,98)">=</span> []
<span class="ansi-green-fg ansi-bold">     29</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     30</span> 
<span class="ansi-green-fg ansi-bold">     31</span> <span style="font-style:italic;color:rgb(95,135,135)"># for each token in the sentence</span>
<span class="ansi-green-fg">---&gt; 32</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> token <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     33</span>     
<span class="ansi-green-fg ansi-bold">     34</span>     <span style="font-style:italic;color:rgb(95,135,135)"># Check if the token is in the closed vocabulary</span>
<span class="ansi-green-fg ansi-bold">     35</span>     <span style="font-weight:bold;color:rgb(0,135,0)">if</span> token <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     36</span>         <span style="font-style:italic;color:rgb(95,135,135)"># If so, append the word to the replaced_sentence</span>
<span class="ansi-green-fg ansi-bold">     37</span>         <span style="font-weight:bold;color:rgb(0,135,0)">None</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</section>
</section>
<section id="expected-answer" class="level3">
<h3 class="anchored" data-anchor-id="expected-answer">Expected answer</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Original sentence<span class="op">:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'dogs'</span><span class="op">,</span><span class="at"> 'run'</span><span class="op">],</span><span class="at"> </span><span class="op">[</span><span class="at">'cats'</span><span class="op">,</span><span class="at"> 'sleep'</span><span class="op">]]</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>tokenized_sentences with less frequent words converted to <span class="ch">'&lt;</span><span class="er">unk&gt;</span><span class="ch">'</span><span class="op">:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'dogs'</span><span class="op">,</span><span class="at"> '</span><span class="op">&lt;</span><span class="at">unk</span><span class="op">&gt;</span><span class="at">'</span><span class="op">],</span><span class="at"> </span><span class="op">[</span><span class="at">'</span><span class="op">&lt;</span><span class="at">unk</span><span class="op">&gt;</span><span class="at">'</span><span class="op">,</span><span class="at"> 'sleep'</span><span class="op">]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-07"></a> ### Exercise 07</p>
<p>Now we are ready to process our data by combining the functions that you just implemented.</p>
<ol type="1">
<li>Find tokens that appear at least count_threshold times in the training data.</li>
<li>Replace tokens that appear less than count_threshold times by “&lt;unk&gt;” both for training and test data.</li>
</ol>
<div id="82777b66" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C7 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED_FUNCTION: preprocess_data </span><span class="al">###</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_data(train_data, test_data, count_threshold):</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Preprocess data, i.e.,</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">        - Find tokens that appear at least N times in the training data.</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">        - Replace tokens that appear less than N times by "&lt;unk&gt;" both for training and test data.        </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">        train_data, test_data: List of lists of strings.</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">        count_threshold: Words whose count is less than this are </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">                      treated as unknown.</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">        Tuple of</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">        - training data with low frequent words replaced by "&lt;unk&gt;"</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">        - test data with low frequent words replaced by "&lt;unk&gt;"</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">        - vocabulary of words that appear n times or more in the training data</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the closed vocabulary using the train data</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    vocabulary <span class="op">=</span> <span class="va">None</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For the train data, replace less common words with "&lt;unk&gt;"</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    train_data_replaced <span class="op">=</span> <span class="va">None</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For the test data, replace less common words with "&lt;unk&gt;"</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    test_data_replaced <span class="op">=</span> <span class="va">None</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_data_replaced, test_data_replaced, vocabulary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0eee7182" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>tmp_train <span class="op">=</span> [[<span class="st">'sky'</span>, <span class="st">'is'</span>, <span class="st">'blue'</span>, <span class="st">'.'</span>],</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     [<span class="st">'leaves'</span>, <span class="st">'are'</span>, <span class="st">'green'</span>]]</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>tmp_test <span class="op">=</span> [[<span class="st">'roses'</span>, <span class="st">'are'</span>, <span class="st">'red'</span>, <span class="st">'.'</span>]]</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>tmp_train_repl, tmp_test_repl, tmp_vocab <span class="op">=</span> preprocess_data(tmp_train, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                                                           tmp_test, </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>                                                           count_threshold <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"tmp_train_repl"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp_train_repl)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"tmp_test_repl"</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp_test_repl)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"tmp_vocab"</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tmp_vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tmp_train_repl
None

tmp_test_repl
None

tmp_vocab
None</code></pre>
</div>
</div>
<section id="expected-outcome-1" class="level5">
<h5 class="anchored" data-anchor-id="expected-outcome-1">Expected outcome</h5>
<div class="sourceCode" id="cb33"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>tmp_train_repl</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'sky'</span><span class="op">,</span><span class="at"> 'is'</span><span class="op">,</span><span class="at"> 'blue'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">],</span><span class="at"> </span><span class="op">[</span><span class="at">'leaves'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> 'green'</span><span class="op">]]</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>tmp_test_repl</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="op">[[</span><span class="at">'</span><span class="op">&lt;</span><span class="at">unk</span><span class="op">&gt;</span><span class="at">'</span><span class="op">,</span><span class="at"> 'are'</span><span class="op">,</span><span class="at"> '</span><span class="op">&lt;</span><span class="at">unk</span><span class="op">&gt;</span><span class="at">'</span><span class="op">,</span><span class="at"> '</span><span class="op">.</span><span class="at">'</span><span class="op">]]</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>tmp_vocab</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'s</span><span class="er">ky</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">lue</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'.'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">eaves</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">re</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'g</span><span class="er">reen</span><span class="ch">'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="preprocess-the-train-and-test-data" class="level3">
<h3 class="anchored" data-anchor-id="preprocess-the-train-and-test-data">Preprocess the train and test data</h3>
<p>Run the cell below to complete the preprocessing both for training and test sets.</p>
<div id="86aa0ec9" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>minimum_freq <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>train_data_processed, test_data_processed, vocabulary <span class="op">=</span> preprocess_data(train_data, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                                                                        test_data, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                                                        minimum_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[19], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> minimum_freq <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">2</span>
<span class="ansi-green-fg">----&gt; 2</span> train_data_processed, test_data_processed, vocabulary <span style="color:rgb(98,98,98)">=</span> preprocess_data(<span class="ansi-yellow-bg">train_data</span>, 
<span class="ansi-green-fg ansi-bold">      3</span>                                                                         test_data, 
<span class="ansi-green-fg ansi-bold">      4</span>                                                                         minimum_freq)

<span class="ansi-red-fg">NameError</span>: name 'train_data' is not defined</pre>
</div>
</div>
</div>
<div id="3892afbe" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First preprocessed training sample:"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data_processed[<span class="dv">0</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First preprocessed test sample:"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data_processed[<span class="dv">0</span>])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First 10 vocabulary:"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vocabulary[<span class="dv">0</span>:<span class="dv">10</span>])</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Size of vocabulary:"</span>, <span class="bu">len</span>(vocabulary))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>First preprocessed training sample:</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">First preprocessed training sample:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span style="color:rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">train_data_processed</span>[<span style="color:rgb(98,98,98)">0</span>])
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>()
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">First preprocessed test sample:</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'train_data_processed' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-4" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-4">Expected output</h5>
<div class="sourceCode" id="cb37"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>First preprocessed training sample<span class="op">:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'i'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">ersonally</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">ould</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">ur</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">fficial</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'g</span><span class="er">love</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">f</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">he</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">eam</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ocal</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'c</span><span class="er">ompany</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">nd</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'q</span><span class="er">uality</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">roduction</span><span class="ch">'</span><span class="op">]</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>First preprocessed test sample<span class="op">:</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'t</span><span class="er">hat</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">icture</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i'</span><span class="op">,</span> <span class="ch">'j</span><span class="er">ust</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'s</span><span class="er">een</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">hoa</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'d</span><span class="er">ere</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'!'</span><span class="op">,</span> <span class="ch">'!'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">,</span> <span class="ch">'&gt;'</span><span class="op">]</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>First <span class="dv">10</span> vocabulary<span class="op">:</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'i'</span><span class="op">,</span> <span class="ch">'p</span><span class="er">ersonally</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">ould</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">ur</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">fficial</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'g</span><span class="er">love</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'o</span><span class="er">f</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">he</span><span class="ch">'</span><span class="op">]</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>Size of vocabulary<span class="op">:</span> <span class="dv">14821</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You are done with the preprocessing section of the assignment. Objects <code>train_data_processed</code>, <code>test_data_processed</code>, and <code>vocabulary</code> will be used in the rest of the exercises.</p>
<p><a name="2"></a> ## Part 2: Develop n-gram based language models</p>
<p>In this section, you will develop the n-grams language model. - Assume the probability of the next word depends only on the previous n-gram. - The previous n-gram is the series of the previous ‘n’ words.</p>
<p>The conditional probability for the word at position ‘t’ in the sentence, given that the words preceding it are <span class="math inline">w_{t-1}, w_{t-2} \cdots w_{t-n}</span> is:</p>
<p><span class="math display"> P(w_t | w_{t-1}\dots w_{t-n}) \tag{1}</span></p>
<p>You can estimate this probability by counting the occurrences of these series of words in the training data. - The probability can be estimated as a ratio, where - The numerator is the number of times word ‘t’ appears after words t-1 through t-n appear in the training data. - The denominator is the number of times word t-1 through t-n appears in the training data.</p>
<p><span class="math display"> \hat{P}(w_t | w_{t-1}\dots w_{t-n}) = \frac{C(w_{t-1}\dots w_{t-n}, w_n)}{C(w_{t-1}\dots w_{t-n})} \tag{2} </span></p>
<ul>
<li>The function <span class="math inline">C(\cdots)</span> denotes the number of occurence of the given sequence.</li>
<li><span class="math inline">\hat{P}</span> means the estimation of <span class="math inline">P</span>.</li>
<li>Notice that denominator of the equation (2) is the number of occurence of the previous <span class="math inline">n</span> words, and the numerator is the same sequence followed by the word <span class="math inline">w_t</span>.</li>
</ul>
<p>Later, you will modify the equation (2) by adding k-smoothing, which avoids errors when any counts are zero.</p>
<p>The equation (2) tells us that to estimate probabilities based on n-grams, you need the counts of n-grams (for denominator) and (n+1)-grams (for numerator).</p>
<p><a name="ex-08"></a> ### Exercise 08 Next, you will implement a function that computes the counts of n-grams for an arbitrary number <span class="math inline">n</span>.</p>
<p>When computing the counts for n-grams, prepare the sentence beforehand by prepending <span class="math inline">n-1</span> starting markers “&lt;s&gt;” to indicate the beginning of the sentence.<br>
- For example, in the bi-gram model (N=2), a sequence with two start tokens “&lt;s&gt;&lt;s&gt;” should predict the first word of a sentence. - So, if the sentence is “I like food”, modify it to be “&lt;s&gt;&lt;s&gt; I like food”. - Also prepare the sentence for counting by appending an end token “&lt;e&gt;” so that the model can predict when to finish a sentence.</p>
<p>Technical note: In this implementation, you will store the counts as a dictionary. - The key of each key-value pair in the dictionary is a <strong>tuple</strong> of n words (and not a list) - The value in the key-value pair is the number of occurrences.<br>
- The reason for using a tuple as a key instead of a list is because a list in Python is a mutable object (it can be changed after it is first created). A tuple is “immutable”, so it cannot be altered after it is first created. This makes a tuple suitable as a data type for the key in a dictionary.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
To prepend or append, you can create lists and concatenate them using the + operator
</li>
<li>
To create a list of a repeated value, you can follow this syntax: <code>[‘a’] * 3</code> to get <code>[‘a’,‘a’,‘a’]</code>
</li>
<li>
To set the range for index ‘i’, think of this example: An n-gram where n=2 (bigram), and the sentence is length N=5 (including two start tokens and one end token). So the index positions are <code>[0,1,2,3,4]</code>. The largest index ‘i’ where a bigram can start is at position i=3, because the word tokens at position 3 and 4 will form the bigram.
</li>
<li>
Remember that the <code>range()</code> function excludes the value that is used for the maximum of the range. <code> range(3) </code> produces (0,1,2) but excludes 3.
</li>
</ul>
<p></p>
<div id="033eb780" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C8 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED FUNCTION: count_n_grams </span><span class="al">###</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_n_grams(data, n, start_token<span class="op">=</span><span class="st">'&lt;s&gt;'</span>, end_token <span class="op">=</span> <span class="st">'&lt;e&gt;'</span>):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Count all n-grams in the data</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">        data: List of lists of words</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">        n: number of words in a sequence</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">        A dictionary that maps a tuple of n-words to its frequency</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize dictionary of n-grams and their counts</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    n_grams <span class="op">=</span> {}</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each sentence in the data</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sentence <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># prepend start token n times, and  append &lt;e&gt; one time</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>        sentence <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># convert list to tuple</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># So that the sequence of words can be used as</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># a key in the dictionary</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>        sentence <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use 'i' to indicate the start of the n-gram</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># from index 0</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to the last index where the end of the n-gram</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is within the sentence.</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">None</span>): <span class="co"># complete this line</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get the n-gram from i to i+n</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>            n_gram <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># check if the n-gram is in the dictionary</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> n_gram <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Increment the count for this n-gram</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>                n_grams[n_gram] <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Initialize this n-gram count to 1</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>                n_grams[n_gram] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>            <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n_grams</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="20289d2f" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># CODE REVIEW COMMENT: Outcome does not match expected outcome</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>             [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Uni-gram:"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_n_grams(sentences, <span class="dv">1</span>))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Bi-gram:"</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_n_grams(sentences, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uni-gram:</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[22], line 6</span>
<span class="ansi-green-fg ansi-bold">      3</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      4</span>              [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Uni-gram:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">----&gt; 6</span> <span style="color:rgb(0,135,0)">print</span>(<span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>)
<span class="ansi-green-fg ansi-bold">      7</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Bi-gram:</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      8</span> <span style="color:rgb(0,135,0)">print</span>(count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>))

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<p>Expected outcome:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Uni<span class="op">-</span>gram<span class="op">:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="op">{(</span><span class="ch">'&lt;</span><span class="er">s&gt;</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'i'</span><span class="op">,):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'a'</span><span class="op">,):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'c</span><span class="er">at</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'&lt;</span><span class="er">e&gt;</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'t</span><span class="er">his</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'d</span><span class="er">og</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">,):</span> <span class="dv">1</span><span class="op">}</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>Bi<span class="op">-</span>gram<span class="op">:</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="op">{(</span><span class="ch">'&lt;</span><span class="er">s&gt;</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'&lt;</span><span class="er">s&gt;</span><span class="ch">'</span><span class="op">):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'&lt;</span><span class="er">s&gt;</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i'</span><span class="op">):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'i'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a'</span><span class="op">):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'a'</span><span class="op">,</span> <span class="ch">'c</span><span class="er">at</span><span class="ch">'</span><span class="op">):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'c</span><span class="er">at</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'&lt;</span><span class="er">e&gt;</span><span class="ch">'</span><span class="op">):</span> <span class="dv">2</span><span class="op">,</span> <span class="op">(</span><span class="ch">'&lt;</span><span class="er">s&gt;</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">his</span><span class="ch">'</span><span class="op">):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'t</span><span class="er">his</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'d</span><span class="er">og</span><span class="ch">'</span><span class="op">):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'d</span><span class="er">og</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">):</span> <span class="dv">1</span><span class="op">,</span> <span class="op">(</span><span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">):</span> <span class="dv">1</span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a name="ex-09"></a> ### Exercise 09</p>
<p>Next, estimate the probability of a word given the prior ‘n’ words using the n-gram counts.</p>
<p><span class="math display"> \hat{P}(w_t | w_{t-1}\dots w_{t-n}) = \frac{C(w_{t-1}\dots w_{t-n}, w_n)}{C(w_{t-1}\dots w_{t-n})} \tag{2} </span></p>
<p>This formula doesn’t work when a count of an n-gram is zero.. - Suppose we encounter an n-gram that did not occur in the training data.<br>
- Then, the equation (2) cannot be evaluated (it becomes zero divided by zero).</p>
<p>A way to handle zero counts is to add k-smoothing.<br>
- K-smoothing adds a positive constant <span class="math inline">k</span> to each numerator and <span class="math inline">k \times |V|</span> in the denominator, where <span class="math inline">|V|</span> is the number of words in the vocabulary.</p>
<p><span class="math display"> \hat{P}(w_t | w_{t-1}\dots w_{t-n}) = \frac{C(w_{t-1}\dots w_{t-n}, w_n) + k}{C(w_{t-1}\dots w_{t-n}) + k|V|} \tag{3} </span></p>
<p>For n-grams that have a zero count, the equation (3) becomes <span class="math inline">\frac{1}{|V|}</span>. - This means that any n-gram with zero count has the same probability of <span class="math inline">\frac{1}{|V|}</span>.</p>
<p>Define a function that computes the probability estimate (3) from n-gram counts and a constant <span class="math inline">k</span>.</p>
<ul>
<li>The function takes in a dictionary ‘n_gram_counts’, where the key is the n-gram and the value is the count of that n-gram.</li>
<li>The function also takes another dictionary n_plus1_gram_counts, which you’ll use to find the count for the previous n-gram plus the current word.</li>
</ul>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
To define a tuple containing a single value, add a comma after that value. For example: <code>(‘apple’,)</code> is a tuple containing a single string ‘apple’
</li>
<li>
To concatenate two tuples, use the ‘+’ operator
</li>
<li>
<a href=""> words </a>
</li>
</ul>
<p></p>
<div id="7d8576f8" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C9 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">### GRADED FUNCTION: estimate_probability </span><span class="al">###</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_probability(word, previous_n_gram, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                         n_gram_counts, n_plus1_gram_counts, vocabulary_size, k<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Estimate the probabilities of a next word using the n-gram counts with k-smoothing</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">        word: next word</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="co">        previous_n_gram: A sequence of words of length n</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">        n_gram_counts: Dictionary of counts of n-grams</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">        n_plus1_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">        vocabulary_size: number of words in the vocabulary</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">        k: positive constant, smoothing parameter</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">        A probability</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert list to tuple to use it as a dictionary key</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    previous_n_gram <span class="op">=</span> <span class="bu">tuple</span>(previous_n_gram)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the denominator</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If the previous n-gram exists in the dictionary of n-gram counts,</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get its count.  Otherwise set the count to zero</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Use the dictionary that has counts for n-grams</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    previous_n_gram_count <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the denominator using the count of the previous n gram</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and apply k-smoothing</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define n plus 1 gram as the previous n-gram plus the current word as a tuple</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    n_plus1_gram <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the count to the count in the dictionary,</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># otherwise 0 if not in the dictionary</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use the dictionary that has counts for the n-gram plus current word</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>    n_plus1_gram_count <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the numerator use the count of the n-gram plus current word,</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># and apply smoothing</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the probability as the numerator divided by denominator</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>    probability <span class="op">=</span> <span class="va">None</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> probability</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="822b6b1e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>             [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>unigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>tmp_prob <span class="op">=</span> estimate_probability(<span class="st">"cat"</span>, <span class="st">"a"</span>, unigram_counts, bigram_counts, <span class="bu">len</span>(unique_words), k<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The estimated probability of word 'cat' given the previous n-gram 'a' is: </span><span class="sc">{</span>tmp_prob<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 6</span>
<span class="ansi-green-fg ansi-bold">      2</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>              [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      4</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 6</span> unigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      7</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg ansi-bold">      8</span> tmp_prob <span style="color:rgb(98,98,98)">=</span> estimate_probability(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">"</span>, unigram_counts, bigram_counts, <span style="color:rgb(0,135,0)">len</span>(unique_words), k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>)

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</details></details></section>
<section id="expected-output-5" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-5">Expected output</h5>
<div class="sourceCode" id="cb44"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>The estimated probability of word <span class="ch">'c</span><span class="er">at</span><span class="ch">'</span> given the previous n<span class="op">-</span>gram <span class="ch">'a'</span> is<span class="op">:</span> <span class="fl">0.3333</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimate-probabilities-for-all-words" class="level3">
<h3 class="anchored" data-anchor-id="estimate-probabilities-for-all-words">Estimate probabilities for all words</h3>
<p>The function defined below loops over all words in vocabulary to calculate probabilities for all possible words. - This function is provided for you.</p>
<div id="52190f54" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_probabilities(previous_n_gram, n_gram_counts, n_plus1_gram_counts, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Estimate the probabilities of next words using the n-gram counts with k-smoothing</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">        previous_n_gram: A sequence of words of length n</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">        n_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">        n_plus1_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">        vocabulary: List of words</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">        k: positive constant, smoothing parameter</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">        A dictionary mapping from next words to the probability.</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># convert list to tuple to use it as a dictionary key</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    previous_n_gram <span class="op">=</span> <span class="bu">tuple</span>(previous_n_gram)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add &lt;e&gt; &lt;unk&gt; to the vocabulary</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &lt;s&gt; is not needed since it should not appear as the next word</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    vocabulary <span class="op">=</span> vocabulary <span class="op">+</span> [<span class="st">"&lt;e&gt;"</span>, <span class="st">"&lt;unk&gt;"</span>]</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    vocabulary_size <span class="op">=</span> <span class="bu">len</span>(vocabulary)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> {}</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word <span class="kw">in</span> vocabulary:</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> estimate_probability(word, previous_n_gram, </span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>                                           n_gram_counts, n_plus1_gram_counts, </span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>                                           vocabulary_size, k<span class="op">=</span>k)</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>        probabilities[word] <span class="op">=</span> probability</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> probabilities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="99be9b24" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>             [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>unigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">1</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>estimate_probabilities(<span class="st">"a"</span>, unigram_counts, bigram_counts, unique_words, k<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[26], line 5</span>
<span class="ansi-green-fg ansi-bold">      2</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>              [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      4</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 5</span> unigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      6</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg ansi-bold">      7</span> estimate_probabilities(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">"</span>, unigram_counts, bigram_counts, unique_words, k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>)

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<section id="expected-output-6" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-6">Expected output</h5>
<div class="sourceCode" id="cb47"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span><span class="ch">'c</span><span class="er">at</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.2727272727272727</span><span class="op">,</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a> <span class="ch">'i'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a> <span class="ch">'t</span><span class="er">his</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a> <span class="ch">'a'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a> <span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a> <span class="ch">'d</span><span class="er">og</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a> <span class="ch">'&lt;</span><span class="er">e&gt;</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a> <span class="ch">'&lt;</span><span class="er">unk&gt;</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="7fa69e6c" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Additional test</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>trigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">3</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>estimate_probabilities([<span class="st">"&lt;s&gt;"</span>, <span class="st">"&lt;s&gt;"</span>], bigram_counts, trigram_counts, unique_words, k<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[27], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Additional test</span>
<span class="ansi-green-fg">----&gt; 2</span> trigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">3</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      3</span> estimate_probabilities([<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">&lt;s&gt;</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">&lt;s&gt;</span><span style="color:rgb(175,0,0)">"</span>], bigram_counts, trigram_counts, unique_words, k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>)

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</section>
<section id="expected-output-7" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-7">Expected output</h5>
<div class="sourceCode" id="cb49"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="op">{</span><span class="ch">'c</span><span class="er">at</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a> <span class="ch">'i'</span><span class="op">:</span> <span class="fl">0.18181818181818182</span><span class="op">,</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a> <span class="ch">'t</span><span class="er">his</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.18181818181818182</span><span class="op">,</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a> <span class="ch">'a'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a> <span class="ch">'i</span><span class="er">s</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a> <span class="ch">'l</span><span class="er">ike</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a> <span class="ch">'d</span><span class="er">og</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a> <span class="ch">'&lt;</span><span class="er">e&gt;</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">,</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a> <span class="ch">'&lt;</span><span class="er">unk&gt;</span><span class="ch">'</span><span class="op">:</span> <span class="fl">0.09090909090909091</span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="count-and-probability-matrices" class="level3">
<h3 class="anchored" data-anchor-id="count-and-probability-matrices">Count and probability matrices</h3>
<p>As we have seen so far, the n-gram counts computed above are sufficient for computing the probabilities of the next word.<br>
- It can be more intuitive to present them as count or probability matrices. - The functions defined in the next cells return count or probability matrices. - This function is provided for you.</p>
<div id="460bc063" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_count_matrix(n_plus1_gram_counts, vocabulary):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add &lt;e&gt; &lt;unk&gt; to the vocabulary</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &lt;s&gt; is omitted since it should not appear as the next word</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    vocabulary <span class="op">=</span> vocabulary <span class="op">+</span> [<span class="st">"&lt;e&gt;"</span>, <span class="st">"&lt;unk&gt;"</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># obtain unique n-grams</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    n_grams <span class="op">=</span> []</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n_plus1_gram <span class="kw">in</span> n_plus1_gram_counts.keys():</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>        n_gram <span class="op">=</span> n_plus1_gram[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        n_grams.append(n_gram)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>    n_grams <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(n_grams))</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mapping from n-gram to row</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    row_index <span class="op">=</span> {n_gram:i <span class="cf">for</span> i, n_gram <span class="kw">in</span> <span class="bu">enumerate</span>(n_grams)}</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># mapping from next word to column</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    col_index <span class="op">=</span> {word:j <span class="cf">for</span> j, word <span class="kw">in</span> <span class="bu">enumerate</span>(vocabulary)}</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    nrow <span class="op">=</span> <span class="bu">len</span>(n_grams)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    ncol <span class="op">=</span> <span class="bu">len</span>(vocabulary)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    count_matrix <span class="op">=</span> np.zeros((nrow, ncol))</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n_plus1_gram, count <span class="kw">in</span> n_plus1_gram_counts.items():</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>        n_gram <span class="op">=</span> n_plus1_gram[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> n_plus1_gram[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> word <span class="kw">not</span> <span class="kw">in</span> vocabulary:</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> row_index[n_gram]</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> col_index[word]</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>        count_matrix[i, j] <span class="op">=</span> count</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    count_matrix <span class="op">=</span> pd.DataFrame(count_matrix, index<span class="op">=</span>n_grams, columns<span class="op">=</span>vocabulary)</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1339125b" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'bigram counts'</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>display(make_count_matrix(bigram_counts, unique_words))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[29], line 4</span>
<span class="ansi-green-fg ansi-bold">      1</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      2</span>                  [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      3</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 4</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">2</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      6</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">bigram counts</span><span style="color:rgb(175,0,0)">'</span>)
<span class="ansi-green-fg ansi-bold">      7</span> display(make_count_matrix(bigram_counts, unique_words))

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<section id="expected-output-8" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-8">Expected output</h5>
<div class="sourceCode" id="cb52"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bigram counts</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>          cat    i   <span class="kw">this</span>   a  is   like  dog  <span class="op">&lt;</span>e<span class="op">&gt;</span>   <span class="op">&lt;</span>unk<span class="op">&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="op">(&lt;</span>s<span class="op">&gt;,)</span>    <span class="fl">0.0</span>   <span class="fl">1.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>a<span class="op">,)</span>      <span class="fl">2.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="kw">this</span><span class="op">,)</span>   <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">1.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>like<span class="op">,)</span>   <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">2.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>dog<span class="op">,)</span>    <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>cat<span class="op">,)</span>    <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">2.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>is<span class="op">,)</span>     <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>i<span class="op">,)</span>      <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="bade4243" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show trigram counts</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">trigram counts'</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>trigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">3</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>display(make_count_matrix(trigram_counts, unique_words))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
trigram counts</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[30], line 3</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Show trigram counts</span>
<span class="ansi-green-fg ansi-bold">      2</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">trigram counts</span><span style="color:rgb(175,0,0)">'</span>)
<span class="ansi-green-fg">----&gt; 3</span> trigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">3</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      4</span> display(make_count_matrix(trigram_counts, unique_words))

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</section>
<section id="expected-output-9" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-9">Expected output</h5>
<div class="sourceCode" id="cb55"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>trigram counts</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>              cat    i   <span class="kw">this</span>   a  is   like  dog  <span class="op">&lt;</span>e<span class="op">&gt;</span>   <span class="op">&lt;</span>unk<span class="op">&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>dog<span class="op">,</span> is<span class="op">)</span>     <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="kw">this</span><span class="op">,</span> dog<span class="op">)</span>   <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>a<span class="op">,</span> cat<span class="op">)</span>      <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">2.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>like<span class="op">,</span> a<span class="op">)</span>     <span class="fl">2.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>is<span class="op">,</span> like<span class="op">)</span>    <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="op">(&lt;</span>s<span class="op">&gt;,</span> i<span class="op">)</span>      <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="op">(</span>i<span class="op">,</span> like<span class="op">)</span>     <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="op">(&lt;</span>s<span class="op">&gt;,</span> <span class="op">&lt;</span>s<span class="op">&gt;)</span>    <span class="fl">0.0</span>   <span class="fl">1.0</span>  <span class="fl">1.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="op">(&lt;</span>s<span class="op">&gt;,</span> <span class="kw">this</span><span class="op">)</span>   <span class="fl">0.0</span>   <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>  <span class="fl">0.0</span>   <span class="fl">1.0</span>  <span class="fl">0.0</span>    <span class="fl">0.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The following function calculates the probabilities of each word given the previous n-gram, and stores this in matrix form. - This function is provided for you.</p>
<div id="91101dbc" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_probability_matrix(n_plus1_gram_counts, vocabulary, k):</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    count_matrix <span class="op">=</span> make_count_matrix(n_plus1_gram_counts, unique_words)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    count_matrix <span class="op">+=</span> k</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    prob_matrix <span class="op">=</span> count_matrix.div(count_matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="1728d06b" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"bigram probabilities"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>display(make_probability_matrix(bigram_counts, unique_words, k<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[32], line 4</span>
<span class="ansi-green-fg ansi-bold">      1</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      2</span>                  [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      3</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 4</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">2</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">bigram probabilities</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      6</span> display(make_probability_matrix(bigram_counts, unique_words, k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>))

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<div id="b978a162" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"trigram probabilities"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>trigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">3</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>display(make_probability_matrix(trigram_counts, unique_words, k<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>trigram probabilities</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[33], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">trigram probabilities</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">----&gt; 2</span> trigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">3</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      3</span> display(make_probability_matrix(trigram_counts, unique_words, k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1</span>))

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
<p>Confirm that you obtain the same results as for the <code>estimate_probabilities</code> function that you implemented.</p>
<p><a name="3"></a> ## Part 3: Perplexity</p>
<p>In this section, you will generate the perplexity score to evaluate your model on the test set. - You will also use back-off when needed. - Perplexity is used as an evaluation metric of your language model. - To calculate the the perplexity score of the test set on an n-gram model, use:</p>
<p><span class="math display"> PP(W) =\sqrt[N]{ \prod_{t=n+1}^N \frac{1}{P(w_t | w_{t-n} \cdots w_{t-1})} } \tag{4}</span></p>
<ul>
<li>where <span class="math inline">N</span> is the length of the sentence.</li>
<li><span class="math inline">n</span> is the number of words in the n-gram (e.g.&nbsp;2 for a bigram).</li>
<li>In math, the numbering starts at one and not zero.</li>
</ul>
<p>In code, array indexing starts at zero, so the code will use ranges for <span class="math inline">t</span> according to this formula:</p>
<p><span class="math display"> PP(W) =\sqrt[N]{ \prod_{t=n}^{N-1} \frac{1}{P(w_t | w_{t-n} \cdots w_{t-1})} } \tag{4.1}</span></p>
<p>The higher the probabilities are, the lower the perplexity will be. - The more the n-grams tell us about the sentence, the lower the perplexity score will be.</p>
<p><a name="ex-10"></a> ### Exercise 10 Compute the perplexity score given an N-gram count matrix and a sentence.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
Remember that <code>range(2,4)</code> produces the integers [2, 3] (and excludes 4).
</li>
</ul>
<p></p>
<div id="dc9c9aa4" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C10 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: calculate_perplexity</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_perplexity(sentence, n_gram_counts, n_plus1_gram_counts, vocabulary_size, k<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate perplexity for a list of sentences</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="co">        sentence: List of strings</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co">        n_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co">        n_plus1_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co">        vocabulary_size: number of unique words in the vocabulary</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co">        k: Positive smoothing constant</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">        Perplexity score</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># length of previous words</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(<span class="bu">list</span>(n_gram_counts.keys())[<span class="dv">0</span>]) </span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prepend &lt;s&gt; and append &lt;e&gt;</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>    sentence <span class="op">=</span> [<span class="st">"&lt;s&gt;"</span>] <span class="op">*</span> n <span class="op">+</span> sentence <span class="op">+</span> [<span class="st">"&lt;e&gt;"</span>]</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cast the sentence from a list to a tuple</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    sentence <span class="op">=</span> <span class="bu">tuple</span>(sentence)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># length of sentence (after adding &lt;s&gt; and &lt;e&gt; tokens)</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(sentence)</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The variable p will hold the product</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># that is calculated inside the n-root</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update this in the code below</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    product_pi <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Index t ranges from n to N - 1, inclusive on both ends</span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="va">None</span>, <span class="va">None</span>): <span class="co"># complete this line</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the n-gram preceding the word at position t</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>        n_gram <span class="op">=</span> <span class="va">None</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the word at position t</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>        word <span class="op">=</span> <span class="va">None</span></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estimate the probability of the word given the n-gram</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># using the n-gram counts, n-plus1-gram counts,</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># vocabulary size, and smoothing constant</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>        probability <span class="op">=</span> <span class="va">None</span></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update the product of the probabilities</span></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># This 'product_pi' is a cumulative product </span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># of the (1/P) factors that are calculated in the loop</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>        product_pi <span class="op">*=</span> <span class="va">None</span></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take the Nth root of the product</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    perplexity <span class="op">=</span> <span class="va">None</span></span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span><span class="co"> </span></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> perplexity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c49bdf5b" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                 [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>unigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">1</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>perplexity_train1 <span class="op">=</span> calculate_perplexity(sentences[<span class="dv">0</span>],</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>                                         unigram_counts, bigram_counts,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="bu">len</span>(unique_words), k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Perplexity for first train sample: </span><span class="sc">{</span>perplexity_train1<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>test_sentence <span class="op">=</span> [<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'dog'</span>]</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>perplexity_test <span class="op">=</span> calculate_perplexity(test_sentence,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>                                       unigram_counts, bigram_counts,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="bu">len</span>(unique_words), k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Perplexity for test sample: </span><span class="sc">{</span>perplexity_test<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[35], line 7</span>
<span class="ansi-green-fg ansi-bold">      3</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      4</span>                  [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      5</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 7</span> unigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      8</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg ansi-bold">     11</span> perplexity_train1 <span style="color:rgb(98,98,98)">=</span> calculate_perplexity(sentences[<span style="color:rgb(98,98,98)">0</span>],
<span class="ansi-green-fg ansi-bold">     12</span>                                          unigram_counts, bigram_counts,
<span class="ansi-green-fg ansi-bold">     13</span>                                          <span style="color:rgb(0,135,0)">len</span>(unique_words), k<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(98,98,98)">1.0</span>)

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</details></section>
</section>
<section id="expected-output-10" class="level3">
<h3 class="anchored" data-anchor-id="expected-output-10">Expected Output</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>Perplexity <span class="cf">for</span> first train sample<span class="op">:</span> <span class="fl">2.8040</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Perplexity <span class="cf">for</span> test sample<span class="op">:</span> <span class="fl">3.9654</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><b> Note: </b> If your sentence is really long, there will be underflow when multiplying many fractions. - To handle longer sentences, modify your implementation to take the sum of the log of the probabilities.</p>
<p><a name="4"></a> ## Part 4: Build an auto-complete system</p>
<p>In this section, you will combine the language models developed so far to implement an auto-complete system.</p>
<p><a name="ex-11"></a> ### Exercise 11 Compute probabilities for all possible next words and suggest the most likely one. - This function also take an optional argument <code>start_with</code>, which specifies the first few letters of the next words.</p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
<code>estimate_probabilities</code> returns a dictionary where the key is a word and the value is the word’s probability.
</li>
<li>
Use <code>str1.startswith(str2)</code> to determine if a string starts with the letters of another string. For example, <code>‘learning’.startswith(‘lea’)</code> returns True, whereas <code>‘learning’.startswith(‘ear’)</code> returns False. There are two additional parameters in <code>str.startswith()</code>, but you can use the default values for those parameters in this case.
</li>
</ul>
<p></p>
<div id="6ac97347" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C11 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: suggest_a_word</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suggest_a_word(previous_tokens, n_gram_counts, n_plus1_gram_counts, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>, start_with<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Get suggestion for the next word</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">        previous_tokens: The sentence you input where each token is a word. Must have length &gt; n </span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">        n_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">        n_plus1_gram_counts: Dictionary of counts of (n+1)-grams</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">        vocabulary: List of words</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="co">        k: positive constant, smoothing parameter</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">        start_with: If not None, specifies the first few letters of the next word</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="co">        A tuple of </span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co">          - string of the most likely next word</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">          - corresponding probability</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># length of previous words</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(<span class="bu">list</span>(n_gram_counts.keys())[<span class="dv">0</span>]) </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># From the words that the user already typed</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the most recent 'n' words as the previous n-gram</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    previous_n_gram <span class="op">=</span> previous_tokens[<span class="op">-</span>n:]</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estimate the probabilities that each word in the vocabulary</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># is the next word,</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># given the previous n-gram, the dictionary of n-gram counts,</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the dictionary of n plus 1 gram counts, and the smoothing constant</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> estimate_probabilities(previous_n_gram,</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>                                           n_gram_counts, n_plus1_gram_counts,</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>                                           vocabulary, k<span class="op">=</span>k)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize suggested word to None</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># This will be set to the word with highest probability</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    suggestion <span class="op">=</span> <span class="va">None</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the highest word probability to 0</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this will be set to the highest probability </span></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># of all words to be suggested</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    max_prob <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For each word and its probability in the probabilities dictionary:</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word, prob <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the optional start_with string is set</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if the beginning of word does not match with the letters in 'start_with'</span></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if they don't match, skip this word (move onto the next word)</span></span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                <span class="va">None</span> <span class="co"># complete this line</span></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if this word's probability</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is greater than the current maximum probability</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If so, save this word as the best suggestion (so far)</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>            suggestion <span class="op">=</span> <span class="va">None</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save the new maximum probability</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>            max_prob <span class="op">=</span> <span class="va">None</span></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suggestion, max_prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e16cf123" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>             [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>unigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">1</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"i"</span>, <span class="st">"like"</span>]</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>tmp_suggest1 <span class="op">=</span> suggest_a_word(previous_tokens, unigram_counts, bigram_counts, unique_words, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are 'i like',</span><span class="ch">\n\t</span><span class="ss">and the suggested word is `</span><span class="sc">{</span>tmp_suggest1[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">` with a probability of </span><span class="sc">{</span>tmp_suggest1[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code when setting the starts_with</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>tmp_starts_with <span class="op">=</span> <span class="st">'c'</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>tmp_suggest2 <span class="op">=</span> suggest_a_word(previous_tokens, unigram_counts, bigram_counts, unique_words, k<span class="op">=</span><span class="fl">1.0</span>, start_with<span class="op">=</span>tmp_starts_with)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are 'i like', the suggestion must start with `</span><span class="sc">{</span>tmp_starts_with<span class="sc">}</span><span class="ss">`</span><span class="ch">\n\t</span><span class="ss">and the suggested word is `</span><span class="sc">{</span>tmp_suggest2[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">` with a probability of </span><span class="sc">{</span>tmp_suggest2[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[37], line 6</span>
<span class="ansi-green-fg ansi-bold">      2</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>              [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      4</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 6</span> unigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      7</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg ansi-bold">      9</span> previous_tokens <span style="color:rgb(98,98,98)">=</span> [<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">"</span>, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">"</span>]

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</details></section>
<section id="expected-output-11" class="level3">
<h3 class="anchored" data-anchor-id="expected-output-11">Expected output</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>The previous words are <span class="ch">'i</span><span class="er"> like</span><span class="ch">'</span><span class="op">,</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">and</span> the suggested word is <span class="er">`</span>a<span class="er">`</span> with a probability of <span class="fl">0.2727</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>The previous words are <span class="ch">'i</span><span class="er"> like</span><span class="ch">'</span><span class="op">,</span> the suggestion must start with <span class="er">`</span>c<span class="er">`</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">and</span> the suggested word is <span class="er">`</span>cat<span class="er">`</span> with a probability of <span class="fl">0.0909</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="get-multiple-suggestions" class="level3">
<h3 class="anchored" data-anchor-id="get-multiple-suggestions">Get multiple suggestions</h3>
<p>The function defined below loop over varioud n-gram models to get multiple suggestions.</p>
<div id="4731a3c6" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>, start_with<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    model_counts <span class="op">=</span> <span class="bu">len</span>(n_gram_counts_list)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    suggestions <span class="op">=</span> []</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(model_counts<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        n_gram_counts <span class="op">=</span> n_gram_counts_list[i]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        n_plus1_gram_counts <span class="op">=</span> n_gram_counts_list[i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>        suggestion <span class="op">=</span> suggest_a_word(previous_tokens, n_gram_counts,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                                    n_plus1_gram_counts, vocabulary,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                    k<span class="op">=</span>k, start_with<span class="op">=</span>start_with)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>        suggestions.append(suggestion)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suggestions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2765c217" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test your code</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>sentences <span class="op">=</span> [[<span class="st">'i'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>],</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>             [<span class="st">'this'</span>, <span class="st">'dog'</span>, <span class="st">'is'</span>, <span class="st">'like'</span>, <span class="st">'a'</span>, <span class="st">'cat'</span>]]</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>unique_words <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(sentences[<span class="dv">0</span>] <span class="op">+</span> sentences[<span class="dv">1</span>]))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>unigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">1</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>bigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">2</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>trigram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">3</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>quadgram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">4</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>qintgram_counts <span class="op">=</span> count_n_grams(sentences, <span class="dv">5</span>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>n_gram_counts_list <span class="op">=</span> [unigram_counts, bigram_counts, trigram_counts, quadgram_counts, qintgram_counts]</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"i"</span>, <span class="st">"like"</span>]</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>tmp_suggest3 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, unique_words, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are 'i like', the suggestions are:"</span>)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[39], line 6</span>
<span class="ansi-green-fg ansi-bold">      2</span> sentences <span style="color:rgb(98,98,98)">=</span> [[<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">i</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>],
<span class="ansi-green-fg ansi-bold">      3</span>              [<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">this</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">dog</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">is</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">like</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">a</span><span style="color:rgb(175,0,0)">'</span>, <span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">cat</span><span style="color:rgb(175,0,0)">'</span>]]
<span class="ansi-green-fg ansi-bold">      4</span> unique_words <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">list</span>(<span style="color:rgb(0,135,0)">set</span>(sentences[<span style="color:rgb(98,98,98)">0</span>] <span style="color:rgb(98,98,98)">+</span> sentences[<span style="color:rgb(98,98,98)">1</span>]))
<span class="ansi-green-fg">----&gt; 6</span> unigram_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">count_n_grams</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">sentences</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg ansi-bold">      7</span> bigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">2</span>)
<span class="ansi-green-fg ansi-bold">      8</span> trigram_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(sentences, <span style="color:rgb(98,98,98)">3</span>)

Cell <span class="ansi-green-fg">In[21], line 21</span>, in <span class="ansi-cyan-fg">count_n_grams</span><span class="ansi-blue-fg">(data, n, start_token, end_token)</span>
<span class="ansi-green-fg ansi-bold">     16</span> n_grams <span style="color:rgb(98,98,98)">=</span> {}
<span class="ansi-green-fg ansi-bold">     18</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     19</span> 
<span class="ansi-green-fg ansi-bold">     20</span> <span style="font-style:italic;color:rgb(95,135,135)"># Go through each sentence in the data</span>
<span class="ansi-green-fg">---&gt; 21</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> sentence <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>: <span style="font-style:italic;color:rgb(95,135,135)"># complete this line</span>
<span class="ansi-green-fg ansi-bold">     22</span>     
<span class="ansi-green-fg ansi-bold">     23</span>     <span style="font-style:italic;color:rgb(95,135,135)"># prepend start token n times, and  append &lt;e&gt; one time</span>
<span class="ansi-green-fg ansi-bold">     24</span>     sentence <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>
<span class="ansi-green-fg ansi-bold">     26</span>     <span style="font-style:italic;color:rgb(95,135,135)"># convert list to tuple</span>
<span class="ansi-green-fg ansi-bold">     27</span>     <span style="font-style:italic;color:rgb(95,135,135)"># So that the sequence of words can be used as</span>
<span class="ansi-green-fg ansi-bold">     28</span>     <span style="font-style:italic;color:rgb(95,135,135)"># a key in the dictionary</span>

<span class="ansi-red-fg">TypeError</span>: 'NoneType' object is not iterable</pre>
</div>
</div>
</div>
</section>
<section id="suggest-multiple-words-using-n-grams-of-varying-length" class="level3">
<h3 class="anchored" data-anchor-id="suggest-multiple-words-using-n-grams-of-varying-length">Suggest multiple words using n-grams of varying length</h3>
<p>Congratulations! You have developed all building blocks for implementing your own auto-complete systems.</p>
<p>Let’s see this with n-grams of varying lengths (unigrams, bigrams, trigrams, 4-grams…6-grams).</p>
<div id="f3994842" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>n_gram_counts_list <span class="op">=</span> []</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">6</span>):</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Computing n-gram counts with n ="</span>, n, <span class="st">"..."</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    n_model_counts <span class="op">=</span> count_n_grams(train_data_processed, n)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    n_gram_counts_list.append(n_model_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Computing n-gram counts with n = 1 ...</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[40], line 4</span>
<span class="ansi-green-fg ansi-bold">      2</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> n <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">range</span>(<span style="color:rgb(98,98,98)">1</span>, <span style="color:rgb(98,98,98)">6</span>):
<span class="ansi-green-fg ansi-bold">      3</span>     <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Computing n-gram counts with n =</span><span style="color:rgb(175,0,0)">"</span>, n, <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">...</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">----&gt; 4</span>     n_model_counts <span style="color:rgb(98,98,98)">=</span> count_n_grams(<span class="ansi-yellow-bg">train_data_processed</span>, n)
<span class="ansi-green-fg ansi-bold">      5</span>     n_gram_counts_list<span style="color:rgb(98,98,98)">.</span>append(n_model_counts)

<span class="ansi-red-fg">NameError</span>: name 'train_data_processed' is not defined</pre>
</div>
</div>
</div>
<div id="26fc299b" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"i"</span>, <span class="st">"am"</span>, <span class="st">"to"</span>]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>tmp_suggest4 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are </span><span class="sc">{</span>previous_tokens<span class="sc">}</span><span class="ss">, the suggestions are:"</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The previous words are ['i', 'am', 'to'], the suggestions are:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[]</code></pre>
</div>
</div>
<div id="bbd68e05" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"i"</span>, <span class="st">"want"</span>, <span class="st">"to"</span>, <span class="st">"go"</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>tmp_suggest5 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are </span><span class="sc">{</span>previous_tokens<span class="sc">}</span><span class="ss">, the suggestions are:"</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The previous words are ['i', 'want', 'to', 'go'], the suggestions are:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[]</code></pre>
</div>
</div>
<div id="f473ccbc" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"hey"</span>, <span class="st">"how"</span>, <span class="st">"are"</span>]</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>tmp_suggest6 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are </span><span class="sc">{</span>previous_tokens<span class="sc">}</span><span class="ss">, the suggestions are:"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The previous words are ['hey', 'how', 'are'], the suggestions are:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[]</code></pre>
</div>
</div>
<div id="92ccbbf5" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"hey"</span>, <span class="st">"how"</span>, <span class="st">"are"</span>, <span class="st">"you"</span>]</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>tmp_suggest7 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are </span><span class="sc">{</span>previous_tokens<span class="sc">}</span><span class="ss">, the suggestions are:"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest7)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The previous words are ['hey', 'how', 'are', 'you'], the suggestions are:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[]</code></pre>
</div>
</div>
<div id="60e28094" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>previous_tokens <span class="op">=</span> [<span class="st">"hey"</span>, <span class="st">"how"</span>, <span class="st">"are"</span>, <span class="st">"you"</span>]</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>tmp_suggest8 <span class="op">=</span> get_suggestions(previous_tokens, n_gram_counts_list, vocabulary, k<span class="op">=</span><span class="fl">1.0</span>, start_with<span class="op">=</span><span class="st">"d"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The previous words are </span><span class="sc">{</span>previous_tokens<span class="sc">}</span><span class="ss">, the suggestions are:"</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>display(tmp_suggest8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The previous words are ['hey', 'how', 'are', 'you'], the suggestions are:</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>[]</code></pre>
</div>
</div>
</section>
</details></details></section>
<section id="congratulations" class="level1">
<h1>Congratulations!</h1>
<p>You’ve completed this assignment by building an autocomplete model using an n-gram language model!</p>
<p>Please continue onto the fourth and final week of this course!</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{bochman2020,
  author = {Bochman, Oren},
  title = {Language {Models:} {Auto-Complete}},
  date = {2020-10-23},
  url = {https://orenbochman.github.io/notes-nlp/posts/c2w3/assignment.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-bochman2020" class="csl-entry quarto-appendix-citeas" role="listitem">
Bochman, Oren. 2020. <span>“Language Models: Auto-Complete.”</span>
October 23, 2020. <a href="https://orenbochman.github.io/notes-nlp/posts/c2w3/assignment.html">https://orenbochman.github.io/notes-nlp/posts/c2w3/assignment.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2023-2025, Oren Bochman</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c2w3/assignment.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with 💛 and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"right","loop":true,"openEffect":"fade","selector":".lightbox","skin":"my-css-class"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>