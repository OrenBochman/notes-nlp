<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Develop skills in part-of-speech (POS) tagging, the process of assigning a part-of-speech tag (Noun, Verb, Adjective…) to each word in an input text.">

<title>Assignment 2: Parts-of-Speech Tagging (POS) – NLP Specialization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1372234da3246ce8e868649689ba5ed0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-d99a2a2a191b5c7f2a9a83135e7f0803.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">NLP Specialization</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Assignment 2: Parts-of-Speech Tagging (POS)</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Assignment 2: Parts-of-Speech Tagging (POS)</h1>
            <p class="subtitle lead">Probabilistic Models</p>
                  <div>
        <div class="description">
          Develop skills in part-of-speech (POS) tagging, the process of assigning a part-of-speech tag (Noun, Verb, Adjective…) to each word in an input text.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">NLP</div>
                <div class="quarto-category">Coursera</div>
                <div class="quarto-category">Lab</div>
                <div class="quarto-category">Probabilistic Models</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-body">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Friday, October 23, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Classification &amp; Vector Spaces</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Frequencies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/lab03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L3 Visualizing tweets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w1/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1 Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability and Bayes Rule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Visualizing Naive Bayes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w2/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A2 Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector Space Models and PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Linear algebra with NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Manipulating word embeddings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A3 Hello Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Translation and Document Search via KNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L1 Vector manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/lab02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">L2 Hash functions and multiplanes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c1w3/assignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A4 Naive Machine Translation and LSH</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Probabilistic Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autocorrect and Dynamic Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part of Speech Tagging and Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Autocomplete and Language Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c2w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Word embeddings with neural networks</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Sequence Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c3w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">NLP with Attention Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Machine Translation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w3/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Question Answering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/c4w4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chat Bots</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#outline" id="toc-outline" class="nav-link active" data-scroll-target="#outline">Outline</a></li>
  <li><a href="#0" id="toc-0" class="nav-link" data-scroll-target="#0">Part 0: Data Sources</a></li>
  <li><a href="#1" id="toc-1" class="nav-link" data-scroll-target="#1">Part 1: Parts-of-speech tagging</a>
  <ul class="collapse">
  <li><a href="#1.1" id="toc-1.1" class="nav-link" data-scroll-target="#1.1">Part 1.1 - Training</a>
  <ul class="collapse">
  <li><a href="#ex-01" id="toc-ex-01" class="nav-link" data-scroll-target="#ex-01">Exercise 01</a></li>
  <li><a href="#1.2" id="toc-1.2" class="nav-link" data-scroll-target="#1.2">Part 1.2 - Testing</a></li>
  <li><a href="#ex-02" id="toc-ex-02" class="nav-link" data-scroll-target="#ex-02">Exercise 02</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#2" id="toc-2" class="nav-link" data-scroll-target="#2">Part 2: Hidden Markov Models for POS</a>
  <ul class="collapse">
  <li><a href="#2.1" id="toc-2.1" class="nav-link" data-scroll-target="#2.1">Part 2.1 Generating Matrices</a>
  <ul class="collapse">
  <li><a href="#creating-the-a-transition-probabilities-matrix" id="toc-creating-the-a-transition-probabilities-matrix" class="nav-link" data-scroll-target="#creating-the-a-transition-probabilities-matrix">Creating the ‘A’ transition probabilities matrix</a></li>
  <li><a href="#ex-03" id="toc-ex-03" class="nav-link" data-scroll-target="#ex-03">Exercise 03</a></li>
  <li><a href="#create-the-b-emission-probabilities-matrix" id="toc-create-the-b-emission-probabilities-matrix" class="nav-link" data-scroll-target="#create-the-b-emission-probabilities-matrix">Create the ‘B’ emission probabilities matrix</a></li>
  <li><a href="#ex-04" id="toc-ex-04" class="nav-link" data-scroll-target="#ex-04">Exercise 04</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#3" id="toc-3" class="nav-link" data-scroll-target="#3">Part 3: Viterbi Algorithm and Dynamic Programming</a>
  <ul class="collapse">
  <li><a href="#3.1" id="toc-3.1" class="nav-link" data-scroll-target="#3.1">Part 3.1: Initialization</a>
  <ul class="collapse">
  <li><a href="#ex-05" id="toc-ex-05" class="nav-link" data-scroll-target="#ex-05">Exercise 05</a></li>
  </ul></li>
  <li><a href="#3.2" id="toc-3.2" class="nav-link" data-scroll-target="#3.2">Part 3.2 Viterbi Forward (prediction)</a>
  <ul class="collapse">
  <li><a href="#ex-06" id="toc-ex-06" class="nav-link" data-scroll-target="#ex-06">Exercise 06</a></li>
  </ul></li>
  <li><a href="#3.3" id="toc-3.3" class="nav-link" data-scroll-target="#3.3">Part 3.3 Viterbi backward</a>
  <ul class="collapse">
  <li><a href="#ex-07" id="toc-ex-07" class="nav-link" data-scroll-target="#ex-07">Exercise 07</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#4" id="toc-4" class="nav-link" data-scroll-target="#4">Part 4: Predicting on a data set</a>
  <ul class="collapse">
  <li><a href="#ex-08" id="toc-ex-08" class="nav-link" data-scroll-target="#ex-08">Exercise 08</a></li>
  <li><a href="#key-points-and-overview" id="toc-key-points-and-overview" class="nav-link" data-scroll-target="#key-points-and-overview">Key Points and overview</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#optional" id="toc-optional" class="nav-link" data-scroll-target="#optional">Optional</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c2w2/assignment.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content">






<div class="no-row-height column-margin column-container"><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img/course-banner.jpg" class="lightbox" data-gallery="slides" title="course banner"><img src="img/course-banner.jpg" class="img-fluid figure-img" alt="course banner"></a></p>
<figcaption>course banner</figcaption>
</figure>
</div></div><div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Honor code alert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Due to the Coursera Honor Code, I cannot provide the solutions to the assignments.</p>
<ul>
<li>This notebook is the original notebook provided by the course</li>
<li>It is setup to run without stopping for errors.</li>
<li>It is also likely to be out of date as the course has had some updates since I took it.</li>
<li>Although I aced the course this assignment was the most time consuming.</li>
<li>Good luck with the assignment it should make you a better programmer.</li>
<li>It is also a good idea to go over it a few times until you can do it easily.</li>
</ul>
</div>
</div>
<p>Welcome to the second assignment of Course 2 in the Natural Language Processing specialization. This assignment will develop skills in part-of-speech (POS) tagging, the process of assigning a part-of-speech tag (Noun, Verb, Adjective…) to each word in an input text. Tagging is difficult because some words can represent more than one part of speech at different times. They are <strong>Ambiguous</strong>. Let’s look at the following example:</p>
<ul>
<li>The whole team played <strong>well</strong>. [adverb]</li>
<li>You are doing <strong>well</strong> for yourself. [adjective]</li>
<li><strong>Well</strong>, this assignment took me forever to complete. [interjection]</li>
<li>The <strong>well</strong> is dry. [noun]</li>
<li>Tears were beginning to <strong>well</strong> in her eyes. [verb]</li>
</ul>
<p>Distinguishing the parts-of-speech of a word in a sentence will help you better understand the meaning of a sentence. This would be critically important in search queries. Identifying the proper noun, the organization, the stock symbol, or anything similar would greatly improve everything ranging from speech recognition to search. By completing this assignment, you will:</p>
<ul>
<li>Learn how parts-of-speech tagging works</li>
<li>Compute the transition matrix A in a Hidden Markov Model</li>
<li>Compute the emission matrix B in a Hidden Markov Model</li>
<li>Compute the Viterbi algorithm</li>
<li>Compute the accuracy of your own model</li>
</ul>
<section id="outline" class="level2">
<h2 class="anchored" data-anchor-id="outline">Outline</h2>
<ul>
<li><a href="#0">0 Data Sources</a></li>
<li><a href="#1">1 POS Tagging</a>
<ul>
<li><a href="#1.1">1.1 Training</a>
<ul>
<li><a href="#ex-01">Exercise 01</a></li>
</ul></li>
<li><a href="#1.2">1.2 Testing</a>
<ul>
<li><a href="#ex-02">Exercise 02</a></li>
</ul></li>
</ul></li>
<li><a href="#2">2 Hidden Markov Models</a>
<ul>
<li><a href="#2.1">2.1 Generating Matrices</a>
<ul>
<li><a href="#ex-03">Exercise 03</a></li>
<li><a href="#ex-04">Exercise 04</a></li>
</ul></li>
</ul></li>
<li><a href="#3">3 Viterbi Algorithm</a>
<ul>
<li><a href="#3.1">3.1 Initialization</a>
<ul>
<li><a href="#ex-05">Exercise 05</a></li>
</ul></li>
<li><a href="#3.2">3.2 Viterbi Forward</a>
<ul>
<li><a href="#ex-06">Exercise 06</a></li>
</ul></li>
<li><a href="#3.3">3.3 Viterbi Backward</a>
<ul>
<li><a href="#ex-07">Exercise 07</a></li>
</ul></li>
</ul></li>
<li><a href="#4">4 Predicting on a data set</a>
<ul>
<li><a href="#ex-08">Exercise 08</a></li>
</ul></li>
</ul>
<div id="376704c5" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing packages and loading in the data set </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> utils_pos <span class="im">import</span> get_word_tag, preprocess  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="0" class="level2">
<h2 class="anchored" data-anchor-id="0">Part 0: Data Sources</h2>
<p>This assignment will use two tagged data sets collected from the <strong>Wall Street Journal (WSJ)</strong>.</p>
<p><a href="http://relearn.be/2015/training-common-sense/sources/software/pattern-2.6-critical-fork/docs/html/mbsp-tags.html">Here</a> is an example ‘tag-set’ or Part of Speech designation describing the two or three letter tag and their meaning.</p>
<ul>
<li>One data set (<strong>WSJ-2_21.pos</strong>) will be used for <strong>training</strong>.</li>
<li>The other (<strong>WSJ-24.pos</strong>) for <strong>testing</strong>.</li>
<li>The tagged training data has been preprocessed to form a vocabulary (<strong>hmm_vocab.txt</strong>).</li>
<li>The words in the vocabulary are words from the training set that were used two or more times.</li>
<li>The vocabulary is augmented with a set of ‘unknown word tokens’, described below.</li>
</ul>
<p>The training set will be used to create the emission, transmission and tag counts.</p>
<p>The test set (WSJ-24.pos) is read in to create <code>y</code>.</p>
<ul>
<li>This contains both the test text and the true tag.</li>
<li>The test set has also been preprocessed to remove the tags to form <strong>test_words.txt</strong>.</li>
<li>This is read in and further processed to identify the end of sentences and handle words not in the vocabulary using functions provided in <strong>utils_pos.py</strong>.</li>
<li>This forms the list <code>prep</code>, the preprocessed text used to test our POS taggers.</li>
</ul>
<p>A POS tagger will necessarily encounter words that are not in its datasets.</p>
<ul>
<li>To improve accuracy, these words are further analyzed during preprocessing to extract available hints as to their appropriate tag.</li>
<li>For example, the suffix ‘ize’ is a hint that the word is a verb, as in ‘final-ize’ or ‘character-ize’.</li>
<li>A set of unknown-tokens, such as ‘–unk-verb–’ or ‘–unk-noun–’ will replace the unknown words in both the training and test corpus and will appear in the emission, transmission and tag data structures.</li>
</ul>
<p><a href="img/DataSources1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="img/DataSources1.png" class="img-fluid"></a></p>
<p>Implementation note:</p>
<ul>
<li>For python 3.6 and beyond, dictionaries retain the insertion order.</li>
<li>Furthermore, their hash-based lookup makes them suitable for rapid membership tests.
<ul>
<li>If <em>di</em> is a dictionary, <code>key in di</code> will return <code>True</code> if <em>di</em> has a key <em>key</em>, else <code>False</code>.</li>
</ul></li>
</ul>
<p>The dictionary <code>vocab</code> will utilize these features.</p>
<div id="c0b1e53b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in the training corpus</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"WSJ_02-21.pos"</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    training_corpus <span class="op">=</span> f.readlines()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"A few items of the training corpus list"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(training_corpus[<span class="dv">0</span>:<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A few items of the training corpus list
['In\tIN\n', 'an\tDT\n', 'Oct.\tNNP\n', '19\tCD\n', 'review\tNN\n']</code></pre>
</div>
</div>
<div id="7ef0caa0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the vocabulary data, split by each line of text, and save the list</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"hmm_vocab.txt"</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    voc_l <span class="op">=</span> f.read().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A few items of the vocabulary list"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(voc_l[<span class="dv">0</span>:<span class="dv">50</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A few items at the end of the vocabulary list"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(voc_l[<span class="op">-</span><span class="dv">50</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A few items of the vocabulary list
['!', '#', '$', '%', '&amp;', "'", "''", "'40s", "'60s", "'70s", "'80s", "'86", "'90s", "'N", "'S", "'d", "'em", "'ll", "'m", "'n'", "'re", "'s", "'til", "'ve", '(', ')', ',', '-', '--', '--n--', '--unk--', '--unk_adj--', '--unk_adv--', '--unk_digit--', '--unk_noun--', '--unk_punct--', '--unk_upper--', '--unk_verb--', '.', '...', '0.01', '0.0108', '0.02', '0.03', '0.05', '0.1', '0.10', '0.12', '0.13', '0.15']

A few items at the end of the vocabulary list
['yards', 'yardstick', 'year', 'year-ago', 'year-before', 'year-earlier', 'year-end', 'year-on-year', 'year-round', 'year-to-date', 'year-to-year', 'yearlong', 'yearly', 'years', 'yeast', 'yelled', 'yelling', 'yellow', 'yen', 'yes', 'yesterday', 'yet', 'yield', 'yielded', 'yielding', 'yields', 'you', 'young', 'younger', 'youngest', 'youngsters', 'your', 'yourself', 'youth', 'youthful', 'yuppie', 'yuppies', 'zero', 'zero-coupon', 'zeroing', 'zeros', 'zinc', 'zip', 'zombie', 'zone', 'zones', 'zoning', '{', '}', '']</code></pre>
</div>
</div>
<div id="fc7da94c" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vocab: dictionary that has the index of the corresponding words</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> {} </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the index of the corresponding words. </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, word <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">sorted</span>(voc_l)): </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    vocab[word] <span class="op">=</span> i       </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vocabulary dictionary, key is the word, value is a unique integer"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>cnt <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k,v <span class="kw">in</span> vocab.items():</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    cnt <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cnt <span class="op">&gt;</span> <span class="dv">20</span>:</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Vocabulary dictionary, key is the word, value is a unique integer
:0
!:1
#:2
$:3
%:4
&amp;:5
':6
'':7
'40s:8
'60s:9
'70s:10
'80s:11
'86:12
'90s:13
'N:14
'S:15
'd:16
'em:17
'll:18
'm:19
'n':20</code></pre>
</div>
</div>
<div id="ceeae421" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load in the test corpus</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"WSJ_24.pos"</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> f.readlines()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A sample of the test corpus"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y[<span class="dv">0</span>:<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A sample of the test corpus
['The\tDT\n', 'economy\tNN\n', "'s\tPOS\n", 'temperature\tNN\n', 'will\tMD\n', 'be\tVB\n', 'taken\tVBN\n', 'from\tIN\n', 'several\tJJ\n', 'vantage\tNN\n']</code></pre>
</div>
</div>
<div id="a4174368" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#corpus without tags, preprocessed</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>_, prep <span class="op">=</span> preprocess(vocab, <span class="st">"test.words"</span>)     </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The length of the preprocessed test corpus: '</span>, <span class="bu">len</span>(prep))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'This is a sample of the test_corpus: '</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(prep[<span class="dv">0</span>:<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The length of the preprocessed test corpus:  34199
This is a sample of the test_corpus: 
['The', 'economy', "'s", 'temperature', 'will', 'be', 'taken', 'from', 'several', '--unk--']</code></pre>
</div>
</div>
</section>
<section id="1" class="level1">
<h1>Part 1: Parts-of-speech tagging</h1>
<section id="1.1" class="level2">
<h2 class="anchored" data-anchor-id="1.1">Part 1.1 - Training</h2>
<p>You will start with the simplest possible parts-of-speech tagger and we will build up to the state of the art.</p>
<p>In this section, you will find the words that are not ambiguous.</p>
<ul>
<li>For example, the word <code>is</code> is a verb and it is not ambiguous.</li>
<li>In the <code>WSJ</code> corpus, <span class="math inline">86</span>% of the token are unambiguous (meaning they have only one tag)</li>
<li>About <span class="math inline">14\%</span> are ambiguous (meaning that they have more than one tag)</li>
</ul>
<p><img src="img/pos.png" class="img-fluid">{ style=“width:400px;height:250px; group=”slides”}</p>
<p>Before you start predicting the tags of each word, you will need to compute a few dictionaries that will help you to generate the tables.</p>
<section id="transition-counts" class="level4">
<h4 class="anchored" data-anchor-id="transition-counts">Transition counts</h4>
<ul>
<li>The first dictionary is the <code>transition_counts</code> dictionary which computes the number of times each tag happened next to another tag.</li>
</ul>
<p>This dictionary will be used to compute: <span class="math display">
P(t_i |t_{i-1}) \tag{1}
</span></p>
<p>This is the probability of a tag at position <span class="math inline">i</span> given the tag at position <span class="math inline">i-1</span>.</p>
<p>In order for you to compute equation 1, you will create a <code>transition_counts</code> dictionary where - The keys are <code>(prev_tag, tag)</code> - The values are the number of times those two tags appeared in that order.</p>
</section>
<section id="emission-counts" class="level4">
<h4 class="anchored" data-anchor-id="emission-counts">Emission counts</h4>
<p>The second dictionary you will compute is the <code>emission_counts</code> dictionary. This dictionary will be used to compute:</p>
<p><span class="math display">
P(w_i|t_i)\tag{2}
</span></p>
<p>In other words, you will use it to compute the probability of a word given its tag.</p>
<p>In order for you to compute equation 2, you will create an <code>emission_counts</code> dictionary where - The keys are <code>(tag, word)</code> - The values are the number of times that pair showed up in your training set.</p>
</section>
<section id="tag-counts" class="level4">
<h4 class="anchored" data-anchor-id="tag-counts">Tag counts</h4>
<p>The last dictionary you will compute is the <code>tag_counts</code> dictionary. - The key is the tag - The value is the number of times each tag appeared.</p>
</section>
<section id="ex-01" class="level3">
<h3 class="anchored" data-anchor-id="ex-01">Exercise 01</h3>
<p><strong>Instructions:</strong> Write a program that takes in the <code>training_corpus</code> and returns the three dictionaries mentioned above <code>transition_counts</code>, <code>emission_counts</code>, and <code>tag_counts</code>.</p>
<ul>
<li><code>emission_counts</code>: maps (tag, word) to the number of times it happened.</li>
<li><code>transition_counts</code>: maps (prev_tag, tag) to the number of times it has appeared.</li>
<li><code>tag_counts</code>: maps (tag) to the number of times it has occured.</li>
</ul>
<p>Implementation note: This routine utilises <code>defaultdict</code>, which is a subclass of <code>dict</code>.</p>
<ul>
<li>A standard Python dictionary throws a <em>KeyError</em> if you try to access an item with a key that is not currently in the dictionary.</li>
<li>In contrast, the <em>defaultdict</em> will create an item of the type of the argument, in this case an integer with the default value of 0.</li>
<li>See <a href="https://docs.python.org/3.3/library/collections.html#defaultdict-objects">defaultdict</a>.</li>
</ul>
<div id="f7fccd2c" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C1 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: create_dictionaries</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_dictionaries(training_corpus, vocab):</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">        training_corpus: a corpus where each line has a word followed by its tag.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab: a dictionary where keys are words in vocabulary and value is an index</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Output: </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">        emission_counts: a dictionary where the keys are (tag, word) and the values are the counts</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">        transition_counts: a dictionary where the keys are (prev_tag, tag) and the values are the counts</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">        tag_counts: a dictionary where the keys are the tags and the values are the counts</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialize the dictionaries using defaultdict</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    emission_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    transition_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    tag_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize "prev_tag" (previous tag) with the start state, denoted by '--s--'</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    prev_tag <span class="op">=</span> <span class="st">'--s--'</span> </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use 'i' to track the line number in the corpus</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Each item in the training corpus contains a word and its POS tag</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each word and its tag in the training corpus</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word_tag <span class="kw">in</span> training_corpus:</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment the word_tag count</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Every 50,000 words, print the word count</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">%</span> <span class="dv">50000</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"word count = </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>        <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the word and tag using the get_word_tag helper function (imported from utils_pos.py)</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>        word, tag <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment the transition count for the previous word and tag</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        transition_counts[(prev_tag, tag)] <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment the emission count for the tag and word</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>        emission_counts[(tag, word)] <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Increment the tag count</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>        tag_counts[tag] <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set the previous tag to this tag (for the next iteration of the loop)</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>        prev_tag <span class="op">=</span> <span class="va">None</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_counts, transition_counts, tag_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3e89d35f" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>emission_counts, transition_counts, tag_counts <span class="op">=</span> create_dictionaries(training_corpus, vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[8], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> emission_counts, transition_counts, tag_counts <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">create_dictionaries</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">training_corpus</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">vocab</span><span class="ansi-yellow-bg">)</span>

Cell <span class="ansi-green-fg">In[7], line 38</span>, in <span class="ansi-cyan-fg">create_dictionaries</span><span class="ansi-blue-fg">(training_corpus, vocab)</span>
<span class="ansi-green-fg ansi-bold">     34</span>     <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">word count = </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>i<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">     36</span> <span style="font-style:italic;color:rgb(95,135,135)">### START CODE HERE (Replace instances of 'None' with your code) ###</span>
<span class="ansi-green-fg ansi-bold">     37</span> <span style="font-style:italic;color:rgb(95,135,135)"># get the word and tag using the get_word_tag helper function (imported from utils_pos.py)</span>
<span class="ansi-green-fg">---&gt; 38</span> word, tag <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span> 
<span class="ansi-green-fg ansi-bold">     40</span> <span style="font-style:italic;color:rgb(95,135,135)"># Increment the transition count for the previous word and tag</span>
<span class="ansi-green-fg ansi-bold">     41</span> transition_counts[(prev_tag, tag)] <span style="color:rgb(98,98,98)">+</span><span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">None</span>

<span class="ansi-red-fg">TypeError</span>: cannot unpack non-iterable NoneType object</pre>
</div>
</div>
</div>
<div id="619ca4d8" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get all the POS states</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> <span class="bu">sorted</span>(tag_counts.keys())</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of POS tags (number of 'states'): </span><span class="sc">{</span><span class="bu">len</span>(states)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"View these POS tags (states)"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(states)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># get all the POS states</span>
<span class="ansi-green-fg">----&gt; 2</span> states <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">sorted</span>(<span class="ansi-yellow-bg">tag_counts</span><span style="color:rgb(98,98,98)">.</span>keys())
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Number of POS tags (number of </span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">states</span><span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">): </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span style="color:rgb(0,135,0)">len</span>(states)<span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">View these POS tags (states)</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'tag_counts' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output" class="level5">
<h5 class="anchored" data-anchor-id="expected-output">Expected Output</h5>
<div class="sourceCode" id="cb15"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Number of POS tags <span class="op">(</span>number of <span class="ch">'s</span><span class="er">tates</span><span class="ch">'</span><span class="dv">46</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>View these states</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="op">[</span><span class="ch">'#'</span><span class="op">,</span> <span class="ch">'$'</span><span class="op">,</span> <span class="st">"''"</span><span class="op">,</span> <span class="ch">'('</span><span class="op">,</span> <span class="ch">')'</span><span class="op">,</span> <span class="ch">','</span><span class="op">,</span> <span class="ch">'-</span><span class="er">-s--</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'.'</span><span class="op">,</span> <span class="ch">':'</span><span class="op">,</span> <span class="ch">'C</span><span class="er">C</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'C</span><span class="er">D</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'D</span><span class="er">T</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'E</span><span class="er">X</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'F</span><span class="er">W</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'I</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'J</span><span class="er">J</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'J</span><span class="er">JR</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'J</span><span class="er">JS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'L</span><span class="er">S</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'M</span><span class="er">D</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">NP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">NPS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">NS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">DT</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">OS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">RP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">RP$</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'R</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'R</span><span class="er">BR</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'R</span><span class="er">BS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'R</span><span class="er">P</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'S</span><span class="er">YM</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'T</span><span class="er">O</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'U</span><span class="er">H</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BD</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BG</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BN</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BZ</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'W</span><span class="er">DT</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'W</span><span class="er">P</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'W</span><span class="er">P$</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'W</span><span class="er">RB</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'`</span><span class="er">`</span><span class="ch">'</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The ‘states’ are the Parts-of-speech designations found in the training data. They will also be referred to as ‘tags’ or POS in this assignment.</p>
<ul>
<li>“NN” is noun, singular,</li>
<li>‘NNS’ is noun, plural.</li>
<li>In addition, there are helpful tags like ‘–s–’ which indicate a start of a sentence.</li>
<li>You can get a more complete description at <a href="https://www.clips.uantwerpen.be/pages/mbsp-tags">Penn Treebank II tag set</a>.</li>
</ul>
<div id="1bbcea4b" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"transition examples: "</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ex <span class="kw">in</span> <span class="bu">list</span>(transition_counts.items())[:<span class="dv">3</span>]:</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(ex)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"emission examples: "</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ex <span class="kw">in</span> <span class="bu">list</span>(emission_counts.items())[<span class="dv">200</span>:<span class="dv">203</span>]:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (ex)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ambiguous word example: "</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tup,cnt <span class="kw">in</span> emission_counts.items():</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tup[<span class="dv">1</span>] <span class="op">==</span> <span class="st">'back'</span>: <span class="bu">print</span> (tup, cnt) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>transition examples: </code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[10], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">transition examples: </span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg">----&gt; 2</span> <span style="font-weight:bold;color:rgb(0,135,0)">for</span> ex <span style="font-weight:bold;color:rgb(175,0,255)">in</span> <span style="color:rgb(0,135,0)">list</span>(<span class="ansi-yellow-bg">transition_counts</span><span style="color:rgb(98,98,98)">.</span>items())[:<span style="color:rgb(98,98,98)">3</span>]:
<span class="ansi-green-fg ansi-bold">      3</span>     <span style="color:rgb(0,135,0)">print</span>(ex)
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>()

<span class="ansi-red-fg">NameError</span>: name 'transition_counts' is not defined</pre>
</div>
</div>
</div>
</section>
<section id="expected-output-1" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-1">Expected Output</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>transition examples<span class="op">:</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'-</span><span class="er">-s--</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'I</span><span class="er">N</span><span class="ch">'</span><span class="op">),</span> <span class="dv">5050</span><span class="op">)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'I</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'D</span><span class="er">T</span><span class="ch">'</span><span class="op">),</span> <span class="dv">32364</span><span class="op">)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'D</span><span class="er">T</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">NP</span><span class="ch">'</span><span class="op">),</span> <span class="dv">9044</span><span class="op">)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>emission examples<span class="op">:</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'D</span><span class="er">T</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'a</span><span class="er">ny</span><span class="ch">'</span><span class="op">),</span> <span class="dv">721</span><span class="op">)</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'d</span><span class="er">ecrease</span><span class="ch">'</span><span class="op">),</span> <span class="dv">7</span><span class="op">)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="op">((</span><span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'i</span><span class="er">nsider-trading</span><span class="ch">'</span><span class="op">),</span> <span class="dv">5</span><span class="op">)</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>ambiguous word example<span class="op">:</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'R</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">304</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'V</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">20</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'R</span><span class="er">P</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">84</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'J</span><span class="er">J</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">25</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">29</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="op">(</span><span class="ch">'V</span><span class="er">BP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">ack</span><span class="ch">'</span><span class="op">)</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="1.2" class="level3">
<h3 class="anchored" data-anchor-id="1.2">Part 1.2 - Testing</h3>
<p>Now you will test the accuracy of your parts-of-speech tagger using your <code>emission_counts</code> dictionary. - Given your preprocessed test corpus <code>prep</code>, you will assign a parts-of-speech tag to every word in that corpus. - Using the original tagged test corpus <code>y</code>, you will then compute what percent of the tags you got correct.</p>
</section>
<section id="ex-02" class="level3">
<h3 class="anchored" data-anchor-id="ex-02">Exercise 02</h3>
<p><strong>Instructions:</strong> Implement <code>predict_pos</code> that computes the accuracy of your model.</p>
<ul>
<li>This is a warm up exercise.</li>
<li>To assign a part of speech to a word, assign the most frequent POS for that word in the training set.</li>
<li>Then evaluate how well this approach works. Each time you predict based on the most frequent POS for the given word, check whether the actual POS of that word is the same. If so, the prediction was correct!</li>
<li>Calculate the accuracy as the number of correct predictions divided by the total number of words for which you predicted the POS tag.</li>
</ul>
<div id="6f5fe02e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C2 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: predict_pos</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_pos(prep, y, emission_counts, vocab, states):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">        prep: a preprocessed version of 'y'. A list with the 'word' component of the tuples.</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">        y: a corpus composed of a list of tuples where each tuple consists of (word, POS)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">        emission_counts: a dictionary where the keys are (tag,word) tuples and the value is the count</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab: a dictionary where keys are words in vocabulary and value is an index</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">        states: a sorted list of all possible tags for this assignment</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Output: </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">        accuracy: Number of times you classified a word correctly</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the number of correct predictions to zero</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    num_correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the (tag, word) tuples, stored as a set</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    all_words <span class="op">=</span> <span class="bu">set</span>(emission_counts.keys())</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of (word, POS) tuples in the corpus 'y'</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> word, y_tup <span class="kw">in</span> <span class="bu">zip</span>(prep, y): </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split the (word, POS) string into a list of two items</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>        y_tup_l <span class="op">=</span> y_tup.split()</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Verify that y_tup contain both word and POS</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(y_tup_l) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Set the true POS label for this word</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>            true_label <span class="op">=</span> y_tup_l[<span class="dv">1</span>]</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the y_tup didn't contain word and POS, go to next word</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        count_final <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        pos_final <span class="op">=</span> <span class="st">''</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the word is in the vocabulary...</span></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> word <span class="kw">in</span> vocab:</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> pos <span class="kw">in</span> states:</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>            <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>                <span class="co"># define the key as the tuple containing the POS and word</span></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>                key <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>                <span class="co"># check if the (pos, word) key exists in the emission_counts dictionary</span></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> key <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the emission count of the (pos,word) tuple </span></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>                    count <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># keep track of the POS with the largest count</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># update the final count (largest count)</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>                        count_final <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># update the final POS</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>                        pos_final <span class="op">=</span> <span class="va">None</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the final POS (with the largest count) matches the true POS:</span></span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Update the number of correct predictions</span></span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>                num_correct <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="op">=</span> num_correct <span class="op">/</span> total</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="772e9c3d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>accuracy_predict_pos <span class="op">=</span> predict_pos(prep, y, emission_counts, vocab, states)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of prediction using predict_pos is </span><span class="sc">{</span>accuracy_predict_pos<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[12], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> accuracy_predict_pos <span style="color:rgb(98,98,98)">=</span> predict_pos(prep, y, <span class="ansi-yellow-bg">emission_counts</span>, vocab, states)
<span class="ansi-green-fg ansi-bold">      2</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Accuracy of prediction using predict_pos is </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>accuracy_predict_pos<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'emission_counts' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-2" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-2">Expected Output</h5>
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Accuracy of prediction <span class="kw">using</span> predict_pos is <span class="fl">0.8889</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>88.9% is really good for this warm up exercise. With hidden markov models, you should be able to get <strong>95% accuracy.</strong></p>
</section>
</section>
</section>
</section>
<section id="2" class="level1">
<h1>Part 2: Hidden Markov Models for POS</h1>
<p>Now you will build something more context specific. Concretely, you will be implementing a Hidden Markov Model (HMM) with a Viterbi decoder</p>
<ul>
<li>The HMM is one of the most commonly used algorithms in Natural Language Processing, and is a foundation to many deep learning techniques you will see in this specialization.</li>
<li>In addition to parts-of-speech tagging, HMM is used in speech recognition, speech synthesis, etc.</li>
<li>By completing this part of the assignment you will get a 95% accuracy on the same dataset you used in Part 1.</li>
</ul>
<p>The Markov Model contains a number of states and the probability of transition between those states.</p>
<ul>
<li>In this case, the states are the parts-of-speech.</li>
<li>A Markov Model utilizes a transition matrix, <code>A</code>.</li>
<li>A Hidden Markov Model adds an observation or emission matrix <code>B</code> which describes the probability of a visible observation when we are in a particular state.</li>
<li>In this case, the emissions are the words in the corpus</li>
<li>The state, which is hidden, is the POS tag of that word.</li>
</ul>
<section id="2.1" class="level2">
<h2 class="anchored" data-anchor-id="2.1">Part 2.1 Generating Matrices</h2>
<section id="creating-the-a-transition-probabilities-matrix" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-a-transition-probabilities-matrix">Creating the ‘A’ transition probabilities matrix</h3>
<p>Now that you have your <code>emission_counts</code>, <code>transition_counts</code>, and <code>tag_counts</code>, you will start implementing the Hidden Markov Model.</p>
<p>This will allow you to quickly construct the - <code>A</code> transition probabilities matrix. - and the <code>B</code> emission probabilities matrix.</p>
<p>You will also use some smoothing when computing these matrices.</p>
<p>Here is an example of what the <code>A</code> transition matrix would look like (it is simplified to 5 tags for viewing. It is 46x46 in this assignment.):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 3%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th><strong>A</strong></th>
<th>…</th>
<th>RBS</th>
<th>RP</th>
<th>SYM</th>
<th>TO</th>
<th>UH</th>
<th>…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>RBS</strong></td>
<td>…</td>
<td>2.217069e-06</td>
<td>2.217069e-06</td>
<td>2.217069e-06</td>
<td>0.008870</td>
<td>2.217069e-06</td>
<td>…</td>
</tr>
<tr class="even">
<td><strong>RP</strong></td>
<td>…</td>
<td>3.756509e-07</td>
<td>7.516775e-04</td>
<td>3.756509e-07</td>
<td>0.051089</td>
<td>3.756509e-07</td>
<td>…</td>
</tr>
<tr class="odd">
<td><strong>SYM</strong></td>
<td>…</td>
<td>1.722772e-05</td>
<td>1.722772e-05</td>
<td>1.722772e-05</td>
<td>0.000017</td>
<td>1.722772e-05</td>
<td>…</td>
</tr>
<tr class="even">
<td><strong>TO</strong></td>
<td>…</td>
<td>4.477336e-05</td>
<td>4.472863e-08</td>
<td>4.472863e-08</td>
<td>0.000090</td>
<td>4.477336e-05</td>
<td>…</td>
</tr>
<tr class="odd">
<td><strong>UH</strong></td>
<td>…</td>
<td>1.030439e-05</td>
<td>1.030439e-05</td>
<td>1.030439e-05</td>
<td>0.061837</td>
<td>3.092348e-02</td>
<td>…</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>Note that the matrix above was computed with smoothing.</p>
<p>Each cell gives you the probability to go from one part of speech to another.</p>
<ul>
<li>In other words, there is a 4.47e-8 chance of going from parts-of-speech <code>TO</code> to <code>RP</code>.</li>
<li>The sum of each row has to equal 1, because we assume that the next POS tag must be one of the available columns in the table.</li>
</ul>
<p>The smoothing was done as follows:</p>
<p><span class="math display">
P(t_i | t_{i-1}) = \frac{C(t_{i-1}, t_{i}) + \alpha }{C(t_{i-1}) +\alpha * N}\tag{3}
</span></p>
<ul>
<li><span class="math inline">N</span> is the total number of tags</li>
<li><span class="math inline">C(t_{i-1}, t_{i})</span> is the count of the tuple (previous POS, current POS) in <code>transition_counts</code> dictionary.</li>
<li><span class="math inline">C(t_{i-1})</span> is the count of the previous POS in the <code>tag_counts</code> dictionary.</li>
<li><span class="math inline">\alpha</span> is a smoothing parameter.</li>
</ul>
</section>
<section id="ex-03" class="level3">
<h3 class="anchored" data-anchor-id="ex-03">Exercise 03</h3>
<p><strong>Instructions:</strong> Implement the <code>create_transition_matrix</code> below for all tags. Your task is to output a matrix that computes equation 3 for each cell in matrix <code>A</code>.</p>
<div id="6022f27b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C3 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: create_transition_matrix</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(alpha, tag_counts, transition_counts):</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">''' </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">        alpha: number used for smoothing</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">        tag_counts: a dictionary mapping each tag to its respective count</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">        transition_counts: transition count for the previous word and tag</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Output:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">        A: matrix of dimension (num_tags,num_tags)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a sorted list of unique POS tags</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    all_tags <span class="op">=</span> <span class="bu">sorted</span>(tag_counts.keys())</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count the number of unique POS tags</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    num_tags <span class="op">=</span> <span class="bu">len</span>(all_tags)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the transition matrix 'A'</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.zeros((num_tags,num_tags))</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the unique transition tuples (previous POS, current POS)</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    trans_keys <span class="op">=</span> <span class="bu">set</span>(transition_counts.keys())</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span><span class="co"> </span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each row of the transition matrix A</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_tags):</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Go through each column of the transition matrix A</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_tags):</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize the count of the (prev POS, current POS) to zero</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Define the tuple (prev POS, current POS)</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get the tag at position i and tag at position j (from the all_tags list)</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if the (prev POS, current POS) tuple </span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># exists in the transition counts dictionary</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">None</span>: <span class="co">#complete this line</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Get count from the transition_counts dictionary </span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>                <span class="co"># for the (prev POS, current POS) tuple</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>                count <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get the count of the previous tag (index position i) from tag_counts</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>            count_prev_tag <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Apply smoothing using count of the tuple, alpha, </span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># count of previous tag, alpha, and total number of tags</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>            A[i,j] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="55bfceac" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> create_transition_matrix(alpha, tag_counts, transition_counts)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing your function</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"A at row 0, col 0: </span><span class="sc">{</span>A[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">:.9f}</span><span class="ss">"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"A at row 3, col 1: </span><span class="sc">{</span>A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"View a subset of transition matrix A"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>A_sub <span class="op">=</span> pd.DataFrame(A[<span class="dv">30</span>:<span class="dv">35</span>,<span class="dv">30</span>:<span class="dv">35</span>], index<span class="op">=</span>states[<span class="dv">30</span>:<span class="dv">35</span>], columns <span class="op">=</span> states[<span class="dv">30</span>:<span class="dv">35</span>] )</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[14], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> alpha <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(98,98,98)">0.001</span>
<span class="ansi-green-fg">----&gt; 2</span> A <span style="color:rgb(98,98,98)">=</span> create_transition_matrix(alpha, <span class="ansi-yellow-bg">tag_counts</span>, transition_counts)
<span class="ansi-green-fg ansi-bold">      3</span> <span style="font-style:italic;color:rgb(95,135,135)"># Testing your function</span>
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">A at row 0, col 0: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>A[<span style="color:rgb(98,98,98)">0</span>,<span style="color:rgb(98,98,98)">0</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.9f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'tag_counts' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-3" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-3">Expected Output</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>A at row <span class="dv">0</span><span class="op">,</span> col <span class="dv">0</span><span class="op">:</span> <span class="fl">0.000007040</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>A at row <span class="dv">3</span><span class="op">,</span> col <span class="dv">1</span><span class="op">:</span> <span class="fl">0.1691</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>View a subset of transition matrix A</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>              RBS            RP           SYM        TO            UH</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>RBS  <span class="fl">2.217069e-06</span>  <span class="fl">2.217069e-06</span>  <span class="fl">2.217069e-06</span>  <span class="fl">0.008870</span>  <span class="fl">2.217069e-06</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>RP   <span class="fl">3.756509e-07</span>  <span class="fl">7.516775e-04</span>  <span class="fl">3.756509e-07</span>  <span class="fl">0.051089</span>  <span class="fl">3.756509e-07</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>SYM  <span class="fl">1.722772e-05</span>  <span class="fl">1.722772e-05</span>  <span class="fl">1.722772e-05</span>  <span class="fl">0.000017</span>  <span class="fl">1.722772e-05</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>TO   <span class="fl">4.477336e-05</span>  <span class="fl">4.472863e-08</span>  <span class="fl">4.472863e-08</span>  <span class="fl">0.000090</span>  <span class="fl">4.477336e-05</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>UH   <span class="fl">1.030439e-05</span>  <span class="fl">1.030439e-05</span>  <span class="fl">1.030439e-05</span>  <span class="fl">0.061837</span>  <span class="fl">3.092348e-02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="create-the-b-emission-probabilities-matrix" class="level3">
<h3 class="anchored" data-anchor-id="create-the-b-emission-probabilities-matrix">Create the ‘B’ emission probabilities matrix</h3>
<p>Now you will create the <code>B</code> transition matrix which computes the emission probability.</p>
<p>You will use smoothing as defined below:</p>
<p><span class="math display">
P(w_i | t_i) = \frac{C(t_i, word_i)+ \alpha}{C(t_{i}) +\alpha * N}\tag{4}
</span></p>
<ul>
<li><span class="math inline">C(t_i, word_i)</span> is the number of times <span class="math inline">word_i</span> was associated with <span class="math inline">tag_i</span> in the training data (stored in <code>emission_counts</code> dictionary).</li>
<li><span class="math inline">C(t_i)</span> is the number of times <span class="math inline">tag_i</span> was in the training data (stored in <code>tag_counts</code> dictionary).</li>
<li><span class="math inline">N</span> is the number of words in the vocabulary</li>
<li><span class="math inline">\alpha</span> is a smoothing parameter.</li>
</ul>
<p>The matrix <code>B</code> is of dimension (num_tags, N), where num_tags is the number of possible parts-of-speech tags.</p>
Here is an example of the matrix, only a subset of tags and words are shown:
<p style="text-align: center;">
<b>B Emissions Probability Matrix (subset)</b>
</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th><strong>B</strong></th>
<th>…</th>
<th>725</th>
<th>adroitly</th>
<th>engineers</th>
<th>promoted</th>
<th>synergy</th>
<th>…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>CD</strong></td>
<td>…</td>
<td><strong>8.201296e-05</strong></td>
<td>2.732854e-08</td>
<td>2.732854e-08</td>
<td>2.732854e-08</td>
<td>2.732854e-08</td>
<td>…</td>
</tr>
<tr class="even">
<td><strong>NN</strong></td>
<td>…</td>
<td>7.521128e-09</td>
<td>7.521128e-09</td>
<td>7.521128e-09</td>
<td>7.521128e-09</td>
<td><strong>2.257091e-05</strong></td>
<td>…</td>
</tr>
<tr class="odd">
<td><strong>NNS</strong></td>
<td>…</td>
<td>1.670013e-08</td>
<td>1.670013e-08</td>
<td><strong>4.676203e-04</strong></td>
<td>1.670013e-08</td>
<td>1.670013e-08</td>
<td>…</td>
</tr>
<tr class="even">
<td><strong>VB</strong></td>
<td>…</td>
<td>3.779036e-08</td>
<td>3.779036e-08</td>
<td>3.779036e-08</td>
<td>3.779036e-08</td>
<td>3.779036e-08</td>
<td>…</td>
</tr>
<tr class="odd">
<td><strong>RB</strong></td>
<td>…</td>
<td>3.226454e-08</td>
<td><strong>6.456135e-05</strong></td>
<td>3.226454e-08</td>
<td>3.226454e-08</td>
<td>3.226454e-08</td>
<td>…</td>
</tr>
<tr class="even">
<td><strong>RP</strong></td>
<td>…</td>
<td>3.723317e-07</td>
<td>3.723317e-07</td>
<td>3.723317e-07</td>
<td><strong>3.723317e-07</strong></td>
<td>3.723317e-07</td>
<td>…</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
</section>
<section id="ex-04" class="level3">
<h3 class="anchored" data-anchor-id="ex-04">Exercise 04</h3>
<p><strong>Instructions:</strong> Implement the <code>create_emission_matrix</code> below that computes the <code>B</code> emission probabilities matrix. Your function takes in <span class="math inline">\alpha</span>, the smoothing parameter, <code>tag_counts</code>, which is a dictionary mapping each tag to its respective count, the <code>emission_counts</code> dictionary where the keys are (tag, word) and the values are the counts. Your task is to output a matrix that computes equation 4 for each cell in matrix <code>B</code>.</p>
<div id="7472f46a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C4 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: create_emission_matrix</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(alpha, tag_counts, emission_counts, vocab):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">        alpha: tuning parameter used in smoothing </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">        tag_counts: a dictionary mapping each tag to its respective count</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">        emission_counts: a dictionary where the keys are (tag, word) and the values are the counts</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab: a dictionary where keys are words in vocabulary and value is an index.</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">               within the function it'll be treated as a list</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Output:</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">        B: a matrix of dimension (num_tags, len(vocab))</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the number of POS tag</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    num_tags <span class="op">=</span> <span class="bu">len</span>(tag_counts)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a list of all POS tags</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    all_tags <span class="op">=</span> <span class="bu">sorted</span>(tag_counts.keys())</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the total number of unique words in the vocabulary</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    num_words <span class="op">=</span> <span class="bu">len</span>(vocab)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the emission matrix B with places for</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tags in the rows and words in the columns</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> np.zeros((num_tags, num_words))</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a set of all (POS, word) tuples </span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># from the keys of the emission_counts dictionary</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    emis_keys <span class="op">=</span> <span class="bu">set</span>(<span class="bu">list</span>(emission_counts.keys()))</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each row (POS tags)</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Go through each column (words)</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize the emission count for the (POS tag, word) to zero</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Define the (POS tag, word) tuple for this row and column</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span>  <span class="va">None</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># check if the (POS tag, word) tuple exists as a key in emission counts</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Get the count of (POS tag, word) from the emission_counts d</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>                count <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Get the count of the POS tag</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>            count_tag <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Apply smoothing and store the smoothed value </span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># into the emission matrix B for this row and column</span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>            B[i,j] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8331f41d" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating your emission probability matrix. this takes a few minutes to run. </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> create_emission_matrix(alpha, tag_counts, emission_counts, <span class="bu">list</span>(vocab))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"View Matrix position at row 0, column 0: </span><span class="sc">{</span>B[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">:.9f}</span><span class="ss">"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"View Matrix position at row 3, column 1: </span><span class="sc">{</span>B[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">:.9f}</span><span class="ss">"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Try viewing emissions for a few words in a sample dataframe</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>cidx  <span class="op">=</span> [<span class="st">'725'</span>,<span class="st">'adroitly'</span>,<span class="st">'engineers'</span>, <span class="st">'promoted'</span>, <span class="st">'synergy'</span>]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the integer ID for each word</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [vocab[a] <span class="cf">for</span> a <span class="kw">in</span> cidx]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose POS tags to show in a sample dataframe</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>rvals <span class="op">=</span>[<span class="st">'CD'</span>,<span class="st">'NN'</span>,<span class="st">'NNS'</span>, <span class="st">'VB'</span>,<span class="st">'RB'</span>,<span class="st">'RP'</span>]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># For each POS tag, get the row number from the 'states' list</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>rows <span class="op">=</span> [states.index(a) <span class="cf">for</span> a <span class="kw">in</span> rvals]</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the emissions for the sample of words, and the sample of POS tags</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>B_sub <span class="op">=</span> pd.DataFrame(B[np.ix_(rows,cols)], index<span class="op">=</span>rvals, columns <span class="op">=</span> cidx )</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(B_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[16], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># creating your emission probability matrix. this takes a few minutes to run. </span>
<span class="ansi-green-fg">----&gt; 2</span> B <span style="color:rgb(98,98,98)">=</span> create_emission_matrix(alpha, <span class="ansi-yellow-bg">tag_counts</span>, emission_counts, <span style="color:rgb(0,135,0)">list</span>(vocab))
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">View Matrix position at row 0, column 0: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>B[<span style="color:rgb(98,98,98)">0</span>,<span style="color:rgb(98,98,98)">0</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.9f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)
<span class="ansi-green-fg ansi-bold">      5</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">View Matrix position at row 3, column 1: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>B[<span style="color:rgb(98,98,98)">3</span>,<span style="color:rgb(98,98,98)">1</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.9f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'tag_counts' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-4" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-4">Expected Output</h5>
<div class="sourceCode" id="cb27"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>View Matrix position at row <span class="dv">0</span><span class="op">,</span> column <span class="dv">0</span><span class="op">:</span> <span class="fl">0.000006032</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>View Matrix position at row <span class="dv">3</span><span class="op">,</span> column <span class="dv">1</span><span class="op">:</span> <span class="fl">0.000000720</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">725</span>      adroitly     engineers      promoted       synergy</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>CD   <span class="fl">8.201296e-05</span>  <span class="fl">2.732854e-08</span>  <span class="fl">2.732854e-08</span>  <span class="fl">2.732854e-08</span>  <span class="fl">2.732854e-08</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>NN   <span class="fl">7.521128e-09</span>  <span class="fl">7.521128e-09</span>  <span class="fl">7.521128e-09</span>  <span class="fl">7.521128e-09</span>  <span class="fl">2.257091e-05</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>NNS  <span class="fl">1.670013e-08</span>  <span class="fl">1.670013e-08</span>  <span class="fl">4.676203e-04</span>  <span class="fl">1.670013e-08</span>  <span class="fl">1.670013e-08</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>VB   <span class="fl">3.779036e-08</span>  <span class="fl">3.779036e-08</span>  <span class="fl">3.779036e-08</span>  <span class="fl">3.779036e-08</span>  <span class="fl">3.779036e-08</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>RB   <span class="fl">3.226454e-08</span>  <span class="fl">6.456135e-05</span>  <span class="fl">3.226454e-08</span>  <span class="fl">3.226454e-08</span>  <span class="fl">3.226454e-08</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>RP   <span class="fl">3.723317e-07</span>  <span class="fl">3.723317e-07</span>  <span class="fl">3.723317e-07</span>  <span class="fl">3.723317e-07</span>  <span class="fl">3.723317e-07</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
</section>
<section id="3" class="level1">
<h1>Part 3: Viterbi Algorithm and Dynamic Programming</h1>
<p>In this part of the assignment you will implement the Viterbi algorithm which makes use of dynamic programming. Specifically, you will use your two matrices, <code>A</code> and <code>B</code> to compute the Viterbi algorithm. We have decomposed this process into three main steps for you.</p>
<ul>
<li><strong>Initialization</strong> - In this part you initialize the <code>best_paths</code> and <code>best_probabilities</code> matrices that you will be populating in <code>feed_forward</code>.</li>
<li><strong>Feed forward</strong> - At each step, you calculate the probability of each path happening and the best paths up to that point.</li>
<li><strong>Feed backward</strong>: This allows you to find the best path with the highest probabilities.</li>
</ul>
<section id="3.1" class="level2">
<h2 class="anchored" data-anchor-id="3.1">Part 3.1: Initialization</h2>
<p>You will start by initializing two matrices of the same dimension.</p>
<ul>
<li><p>best_probs: Each cell contains the probability of going from one POS tag to a word in the corpus.</p></li>
<li><p>best_paths: A matrix that helps you trace through the best possible path in the corpus.</p></li>
</ul>
<section id="ex-05" class="level3">
<h3 class="anchored" data-anchor-id="ex-05">Exercise 05</h3>
<p><strong>Instructions</strong>: Write a program below that initializes the <code>best_probs</code> and the <code>best_paths</code> matrix.</p>
<p>Both matrices will be initialized to zero except for column zero of <code>best_probs</code>.</p>
<ul>
<li>Column zero of <code>best_probs</code> is initialized with the assumption that the first word of the corpus was preceded by a start token (“–s–”).</li>
<li>This allows you to reference the <strong>A</strong> matrix for the transition probability</li>
</ul>
<p>Here is how to initialize column 0 of <code>best_probs</code>:</p>
<ul>
<li>The probability of the best path going from the start index to a given POS tag indexed by integer <span class="math inline">i</span> is denoted by <span class="math inline">\textrm{best_probs}[s_{idx}, i]</span>.</li>
<li>This is estimated as the probability that the start tag transitions to the POS denoted by index <span class="math inline">i</span>: <span class="math inline">\mathbf{A}[s_{idx}, i]</span> AND that the POS tag denoted by <span class="math inline">i</span> emits the first word of the given corpus, which is <span class="math inline">\mathbf{B}[i, vocab[corpus[0]]]</span>.</li>
<li>Note that vocab[corpus[0]] refers to the first word of the corpus (the word at position 0 of the corpus).</li>
<li><strong>vocab</strong> is a dictionary that returns the unique integer that refers to that particular word.</li>
</ul>
<p>Conceptually, it looks like this:</p>
<p><span class="math inline">\textrm{best_probs}[s_{idx}, i] = \mathbf{A}[s_{idx}, i] \times \mathbf{B}[i, corpus[0] ]</span></p>
<p>In order to avoid multiplying and storing small values on the computer, we’ll take the log of the product, which becomes the sum of two logs:</p>
<p><span class="math inline">best\_probs[i,0] = log(A[s_{idx}, i]) + log(B[i, vocab[corpus[0]]])</span></p>
<p>Also, to avoid taking the log of 0 (which is defined as negative infinity), the code itself will just set <span class="math inline">best\_probs[i,0] = float('-inf')</span> when <span class="math inline">A[s_{idx}, i] == 0</span></p>
<p>So the implementation to initialize <span class="math inline">best\_probs</span> looks like this:</p>
<p>$ if A[s_{idx}, i] &lt;&gt; 0 : best_probs[i,0] = log(A[s_{idx}, i]) + log(B[i, vocab[corpus[0]]])$</p>
<p>$ if A[s_{idx}, i] == 0 : best_probs[i,0] = float(‘-inf’)$</p>
<p>Please use <a href="https://docs.python.org/3/library/math.html">math.log</a> to compute the natural logarithm.</p>
<p>The example below shows the initialization assuming the corpus starts with the phrase “Loss tracks upward”.</p>
<p><a href="img/Initialize4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="img/Initialize4.png" class="img-fluid"></a></p>
<p>Represent infinity and negative infinity like this:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span><span class="op">(</span><span class="ch">'i</span><span class="er">nf</span><span class="ch">'</span><span class="op">)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="dt">float</span><span class="op">(</span><span class="ch">'-</span><span class="er">inf</span><span class="ch">'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="0ecd09d5" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C5 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: initialize</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize(states, tag_counts, A, B, corpus, vocab):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">        states: a list of all possible parts-of-speech</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">        tag_counts: a dictionary mapping each tag to its respective count</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">        A: Transition Matrix of dimension (num_tags, num_tags)</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">        B: Emission Matrix of dimension (num_tags, len(vocab))</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">        corpus: a sequence of words whose POS is to be identified in a list </span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab: a dictionary where keys are words in vocabulary and value is an index</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Output:</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">        best_probs: matrix of dimension (num_tags, len(corpus)) of floats</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">        best_paths: matrix of dimension (num_tags, len(corpus)) of integers</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the total number of unique POS tags</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    num_tags <span class="op">=</span> <span class="bu">len</span>(tag_counts)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize best_probs matrix </span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># POS tags in the rows, number of words in the corpus as the columns</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    best_probs <span class="op">=</span> np.zeros((num_tags, <span class="bu">len</span>(corpus)))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize best_paths matrix</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># POS tags in the rows, number of words in the corpus as columns</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>    best_paths <span class="op">=</span> np.zeros((num_tags, <span class="bu">len</span>(corpus)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the start token</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>    s_idx <span class="op">=</span> states.index(<span class="st">"--s--"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each of the POS tags</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle the special case when the transition from start token to POS tag i is zero</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize best_probs at POS tag 'i', column 0, to negative infinity</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>            best_probs[i,<span class="dv">0</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For all other cases when transition from start token to POS tag i is non-zero:</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize best_probs at POS tag 'i', column 0</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check the formula in the instructions above</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>            best_probs[i,<span class="dv">0</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span><span class="co"> </span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_probs, best_paths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a35f13ba" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>best_probs, best_paths <span class="op">=</span> initialize(states, tag_counts, A, B, prep, vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[18], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> best_probs, best_paths <span style="color:rgb(98,98,98)">=</span> initialize(<span class="ansi-yellow-bg">states</span>, tag_counts, A, B, prep, vocab)

<span class="ansi-red-fg">NameError</span>: name 'states' is not defined</pre>
</div>
</div>
</div>
<div id="8765d676" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"best_probs[0,0]: </span><span class="sc">{</span>best_probs[<span class="dv">0</span>,<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"best_paths[2,3]: </span><span class="sc">{</span>best_paths[<span class="dv">2</span>,<span class="dv">3</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[19], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Test the function</span>
<span class="ansi-green-fg">----&gt; 2</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">best_probs[0,0]: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span class="ansi-yellow-bg">best_probs</span>[<span style="color:rgb(98,98,98)">0</span>,<span style="color:rgb(98,98,98)">0</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>) 
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">best_paths[2,3]: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>best_paths[<span style="color:rgb(98,98,98)">2</span>,<span style="color:rgb(98,98,98)">3</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'best_probs' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-5" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-5">Expected Output</h5>
<div class="sourceCode" id="cb32"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>best_probs<span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]:</span> <span class="op">-</span><span class="fl">22.6098</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>best_paths<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">]:</span> <span class="fl">0.0000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="3.2" class="level2">
<h2 class="anchored" data-anchor-id="3.2">Part 3.2 Viterbi Forward (prediction)</h2>
<p>In this part of the assignment, you will implement the <code>viterbi_forward</code> segment. In other words, you will populate your <code>best_probs</code> and <code>best_paths</code> matrices.</p>
<ul>
<li>Walk forward through the corpus.</li>
<li>For each word, compute a probability for each possible tag.</li>
<li>Unlike the previous algorithm <code>predict_pos</code> (the ‘warm-up’ exercise), this will include the path up to that (word,tag) combination.</li>
</ul>
<p>Here is an example with a three-word corpus “Loss tracks upward”:</p>
<ul>
<li>Note, in this example, only a subset of states (POS tags) are shown in the diagram below, for easier reading.</li>
<li>In the diagram below, the first word “Loss” is already initialized.</li>
<li>The algorithm will compute a probability for each of the potential tags in the second and future words.</li>
</ul>
<p>Compute the probability that the tag of the second work (‘tracks’) is a verb, 3rd person singular present (VBZ).</p>
<ul>
<li>In the <code>best_probs</code> matrix, go to the column of the second word (‘tracks’), and row 40 (VBZ), this cell is highlighted in light orange in the diagram below.</li>
<li>Examine each of the paths from the tags of the first word (‘Loss’) and choose the most likely path.<br>
</li>
<li>An example of the calculation for <strong>one</strong> of those paths is the path from (‘Loss’, NN) to (‘tracks’, VBZ).</li>
<li>The log of the probability of the path up to and including the first word ‘Loss’ having POS tag NN is <span class="math inline">-14.32</span>. The <code>best_probs</code> matrix contains this value -14.32 in the column for ‘Loss’ and row for ‘NN’.</li>
<li>Find the probability that NN transitions to VBZ. To find this probability, go to the <code>A</code> transition matrix, and go to the row for ‘NN’ and the column for ‘VBZ’. The value is <span class="math inline">4.37e-02</span>, which is circled in the diagram, so add <span class="math inline">-14.32 + log(4.37e-02)</span>.</li>
<li>Find the log of the probability that the tag VBS would ‘emit’ the word ‘tracks’. To find this, look at the ‘B’ emission matrix in row ‘VBZ’ and the column for the word ‘tracks’. The value <span class="math inline">4.61e-04</span> is circled in the diagram below. So add <span class="math inline">-14.32 + log(4.37e-02) + log(4.61e-04)</span>.</li>
<li>The sum of <span class="math inline">-14.32 + log(4.37e-02) + log(4.61e-04)</span> is <span class="math inline">-25.13</span>. Store <span class="math inline">-25.13</span> in the <code>best_probs</code> matrix at row ‘VBZ’ and column ‘tracks’ (as seen in the cell that is highlighted in light orange in the diagram).</li>
<li>All other paths in best_probs are calculated. Notice that <span class="math inline">-25.13</span> is greater than all of the other values in column ‘tracks’ of matrix <code>best_probs</code>, and so the most likely path to ‘VBZ’ is from ‘NN’. ‘NN’ is in row 20 of the <code>best_probs</code> matrix, so <span class="math inline">20</span> is the most likely path.</li>
<li>Store the most likely path <span class="math inline">20</span> in the <code>best_paths</code> table. This is highlighted in light orange in the diagram below.</li>
</ul>
<p>The formula to compute the probability and path for the <span class="math inline">i^{th}</span> word in the <span class="math inline">corpus</span>, the prior word <span class="math inline">i-1</span> in the corpus, current POS tag <span class="math inline">j</span>, and previous POS tag <span class="math inline">k</span> is:</p>
<p><span class="math inline">\mathrm{prob} = \mathbf{best\_prob}_{k, i-1} + \mathrm{log}(\mathbf{A}_{k, j}) + \mathrm{log}(\mathbf{B}_{j, vocab(corpus_{i})})</span></p>
<p>where <span class="math inline">corpus_{i}</span> is the word in the corpus at index <span class="math inline">i</span>, and <span class="math inline">vocab</span> is the dictionary that gets the unique integer that represents a given word.</p>
<p><span class="math inline">\mathrm{path} = k</span></p>
<p>where <span class="math inline">k</span> is the integer representing the previous POS tag.</p>
<section id="ex-06" class="level3">
<h3 class="anchored" data-anchor-id="ex-06">Exercise 06</h3>
<p>Instructions: Implement the <code>viterbi_forward</code> algorithm and store the best_path and best_prob for every possible tag for each word in the matrices <code>best_probs</code> and <code>best_tags</code> using the pseudo code below.</p>
<p>`for each word in the corpus</p>
<pre><code>for each POS tag type that this word may be

    for POS tag type that the previous word could be
    
        compute the probability that the previous word had a given POS tag, that the current word has a given POS tag, and that the POS tag would emit this current word.
        
        retain the highest probability computed for the current word
        
        set best_probs to this highest probability
        
        set best_paths to the index 'k', representing the POS tag of the previous word which produced the highest probability `</code></pre>
<p>Please use <a href="https://docs.python.org/3/library/math.html">math.log</a> to compute the natural logarithm.</p>
<p><a href="img/Forward4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="img/Forward4.png" class="img-fluid"></a></p>
<details>
<summary>
<font size="3" color="darkgreen"><b>Hints</b></font>
</summary>
<p>
</p><ul>
<li>
Remember that when accessing emission matrix B, the column index is the unique integer ID associated with the word. It can be accessed by using the ‘vocab’ dictionary, where the key is the word, and the value is the unique integer ID for that word.
</li>
</ul>
<p></p>
</details>
<div id="2c35859e" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C6 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: viterbi_forward</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi_forward(A, B, test_corpus, best_probs, best_paths, vocab):</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">        A, B: The transition and emission matrices respectively</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">        test_corpus: a list containing a preprocessed corpus</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co">        best_probs: an initilized matrix of dimension (num_tags, len(corpus))</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co">        best_paths: an initilized matrix of dimension (num_tags, len(corpus))</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">        vocab: a dictionary where keys are words in vocabulary and value is an index </span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Output: </span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co">        best_probs: a completed matrix of dimension (num_tags, len(corpus))</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co">        best_paths: a completed matrix of dimension (num_tags, len(corpus))</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of unique POS tags (which is the num of rows in best_probs)</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    num_tags <span class="op">=</span> best_probs.shape[<span class="dv">0</span>]</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through every word in the corpus starting from word 1</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recall that word 0 was initialized in `initialize()`</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(test_corpus)): </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print number of words processed, every 5000 words</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">%</span> <span class="dv">5000</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"Words processed: </span><span class="sc">{:&gt;8}</span><span class="st">"</span>.<span class="bu">format</span>(i))</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>        <span class="co">### START CODE HERE (Replace instances of 'None' with your code EXCEPT the first 'best_path_i = None') </span><span class="al">###</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each unique POS tag that the current word can be</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize best_prob for word i to negative infinity</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>            best_prob_i <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Initialize best_path for current word i to None</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>            best_path_i <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># For each POS tag that the previous word can be:</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Calculate the probability = </span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>                <span class="co"># best probs of POS tag k, previous word i-1 + </span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>                <span class="co"># log(prob of transition from POS k to POS j) + </span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>                <span class="co"># log(prob that emission of POS j is word i)</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>                prob <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>                <span class="co"># check if this path's probability is greater than</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># the best probability up to and before this point</span></span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Keep track of the best probability</span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>                    best_prob_i <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># keep track of the POS tag of the previous word</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># that is part of the best path.  </span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Save the index (integer) associated with </span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># that previous word's POS tag</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>                    best_path_i <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save the best probability for the </span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>            <span class="co"># given current word's POS tag</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and the position of the current word inside the corpus</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>            best_probs[j,i] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Save the unique integer ID of the previous POS tag</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>            <span class="co"># into best_paths matrix, for the POS tag of the current word</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and the position of the current word inside the corpus.</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>            best_paths[j,i] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_probs, best_paths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Run the <code>viterbi_forward</code> function to fill in the <code>best_probs</code> and <code>best_paths</code> matrices.</p>
<p><strong>Note</strong> that this will take a few minutes to run. There are about 30,000 words to process.</p>
<div id="611771de" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will take a few minutes to run =&gt; processes ~ 30,000 words</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>best_probs, best_paths <span class="op">=</span> viterbi_forward(A, B, prep, best_probs, best_paths, vocab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[21], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># this will take a few minutes to run =&gt; processes ~ 30,000 words</span>
<span class="ansi-green-fg">----&gt; 2</span> best_probs, best_paths <span style="color:rgb(98,98,98)">=</span> viterbi_forward(<span class="ansi-yellow-bg">A</span>, B, prep, best_probs, best_paths, vocab)

<span class="ansi-red-fg">NameError</span>: name 'A' is not defined</pre>
</div>
</div>
</div>
<div id="f4a20f2b" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test this function </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"best_probs[0,1]: </span><span class="sc">{</span>best_probs[<span class="dv">0</span>,<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>) </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"best_probs[0,4]: </span><span class="sc">{</span>best_probs[<span class="dv">0</span>,<span class="dv">4</span>]<span class="sc">:.4f}</span><span class="ss">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[22], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Test this function </span>
<span class="ansi-green-fg">----&gt; 2</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">best_probs[0,1]: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span><span class="ansi-yellow-bg">best_probs</span>[<span style="color:rgb(98,98,98)">0</span>,<span style="color:rgb(98,98,98)">1</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>) 
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">best_probs[0,4]: </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>best_probs[<span style="color:rgb(98,98,98)">0</span>,<span style="color:rgb(98,98,98)">4</span>]<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>) 

<span class="ansi-red-fg">NameError</span>: name 'best_probs' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-6" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-6">Expected Output</h5>
<div class="sourceCode" id="cb37"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>best_probs<span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]:</span> <span class="op">-</span><span class="fl">24.7822</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>best_probs<span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">4</span><span class="op">]:</span> <span class="op">-</span><span class="fl">49.5601</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="3.3" class="level2">
<h2 class="anchored" data-anchor-id="3.3">Part 3.3 Viterbi backward</h2>
<p>Now you will implement the Viterbi backward algorithm.</p>
<ul>
<li>The Viterbi backward algorithm gets the predictions of the POS tags for each word in the corpus using the <code>best_paths</code> and the <code>best_probs</code> matrices.</li>
</ul>
<p>The example below shows how to walk backwards through the best_paths matrix to get the POS tags of each word in the corpus. Recall that this example corpus has three words: “Loss tracks upward”.</p>
<p>POS tag for ‘upward’ is <code>RB</code></p>
<ul>
<li>Select the the most likely POS tag for the last word in the corpus, ‘upward’ in the <code>best_prob</code> table.</li>
<li>Look for the row in the column for ‘upward’ that has the largest probability.</li>
<li>Notice that in row 28 of <code>best_probs</code>, the estimated probability is -34.99, which is larger than the other values in the column. So the most likely POS tag for ‘upward’ is <code>RB</code> an adverb, at row 28 of <code>best_prob</code>.</li>
<li>The variable <code>z</code> is an array that stores the unique integer ID of the predicted POS tags for each word in the corpus. In array z, at position 2, store the value 28 to indicate that the word ‘upward’ (at index 2 in the corpus), most likely has the POS tag associated with unique ID 28 (which is <code>RB</code>).</li>
<li>The variable <code>pred</code> contains the POS tags in string form. So <code>pred</code> at index 2 stores the string <code>RB</code>.</li>
</ul>
<p>POS tag for ‘tracks’ is <code>VBZ</code></p>
<ul>
<li>The next step is to go backward one word in the corpus (‘tracks’). Since the most likely POS tag for ‘upward’ is <code>RB</code>, which is uniquely identified by integer ID 28, go to the <code>best_paths</code> matrix in column 2, row 28. The value stored in <code>best_paths</code>, column 2, row 28 indicates the unique ID of the POS tag of the previous word. In this case, the value stored here is 40, which is the unique ID for POS tag <code>VBZ</code> (verb, 3rd person singular present).</li>
<li>So the previous word at index 1 of the corpus (‘tracks’), most likely has the POS tag with unique ID 40, which is <code>VBZ</code>.</li>
<li>In array <code>z</code>, store the value 40 at position 1, and for array <code>pred</code>, store the string <code>VBZ</code> to indicate that the word ‘tracks’ most likely has POS tag <code>VBZ</code>.</li>
</ul>
<p>POS tag for ‘Loss’ is <code>NN</code></p>
<ul>
<li>In <code>best_paths</code> at column 1, the unique ID stored at row 40 is 20. 20 is the unique ID for POS tag <code>NN</code>.</li>
<li>In array <code>z</code> at position 0, store 20. In array <code>pred</code> at position 0, store <code>NN</code>.</li>
</ul>
<p><a href="img/Backwards5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="img/Backwards5.png" class="img-fluid"></a></p>
<section id="ex-07" class="level3">
<h3 class="anchored" data-anchor-id="ex-07">Exercise 07</h3>
<p>Implement the <code>viterbi_backward</code> algorithm, which returns a list of predicted POS tags for each word in the corpus.</p>
<ul>
<li>Note that the numbering of the index positions starts at 0 and not 1.</li>
<li><code>m</code> is the number of words in the corpus.
<ul>
<li>So the indexing into the corpus goes from <code>0</code> to <code>m - 1</code>.</li>
<li>Also, the columns in <code>best_probs</code> and <code>best_paths</code> are indexed from <code>0</code> to <code>m - 1</code></li>
</ul></li>
</ul>
<p><strong>In Step 1:</strong></p>
<p>Loop through all the rows (POS tags) in the last entry of <code>best_probs</code> and find the row (POS tag) with the maximum value. Convert the unique integer ID to a tag (a string representation) using the list <code>states</code>.</p>
<p>Referring to the three-word corpus described above:</p>
<ul>
<li><code>z[2] = 28</code>: For the word ‘upward’ at position 2 in the corpus, the POS tag ID is 28. Store 28 in <code>z</code> at position 2.</li>
<li><code>states[28]</code> is ‘RB’: The POS tag ID 28 refers to the POS tag ‘RB’.</li>
<li><code>pred[2] = 'RB'</code>: In array <code>pred</code>, store the POS tag for the word ‘upward’.</li>
</ul>
<p><strong>In Step 2:</strong></p>
<ul>
<li>Starting at the last column of best_paths, use <code>best_probs</code> to find the most likely POS tag for the last word in the corpus.</li>
<li>Then use <code>best_paths</code> to find the most likely POS tag for the previous word.</li>
<li>Update the POS tag for each word in <code>z</code> and in <code>preds</code>.</li>
</ul>
<p>Referring to the three-word example from above, read best_paths at column 2 and fill in z at position 1.<br>
<code>z[1] = best_paths[z[2],2]</code></p>
<p>The small test following the routine prints the last few words of the corpus and their states to aid in debug.</p>
<div id="ad4d443b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C7 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: viterbi_backward</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi_backward(best_probs, best_paths, corpus, states):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">    This function returns the best path.</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of words in the corpus</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># which is also the number of columns in best_probs, best_paths</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> best_paths.shape[<span class="dv">1</span>] </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize array z, same length as the corpus</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> m</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the number of unique POS tags</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    num_tags <span class="op">=</span> best_probs.shape[<span class="dv">0</span>]</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the best probability for the last word</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    best_prob_for_last_word <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize pred array, same length as corpus</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> [<span class="va">None</span>] <span class="op">*</span> m</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Step 1 ##</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go through each POS tag for the last word (last column of best_probs)</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in order to find the row (POS tag integer ID) </span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># with highest probability for the last word</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># If the probability of POS tag at row k </span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># is better than the previously best probability for the last word:</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Store the new best probability for the lsat word</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>            best_prob_for_last_word <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Store the unique integer ID of the POS tag</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># which is also the row number in best_probs</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>            z[m <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the last word's predicted POS tag</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># from its unique integer ID into the string representation</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># using the 'states' dictionary</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># store this in the 'pred' array for the last word</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    pred[m <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Step 2 ##</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the best POS tags by walking backward through the best_paths</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># From the last word in the corpus to the 0th word in the corpus</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>): <span class="co"># complete this line</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Retrieve the unique integer ID of</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the POS tag for the word at position 'i' in the corpus</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>        pos_tag_for_word_i <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In best_paths, go to the row representing the POS tag of word i</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># and the column representing the word's position in the corpus</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to retrieve the predicted POS for the word at position i-1 in the corpus</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>        z[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get the previous word's POS tag in string form</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Use the 'states' dictionary, </span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># where the key is the unique integer ID of the POS tag,</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># and the value is the string representation of that POS tag</span></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>        pred[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>     <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="03a6a8b6" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run and test your function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> viterbi_backward(best_probs, best_paths, prep, states)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span><span class="bu">len</span>(pred)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The prediction for pred[-7:m-1] is: </span><span class="ch">\n</span><span class="st">'</span>, prep[<span class="op">-</span><span class="dv">7</span>:m<span class="op">-</span><span class="dv">1</span>], <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, pred[<span class="op">-</span><span class="dv">7</span>:m<span class="op">-</span><span class="dv">1</span>], <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The prediction for pred[0:8] is: </span><span class="ch">\n</span><span class="st">'</span>, pred[<span class="dv">0</span>:<span class="dv">7</span>], <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, prep[<span class="dv">0</span>:<span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[24], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="font-style:italic;color:rgb(95,135,135)"># Run and test your function</span>
<span class="ansi-green-fg">----&gt; 2</span> pred <span style="color:rgb(98,98,98)">=</span> viterbi_backward(<span class="ansi-yellow-bg">best_probs</span>, best_paths, prep, states)
<span class="ansi-green-fg ansi-bold">      3</span> m<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">len</span>(pred)
<span class="ansi-green-fg ansi-bold">      4</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">The prediction for pred[-7:m-1] is: </span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">'</span>, prep[<span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">7</span>:m<span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">1</span>], <span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">"</span>, pred[<span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">7</span>:m<span style="color:rgb(98,98,98)">-</span><span style="color:rgb(98,98,98)">1</span>], <span style="color:rgb(175,0,0)">"</span><span style="font-weight:bold;color:rgb(175,95,0)">\n</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'best_probs' is not defined</pre>
</div>
</div>
</div>
<p><strong>Expected Output:</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>The prediction <span class="cf">for</span> pred<span class="op">[-</span><span class="dv">7</span><span class="op">:</span>m<span class="op">-</span><span class="dv">1</span><span class="op">]</span> is<span class="op">:</span>  </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a> <span class="op">[</span><span class="ch">'s</span><span class="er">ee</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">hem</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'h</span><span class="er">ere</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">ith</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'u</span><span class="er">s</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'.'</span><span class="op">]</span>  </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a> <span class="op">[</span><span class="ch">'V</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">RP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'R</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'I</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">RP</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'.'</span><span class="op">]</span>   </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>The prediction <span class="cf">for</span> pred<span class="op">[</span><span class="dv">0</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> is<span class="op">:</span>    </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a> <span class="op">[</span><span class="ch">'D</span><span class="er">T</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'P</span><span class="er">OS</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'N</span><span class="er">N</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'M</span><span class="er">D</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">B</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'V</span><span class="er">BN</span><span class="ch">'</span><span class="op">]</span>   </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a> <span class="op">[</span><span class="ch">'T</span><span class="er">he</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'e</span><span class="er">conomy</span><span class="ch">'</span><span class="op">,</span> <span class="st">"'s"</span><span class="op">,</span> <span class="ch">'t</span><span class="er">emperature</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'w</span><span class="er">ill</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'b</span><span class="er">e</span><span class="ch">'</span><span class="op">,</span> <span class="ch">'t</span><span class="er">aken</span><span class="ch">'</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now you just have to compare the predicted labels to the true labels to evaluate your model on the accuracy metric!</p>
</section>
</section>
</section>
<section id="4" class="level1">
<h1>Part 4: Predicting on a data set</h1>
<p>Compute the accuracy of your prediction by comparing it with the true <code>y</code> labels. - <code>pred</code> is a list of predicted POS tags corresponding to the words of the <code>test_corpus</code>.</p>
<div id="fe81a86e" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The third word is:'</span>, prep[<span class="dv">3</span>])</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Your prediction is:'</span>, pred[<span class="dv">3</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Your corresponding label y is: '</span>, y[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The third word is: temperature</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[25], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">The third word is:</span><span style="color:rgb(175,0,0)">'</span>, prep[<span style="color:rgb(98,98,98)">3</span>])
<span class="ansi-green-fg">----&gt; 2</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Your prediction is:</span><span style="color:rgb(175,0,0)">'</span>, <span class="ansi-yellow-bg">pred</span>[<span style="color:rgb(98,98,98)">3</span>])
<span class="ansi-green-fg ansi-bold">      3</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">'</span><span style="color:rgb(175,0,0)">Your corresponding label y is: </span><span style="color:rgb(175,0,0)">'</span>, y[<span style="color:rgb(98,98,98)">3</span>])

<span class="ansi-red-fg">NameError</span>: name 'pred' is not defined</pre>
</div>
</div>
</div>
<section id="ex-08" class="level3">
<h3 class="anchored" data-anchor-id="ex-08">Exercise 08</h3>
<p>Implement a function to compute the accuracy of the viterbi algorithm’s POS tag predictions. - To split y into the word and its tag you can use <code>y.split()</code>.</p>
<div id="058b726f" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UNQ_C8 (UNIQUE CELL IDENTIFIER, DO NOT EDIT)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GRADED FUNCTION: compute_accuracy</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_accuracy(pred, y):</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Input: </span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">        pred: a list of the predicted parts-of-speech </span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co">        y: a list of lines where each word is separated by a '</span><span class="ch">\t</span><span class="co">' (i.e. word </span><span class="ch">\t</span><span class="co"> tag)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Output: </span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co">        </span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    num_correct <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    total <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zip together the prediction and the labels</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> prediction, y <span class="kw">in</span> <span class="bu">zip</span>(pred, y):</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="co">### START CODE HERE (Replace instances of 'None' with your code) </span><span class="al">###</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Split the label into the word and the POS tag</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        word_tag_tuple <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check that there is actually a word and a tag</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># no more and no less than 2 items</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># store the word and tag separately</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>        word, tag <span class="op">=</span> <span class="va">None</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check if the POS tag label matches the prediction</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">None</span>: <span class="co"># complete this line</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>            <span class="co"># count the number of times that the prediction</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># and label match</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>            num_correct <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># keep track of the total number of examples (that have valid labels)</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>        total <span class="op">+=</span> <span class="va">None</span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>        <span class="co">### </span><span class="re">END</span><span class="co"> CODE HERE </span><span class="al">###</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_correct<span class="op">/</span>total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="db3ced77" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy of the Viterbi algorithm is </span><span class="sc">{</span>compute_accuracy(pred, y)<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[27], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span style="color:rgb(0,135,0)">print</span>(<span style="color:rgb(175,0,0)">f</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Accuracy of the Viterbi algorithm is </span><span style="font-weight:bold;color:rgb(175,95,135)">{</span>compute_accuracy(<span class="ansi-yellow-bg">pred</span>,<span style="color:rgb(188,188,188)"> </span>y)<span style="font-weight:bold;color:rgb(175,95,135)">:</span><span style="color:rgb(175,0,0)">.4f</span><span style="font-weight:bold;color:rgb(175,95,135)">}</span><span style="color:rgb(175,0,0)">"</span>)

<span class="ansi-red-fg">NameError</span>: name 'pred' is not defined</pre>
</div>
</div>
</div>
<section id="expected-output-7" class="level5">
<h5 class="anchored" data-anchor-id="expected-output-7">Expected Output</h5>
<div class="sourceCode" id="cb45"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Accuracy of the Viterbi algorithm is <span class="fl">0.9531</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Congratulations you were able to classify the parts-of-speech with 95% accuracy.</p>
</section>
</section>
<section id="key-points-and-overview" class="level3">
<h3 class="anchored" data-anchor-id="key-points-and-overview">Key Points and overview</h3>
<p>In this assignment you learned about parts-of-speech tagging.</p>
<ul>
<li>In this assignment, you predicted POS tags by walking forward through a corpus and knowing the previous word.</li>
<li>There are other implementations that use bidirectional POS tagging.</li>
<li>Bidirectional POS tagging requires knowing the previous word and the next word in the corpus when predicting the current word’s POS tag.</li>
<li>Bidirectional POS tagging would tell you more about the POS instead of just knowing the previous word.</li>
<li>Since you have learned to implement the unidirectional approach, you have the foundation to implement other POS taggers used in industry.</li>
</ul>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<ul>
<li><a href="https://web.stanford.edu/~jurafsky/slp3/">“Speech and Language Processing”, Dan Jurafsky and James H. Martin</a></li>
<li>We would like to thank Melanie Tosik for her help and inspiration</li>
</ul>
</section>
<section id="optional" class="level3">
<h3 class="anchored" data-anchor-id="optional">Optional</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If like me you find this challenging why not:</p>
<ul>
<li>TODO: implement the HMM trifecta
<ul class="task-list">
<li><label><input type="checkbox">Forward–backward - given a sequence of outputs, infer the most likely sequence of states</label></li>
<li><label><input type="checkbox">Viterbi - Compute the most likely trajectory</label></li>
<li><label><input type="checkbox">Baum-Welch - Find the unknown parameters of a hidden Markov model (HMM) needs needs the FB alg</label></li>
</ul></li>
<li>TODO: implement Viterbi, etc+ related algorithms for spark</li>
<li>TODO: code the Viterbi, etc in Manim to visualize the algorithm!…</li>
</ul>
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{2020,
  author = {},
  title = {Assignment 2: {Parts-of-Speech} {Tagging} {(POS)}},
  date = {2020-10-23},
  url = {https://orenbochman.github.io/notes-nlp/posts/c2w2/assignment.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-2020" class="csl-entry quarto-appendix-citeas" role="listitem">
<span>“Assignment 2: Parts-of-Speech Tagging (POS).”</span> 2020.
October 23, 2020. <a href="https://orenbochman.github.io/notes-nlp/posts/c2w2/assignment.html">https://orenbochman.github.io/notes-nlp/posts/c2w2/assignment.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2023-2025, Oren Bochman</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/OrenBochman/notes-nlp/edit/main/posts/c2w2/assignment.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/OrenBochman/notes-nlp/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with 💛 and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"right","loop":true,"openEffect":"fade","selector":".lightbox","skin":"my-css-class"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>